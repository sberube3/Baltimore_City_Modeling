---
title: "Skeleton_of_Outputs"
author: ""
date: "3/19/2020"
output: pdf_document
---

This is a document for a code skeleton for the outputs section of the project.

Loading in relevant data sources for this: 
```{r, message=FALSE, echo=TRUE, warning=FALSE}

setwd('~/Dropbox/COVID-BaltimoreCity/Output_20200322_v2')

require(socialmixr)
require(xlsx)
require(magrittr)
require(stringr)
require(reshape2)
require(dplyr)
require(ggplot2) 
require(tidyr)
#load in data, subset incident cases/day (eventually should be symptomatic incident cases)
data_infected_R017_100<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r017__100.csv")
data_infected_R017_75<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r017__75.csv")
data_infected_R017_50<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r017__50.csv")
data_infected_R021_100<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r021__100.csv")
data_infected_R021_75<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r021__75.csv")
data_infected_R021_50<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r021__50.csv")
data_infected_R025_100<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r025__100.csv")
data_infected_R025_75<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r025__75.csv")
data_infected_R025_50<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r025__50.csv")


#calculate bounds on IQR, we are sticking with just 75 contact, since they are so similar. 

complete_infected_R017_75<- read.csv("SEIR_results__n500__r017__75.csv")
complete_infected_R021_75<- read.csv("SEIR_results__n500__r021__75.csv")
complete_infected_R025_75<- read.csv("SEIR_results__n500__r025__75.csv")

complete_incident_R017_75<- complete_infected_R017_75%>%
  select(time,incid_I1,incid_I2,incid_I3,incid_I4,incid_I5,
         incid_I6,I7,incid_I8,incid_I9,
         incid_I10,incid_I11,incid_I12,incid_I13,incid_I14)

complete_incident_R021_75<- complete_infected_R021_75%>%
  select(time,incid_I1,incid_I2,incid_I3,incid_I4,incid_I5,
         incid_I6,I7,incid_I8,incid_I9,
         incid_I10,incid_I11,incid_I12,incid_I13,incid_I14)

complete_incident_R025_75<- complete_infected_R025_75%>%
  select(time,incid_I1,incid_I2,incid_I3,incid_I4,incid_I5,
         incid_I6,I7,incid_I8,incid_I9,
         incid_I10,incid_I11,incid_I12,incid_I13,incid_I14)

#each day calculate the upper and lower bound of the IQR.
#upper: 
IQR_upper_R017_75<- matrix(NA,365,14)
for(i in 1:nrow(IQR_upper_R017_75)){

    IQR_upper_R017_75[i,]<-
      apply(complete_incident_R017_75[which(complete_incident_R017_75$time==i),2:15]
                                  ,2,quantile,probs=c(0.75),na.rm=TRUE)
  
}

IQR_upper_R021_75<- matrix(NA,365,14)
for(i in 1:nrow(IQR_upper_R021_75)){

    IQR_upper_R021_75[i,]<-
      apply(complete_incident_R021_75[which(complete_incident_R021_75$time==i),2:15]
                                  ,2,quantile,probs=c(0.75),na.rm=TRUE)
  
}

IQR_upper_R025_75<- matrix(NA,365,14)
for(i in 1:nrow(IQR_upper_R025_75)){

    IQR_upper_R025_75[i,]<-
      apply(complete_incident_R025_75[which(complete_incident_R025_75$time==i),2:15]
                                  ,2,quantile,probs=c(0.75),na.rm=TRUE)
  
}
################
#lower: 
IQR_lower_R017_75<- matrix(NA,365,14)
for(i in 1:nrow(IQR_lower_R017_75)){

    IQR_lower_R017_75[i,]<-
      apply(complete_incident_R017_75[which(complete_incident_R017_75$time==i),2:15]
                                  ,2,quantile,probs=c(0.25),na.rm=TRUE)
  
}

IQR_lower_R021_75<- matrix(NA,365,14)
for(i in 1:nrow(IQR_lower_R021_75)){

    IQR_lower_R021_75[i,]<-
      apply(complete_incident_R021_75[which(complete_incident_R021_75$time==i),2:15]
                                  ,2,quantile,probs=c(0.25),na.rm=TRUE)
  
}

IQR_lower_R025_75<- matrix(NA,365,14)
for(i in 1:nrow(IQR_lower_R025_75)){

    IQR_lower_R025_75[i,]<-
      apply(complete_incident_R025_75[which(complete_incident_R025_75$time==i),2:15]
                                  ,2,quantile,probs=c(0.25),na.rm=TRUE)
  
}



```


```{r, message=FALSE, echo=TRUE, warning=FALSE}

data_incident_median_R017_100<- data_infected_R017_100%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R017_100<- data_infected_R017_100%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R017_100<- data_infected_R017_100%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R017_100<- data_infected_R017_100%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)

##########################
data_incident_median_R017_75<- data_infected_R017_75%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R017_75<- data_infected_R017_75%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R017_75<- data_infected_R017_75%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R017_75<- data_infected_R017_75%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)
###########################
data_incident_median_R017_50<- data_infected_R017_50%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R017_50<- data_infected_R017_50%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R017_50<- data_infected_R017_50%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R017_50<- data_infected_R017_50%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)
############################
data_incident_median_R021_100<- data_infected_R021_100%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R021_100<- data_infected_R021_100%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R021_100<- data_infected_R021_100%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R021_100<- data_infected_R021_100%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)
############################
data_incident_median_R021_75<- data_infected_R021_75%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R021_75<- data_infected_R021_75%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R021_75<- data_infected_R021_75%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R021_75<- data_infected_R021_75%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)
##############################
data_incident_median_R021_50<- data_infected_R021_50%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R021_50<- data_infected_R021_50%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R021_50<- data_infected_R021_50%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R021_50<- data_infected_R021_50%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)

#############################
data_incident_median_R025_100<- data_infected_R025_100%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R025_100<- data_infected_R025_100%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R025_100<- data_infected_R025_100%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R025_100<- data_infected_R025_100%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)
#############################
data_incident_median_R025_75<- data_infected_R025_75%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R025_75<- data_infected_R025_75%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R025_75<- data_infected_R025_75%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R025_75<- data_infected_R025_75%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)
###############################
data_incident_median_R025_50<- data_infected_R025_50%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R025_50<- data_infected_R025_50%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R025_50<- data_infected_R025_50%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R025_50<- data_infected_R025_50%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)

#consolidate age categories, 1-4 is now cat1, 5-6 is now cat2, 7-9 is now cat3, 10 is cat 4, 11 is cat5, 12 is cat 6, HCW is cat 7, homeless is cat 8 


data_incident_median_R017_100<- data_incident_median_R017_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R017_100<- data_incident_mean_R017_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R017_100<- data_incident_upper_R017_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R017_100<- data_incident_lower_R017_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))

####################################

data_incident_median_R017_75<- data_incident_median_R017_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R017_75<- data_incident_mean_R017_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R017_75<- data_incident_upper_R017_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R017_75<- data_incident_lower_R017_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))
#######################################

data_incident_median_R017_50<- data_incident_median_R017_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R017_50<- data_incident_mean_R017_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R017_50<- data_incident_upper_R017_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R017_50<- data_incident_lower_R017_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))
########################################

data_incident_median_R021_100<- data_incident_median_R021_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R021_100<- data_incident_mean_R021_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R021_100<- data_incident_upper_R021_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R021_100<- data_incident_lower_R021_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))
########################################

data_incident_median_R021_75<- data_incident_median_R021_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R021_75<- data_incident_mean_R021_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R021_75<- data_incident_upper_R021_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R021_75<- data_incident_lower_R021_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))

########################################

data_incident_median_R021_50<- data_incident_median_R021_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R021_50<- data_incident_mean_R021_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R021_50<- data_incident_upper_R021_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R021_50<- data_incident_lower_R021_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))
#########################################

data_incident_median_R025_100<- data_incident_median_R025_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R025_100<- data_incident_mean_R025_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R025_100<- data_incident_upper_R025_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R025_100<- data_incident_lower_R025_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))
###########################################

data_incident_median_R025_75<- data_incident_median_R025_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R025_75<- data_incident_mean_R025_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R025_75<- data_incident_upper_R025_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R025_75<- data_incident_lower_R025_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))
#####################################

data_incident_median_R025_50<- data_incident_median_R025_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R025_50<- data_incident_mean_R025_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R025_50<- data_incident_upper_R025_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R025_50<- data_incident_lower_R025_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))
##############################################

IQR_lower_R017_75<- as.data.frame(IQR_lower_R017_75)
data_incident_IQR_lower_R017_75<- IQR_lower_R017_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))

IQR_lower_R021_75<- as.data.frame(IQR_lower_R021_75)
data_incident_IQR_lower_R021_75<- IQR_lower_R021_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))

IQR_lower_R025_75<- as.data.frame(IQR_lower_R025_75)
data_incident_IQR_lower_R025_75<- IQR_lower_R025_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))
########################################

IQR_upper_R017_75<- as.data.frame(IQR_upper_R017_75)
data_incident_IQR_upper_R017_75<- IQR_upper_R017_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))

IQR_upper_R021_75<- as.data.frame(IQR_upper_R021_75)
data_incident_IQR_upper_R021_75<- IQR_upper_R021_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))

IQR_upper_R025_75<- as.data.frame(IQR_upper_R025_75)
data_incident_IQR_upper_R025_75<- IQR_upper_R025_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:6]))%>%
  mutate(cat3=rowSums(.[7:9]))%>%
  mutate(cat4=rowSums(.[10:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


########################################
data_combined_cats_median_R017_100<- data_incident_median_R017_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R017_100<- data_incident_mean_R017_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R017_100<- data_incident_upper_R017_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R017_100<- data_incident_lower_R017_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)
#########################################
data_combined_cats_median_R017_75<- data_incident_median_R017_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R017_75<- data_incident_mean_R017_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R017_75<- data_incident_upper_R017_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R017_75<- data_incident_lower_R017_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_IQR_lower_R017_75<- data_incident_IQR_lower_R017_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_IQR_upper_R017_75<- data_incident_IQR_upper_R017_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)
####################################
data_combined_cats_median_R017_50<- data_incident_median_R017_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R017_50<- data_incident_mean_R017_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R017_50<- data_incident_upper_R017_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R017_50<- data_incident_lower_R017_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)
#####################################
data_combined_cats_median_R021_100<- data_incident_median_R021_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R021_100<- data_incident_mean_R021_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R021_100<- data_incident_upper_R021_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R021_100<- data_incident_lower_R021_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)
#####################################
data_combined_cats_median_R021_75<- data_incident_median_R021_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R021_75<- data_incident_mean_R021_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R021_75<- data_incident_upper_R021_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R021_75<- data_incident_lower_R021_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_IQR_lower_R021_75<- data_incident_IQR_lower_R021_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_IQR_upper_R021_75<- data_incident_IQR_upper_R021_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)
#######################################
data_combined_cats_median_R021_50<- data_incident_median_R021_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R021_50<- data_incident_mean_R021_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R021_50<- data_incident_upper_R021_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R021_50<- data_incident_lower_R021_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)
#######################################
data_combined_cats_median_R025_100<- data_incident_median_R025_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R025_100<- data_incident_mean_R025_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R025_100<- data_incident_upper_R025_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R025_100<- data_incident_lower_R025_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)
########################################
data_combined_cats_median_R025_75<- data_incident_median_R025_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R025_75<- data_incident_mean_R025_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R025_75<- data_incident_upper_R025_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R025_75<- data_incident_lower_R025_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_IQR_lower_R025_75<- data_incident_IQR_lower_R025_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_IQR_upper_R025_75<- data_incident_IQR_upper_R025_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)
##########################################
data_combined_cats_median_R025_50<- data_incident_median_R025_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R025_50<- data_incident_mean_R025_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R025_50<- data_incident_upper_R025_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R025_50<- data_incident_lower_R025_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)



```


```{r, message=FALSE, warning=FALSE, echo=TRUE}

#working probabilities for severe cases, hospitalization, ICU, vent and death. 
#these are nested conditional probabilities, and they rely on the following  assumptions: 
#the percentage of severe cases in each categories is roughly an average of the percentage of people
#with diabetes, the percentage of people with cancer and the percentage of people with hypertension in each of the age cagegories. 
#we assume now that 100% of severe cases get hospitalized (this could be adjusted)
#we assume that globally, 24% of hospitalized cases get moved to ICU so this global percentage gets projected down to each age group
#we assume that 25% of ICU cases are put on a vent again this gets projected down to age groups
# we assume that 50% of ventilated cases die, again this is projected down to age groups. 
#HCW and homeless people have the same probabilities as people in category 4

#for now we are assuming the same number of incident infections in each category to simplify the calculations. 

#suppose all 8 categories have 100 people (100 incident infections on a given day)

#we are starting with the following assumptions about the proportion in each group that develop severe infections- groups are in ascending order of age with the last two groups being HCWs and homeless people we apply the assumptions we make for the 60-64 y.o. to them : 

#these are loosely based on an average of the proportion of poeple 
prob_severe<- c(0.0318, 0.043, 0.197, 0.357,0.409,0.357,0.357)

prob_hospitalized<- rep(1,ncol(data_combined_cats_median_R017_100))

prob_ICU<- c(0.15,0.15,0.2,0.247,0.3,0.247,0.247)

prob_vent<-c(0.1,0.1,0.125,0.259,0.337,0.259,0.259)

prob_death<-c(0.2,0.2,0.2,0.475,0.59,0.475,0.475)

prob_matrix<- cbind(prob_severe,prob_hospitalized,prob_ICU,
                    prob_vent,prob_death)



```


Now calculate the number in of severe, hospitalized, ICU and vented infections at each timepoint (day) in each group (age groups 1-12 and healthcare workers and homeless). 


```{r, message=FALSE, echo=TRUE, warning=FALSE}
#calculate number of incident cases that get classified as severe,  of those, 
#the number get hospitalized (currently 100%), of that then those that get classified as ICU and then of those that get put on a vent and of those the ones that die 11 days later (11 day lag for death prob)
#this is for each age group (+ HCW and homeless)
#note this categorization is NOT a disease progression, a person gets assigned based on the worst state they could possibly reach. 


counts_array_median_R017_100<- array(NA, dim=c(nrow(data_combined_cats_median_R017_100),ncol(data_combined_cats_median_R017_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R017_100)){
  for(i in 1:nrow(data_combined_cats_median_R017_100)){
      counts_array_median_R017_100[i,j,1]<- data_combined_cats_median_R017_100[i,j]*prob_matrix[j,1]
      counts_array_median_R017_100[i,j,2]<- counts_array_median_R017_100[i,j,1]*prob_matrix[j,2]
      counts_array_median_R017_100[i,j,3]<- counts_array_median_R017_100[i,j,2]*prob_matrix[j,3]
      counts_array_median_R017_100[i,j,4]<- counts_array_median_R017_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R017_100)){
    if(k<=11){
      counts_array_median_R017_100[k,j,5]<- 0
    }
    else{
      counts_array_median_R017_100[k,j,5]<- counts_array_median_R017_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R017_100<- array(NA, dim=c(nrow(data_combined_cats_mean_R017_100),ncol(data_combined_cats_mean_R017_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R017_100)){
  for(i in 1:nrow(data_combined_cats_mean_R017_100)){
      counts_array_mean_R017_100[i,j,1]<- data_combined_cats_mean_R017_100[i,j]*prob_matrix[j,1]
      counts_array_mean_R017_100[i,j,2]<- counts_array_mean_R017_100[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R017_100[i,j,3]<- counts_array_mean_R017_100[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R017_100[i,j,4]<- counts_array_mean_R017_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R017_100)){
    if(k<=11){
      counts_array_mean_R017_100[k,j,5]<- 0
    }
    else{
      counts_array_mean_R017_100[k,j,5]<- counts_array_mean_R017_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R017_100<- array(NA, dim=c(nrow(data_combined_cats_upper_R017_100),ncol(data_combined_cats_upper_R017_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R017_100)){
  for(i in 1:nrow(data_combined_cats_upper_R017_100)){
      counts_array_upper_R017_100[i,j,1]<- data_combined_cats_upper_R017_100[i,j]*prob_matrix[j,1]
      counts_array_upper_R017_100[i,j,2]<- counts_array_upper_R017_100[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R017_100[i,j,3]<- counts_array_upper_R017_100[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R017_100[i,j,4]<- counts_array_upper_R017_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R017_100)){
    if(k<=11){
      counts_array_upper_R017_100[k,j,5]<- 0
    }
    else{
      counts_array_upper_R017_100[k,j,5]<- counts_array_upper_R017_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R017_100<- array(NA, dim=c(nrow(data_combined_cats_lower_R017_100),ncol(data_combined_cats_lower_R017_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R017_100)){
  for(i in 1:nrow(data_combined_cats_lower_R017_100)){
      counts_array_lower_R017_100[i,j,1]<- data_combined_cats_lower_R017_100[i,j]*prob_matrix[j,1]
      counts_array_lower_R017_100[i,j,2]<- counts_array_lower_R017_100[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R017_100[i,j,3]<- counts_array_lower_R017_100[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R017_100[i,j,4]<- counts_array_lower_R017_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R017_100)){
    if(k<=11){
      counts_array_lower_R017_100[k,j,5]<- 0
    }
    else{
      counts_array_lower_R017_100[k,j,5]<- counts_array_lower_R017_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}
#################################################



counts_array_median_R017_75<- array(NA, dim=c(nrow(data_combined_cats_median_R017_75),ncol(data_combined_cats_median_R017_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R017_75)){
  for(i in 1:nrow(data_combined_cats_median_R017_75)){
      counts_array_median_R017_75[i,j,1]<- data_combined_cats_median_R017_75[i,j]*prob_matrix[j,1]
      counts_array_median_R017_75[i,j,2]<- counts_array_median_R017_75[i,j,1]*prob_matrix[j,2]
      counts_array_median_R017_75[i,j,3]<- counts_array_median_R017_75[i,j,2]*prob_matrix[j,3]
      counts_array_median_R017_75[i,j,4]<- counts_array_median_R017_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R017_75)){
    if(k<=11){
      counts_array_median_R017_75[k,j,5]<- 0
    }
    else{
      counts_array_median_R017_75[k,j,5]<- counts_array_median_R017_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R017_75<- array(NA, dim=c(nrow(data_combined_cats_mean_R017_75),ncol(data_combined_cats_mean_R017_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R017_75)){
  for(i in 1:nrow(data_combined_cats_mean_R017_75)){
      counts_array_mean_R017_75[i,j,1]<- data_combined_cats_mean_R017_75[i,j]*prob_matrix[j,1]
      counts_array_mean_R017_75[i,j,2]<- counts_array_mean_R017_75[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R017_75[i,j,3]<- counts_array_mean_R017_75[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R017_75[i,j,4]<- counts_array_mean_R017_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R017_75)){
    if(k<=11){
      counts_array_mean_R017_75[k,j,5]<- 0
    }
    else{
      counts_array_mean_R017_75[k,j,5]<- counts_array_mean_R017_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R017_75<- array(NA, dim=c(nrow(data_combined_cats_upper_R017_75),ncol(data_combined_cats_upper_R017_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R017_75)){
  for(i in 1:nrow(data_combined_cats_upper_R017_75)){
      counts_array_upper_R017_75[i,j,1]<- data_combined_cats_upper_R017_75[i,j]*prob_matrix[j,1]
      counts_array_upper_R017_75[i,j,2]<- counts_array_upper_R017_75[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R017_75[i,j,3]<- counts_array_upper_R017_75[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R017_75[i,j,4]<- counts_array_upper_R017_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R017_75)){
    if(k<=11){
      counts_array_upper_R017_75[k,j,5]<- 0
    }
    else{
      counts_array_upper_R017_75[k,j,5]<- counts_array_upper_R017_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_IQR_upper_R017_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_upper_R017_75),ncol(data_combined_cats_IQR_upper_R017_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_IQR_upper_R017_75)){
  for(i in 1:nrow(data_combined_cats_IQR_upper_R017_75)){
      counts_array_IQR_upper_R017_75[i,j,1]<- data_combined_cats_IQR_upper_R017_75[i,j]*prob_matrix[j,1]
      counts_array_IQR_upper_R017_75[i,j,2]<- counts_array_IQR_upper_R017_75[i,j,1]*prob_matrix[j,2]
      counts_array_IQR_upper_R017_75[i,j,3]<- counts_array_IQR_upper_R017_75[i,j,2]*prob_matrix[j,3]
      counts_array_IQR_upper_R017_75[i,j,4]<- counts_array_IQR_upper_R017_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_IQR_upper_R017_75)){
    if(k<=11){
      counts_array_IQR_upper_R017_75[k,j,5]<- 0
    }
    else{
      counts_array_IQR_upper_R017_75[k,j,5]<- counts_array_IQR_upper_R017_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R017_75<- array(NA, dim=c(nrow(data_combined_cats_lower_R017_75),ncol(data_combined_cats_lower_R017_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R017_75)){
  for(i in 1:nrow(data_combined_cats_lower_R017_75)){
      counts_array_lower_R017_75[i,j,1]<- data_combined_cats_lower_R017_75[i,j]*prob_matrix[j,1]
      counts_array_lower_R017_75[i,j,2]<- counts_array_lower_R017_75[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R017_75[i,j,3]<- counts_array_lower_R017_75[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R017_75[i,j,4]<- counts_array_lower_R017_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R017_75)){
    if(k<=11){
      counts_array_lower_R017_75[k,j,5]<- 0
    }
    else{
      counts_array_lower_R017_75[k,j,5]<- counts_array_lower_R017_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_IQR_lower_R017_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_lower_R017_75),ncol(data_combined_cats_IQR_lower_R017_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_IQR_lower_R017_75)){
  for(i in 1:nrow(data_combined_cats_IQR_lower_R017_75)){
      counts_array_IQR_lower_R017_75[i,j,1]<- data_combined_cats_IQR_lower_R017_75[i,j]*prob_matrix[j,1]
      counts_array_IQR_lower_R017_75[i,j,2]<- counts_array_IQR_lower_R017_75[i,j,1]*prob_matrix[j,2]
      counts_array_IQR_lower_R017_75[i,j,3]<- counts_array_IQR_lower_R017_75[i,j,2]*prob_matrix[j,3]
      counts_array_IQR_lower_R017_75[i,j,4]<- counts_array_IQR_lower_R017_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_IQR_lower_R017_75)){
    if(k<=11){
      counts_array_IQR_lower_R017_75[k,j,5]<- 0
    }
    else{
      counts_array_IQR_lower_R017_75[k,j,5]<- counts_array_IQR_lower_R017_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

################################################################


counts_array_median_R017_50<- array(NA, dim=c(nrow(data_combined_cats_median_R017_50),ncol(data_combined_cats_median_R017_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R017_50)){
  for(i in 1:nrow(data_combined_cats_median_R017_50)){
      counts_array_median_R017_50[i,j,1]<- data_combined_cats_median_R017_50[i,j]*prob_matrix[j,1]
      counts_array_median_R017_50[i,j,2]<- counts_array_median_R017_50[i,j,1]*prob_matrix[j,2]
      counts_array_median_R017_50[i,j,3]<- counts_array_median_R017_50[i,j,2]*prob_matrix[j,3]
      counts_array_median_R017_50[i,j,4]<- counts_array_median_R017_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R017_50)){
    if(k<=11){
      counts_array_median_R017_50[k,j,5]<- 0
    }
    else{
      counts_array_median_R017_50[k,j,5]<- counts_array_median_R017_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R017_50<- array(NA, dim=c(nrow(data_combined_cats_mean_R017_50),ncol(data_combined_cats_mean_R017_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R017_50)){
  for(i in 1:nrow(data_combined_cats_mean_R017_50)){
      counts_array_mean_R017_50[i,j,1]<- data_combined_cats_mean_R017_50[i,j]*prob_matrix[j,1]
      counts_array_mean_R017_50[i,j,2]<- counts_array_mean_R017_50[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R017_50[i,j,3]<- counts_array_mean_R017_50[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R017_50[i,j,4]<- counts_array_mean_R017_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R017_50)){
    if(k<=11){
      counts_array_mean_R017_50[k,j,5]<- 0
    }
    else{
      counts_array_mean_R017_50[k,j,5]<- counts_array_mean_R017_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R017_50<- array(NA, dim=c(nrow(data_combined_cats_upper_R017_50),ncol(data_combined_cats_upper_R017_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R017_50)){
  for(i in 1:nrow(data_combined_cats_upper_R017_50)){
      counts_array_upper_R017_50[i,j,1]<- data_combined_cats_upper_R017_50[i,j]*prob_matrix[j,1]
      counts_array_upper_R017_50[i,j,2]<- counts_array_upper_R017_50[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R017_50[i,j,3]<- counts_array_upper_R017_50[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R017_50[i,j,4]<- counts_array_upper_R017_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R017_50)){
    if(k<=11){
      counts_array_upper_R017_50[k,j,5]<- 0
    }
    else{
      counts_array_upper_R017_50[k,j,5]<- counts_array_upper_R017_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R017_50<- array(NA, dim=c(nrow(data_combined_cats_lower_R017_50),ncol(data_combined_cats_lower_R017_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R017_50)){
  for(i in 1:nrow(data_combined_cats_lower_R017_50)){
      counts_array_lower_R017_50[i,j,1]<- data_combined_cats_lower_R017_50[i,j]*prob_matrix[j,1]
      counts_array_lower_R017_50[i,j,2]<- counts_array_lower_R017_50[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R017_50[i,j,3]<- counts_array_lower_R017_50[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R017_50[i,j,4]<- counts_array_lower_R017_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R017_50)){
    if(k<=11){
      counts_array_lower_R017_50[k,j,5]<- 0
    }
    else{
      counts_array_lower_R017_50[k,j,5]<- counts_array_lower_R017_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


####################################


counts_array_median_R021_100<- array(NA, dim=c(nrow(data_combined_cats_median_R021_100),ncol(data_combined_cats_median_R021_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R021_100)){
  for(i in 1:nrow(data_combined_cats_median_R021_100)){
      counts_array_median_R021_100[i,j,1]<- data_combined_cats_median_R021_100[i,j]*prob_matrix[j,1]
      counts_array_median_R021_100[i,j,2]<- counts_array_median_R021_100[i,j,1]*prob_matrix[j,2]
      counts_array_median_R021_100[i,j,3]<- counts_array_median_R021_100[i,j,2]*prob_matrix[j,3]
      counts_array_median_R021_100[i,j,4]<- counts_array_median_R021_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R021_100)){
    if(k<=11){
      counts_array_median_R021_100[k,j,5]<- 0
    }
    else{
      counts_array_median_R021_100[k,j,5]<- counts_array_median_R021_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R021_100<- array(NA, dim=c(nrow(data_combined_cats_mean_R021_100),ncol(data_combined_cats_mean_R021_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R021_100)){
  for(i in 1:nrow(data_combined_cats_mean_R021_100)){
      counts_array_mean_R021_100[i,j,1]<- data_combined_cats_mean_R021_100[i,j]*prob_matrix[j,1]
      counts_array_mean_R021_100[i,j,2]<- counts_array_mean_R021_100[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R021_100[i,j,3]<- counts_array_mean_R021_100[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R021_100[i,j,4]<- counts_array_mean_R021_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R021_100)){
    if(k<=11){
      counts_array_mean_R021_100[k,j,5]<- 0
    }
    else{
      counts_array_mean_R021_100[k,j,5]<- counts_array_mean_R021_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R021_100<- array(NA, dim=c(nrow(data_combined_cats_upper_R021_100),ncol(data_combined_cats_upper_R021_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R021_100)){
  for(i in 1:nrow(data_combined_cats_upper_R021_100)){
      counts_array_upper_R021_100[i,j,1]<- data_combined_cats_upper_R021_100[i,j]*prob_matrix[j,1]
      counts_array_upper_R021_100[i,j,2]<- counts_array_upper_R021_100[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R021_100[i,j,3]<- counts_array_upper_R021_100[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R021_100[i,j,4]<- counts_array_upper_R021_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R021_100)){
    if(k<=11){
      counts_array_upper_R021_100[k,j,5]<- 0
    }
    else{
      counts_array_upper_R021_100[k,j,5]<- counts_array_upper_R021_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R021_100<- array(NA, dim=c(nrow(data_combined_cats_lower_R021_100),ncol(data_combined_cats_lower_R021_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R021_100)){
  for(i in 1:nrow(data_combined_cats_lower_R021_100)){
      counts_array_lower_R021_100[i,j,1]<- data_combined_cats_lower_R021_100[i,j]*prob_matrix[j,1]
      counts_array_lower_R021_100[i,j,2]<- counts_array_lower_R021_100[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R021_100[i,j,3]<- counts_array_lower_R021_100[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R021_100[i,j,4]<- counts_array_lower_R021_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R021_100)){
    if(k<=11){
      counts_array_lower_R021_100[k,j,5]<- 0
    }
    else{
      counts_array_lower_R021_100[k,j,5]<- counts_array_lower_R021_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

#######################################


counts_array_median_R021_75<- array(NA, dim=c(nrow(data_combined_cats_median_R021_75),ncol(data_combined_cats_median_R021_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R021_75)){
  for(i in 1:nrow(data_combined_cats_median_R021_75)){
      counts_array_median_R021_75[i,j,1]<- data_combined_cats_median_R021_75[i,j]*prob_matrix[j,1]
      counts_array_median_R021_75[i,j,2]<- counts_array_median_R021_75[i,j,1]*prob_matrix[j,2]
      counts_array_median_R021_75[i,j,3]<- counts_array_median_R021_75[i,j,2]*prob_matrix[j,3]
      counts_array_median_R021_75[i,j,4]<- counts_array_median_R021_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R021_75)){
    if(k<=11){
      counts_array_median_R021_75[k,j,5]<- 0
    }
    else{
      counts_array_median_R021_75[k,j,5]<- counts_array_median_R021_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R021_75<- array(NA, dim=c(nrow(data_combined_cats_mean_R021_75),ncol(data_combined_cats_mean_R021_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R021_75)){
  for(i in 1:nrow(data_combined_cats_mean_R021_75)){
      counts_array_mean_R021_75[i,j,1]<- data_combined_cats_mean_R021_75[i,j]*prob_matrix[j,1]
      counts_array_mean_R021_75[i,j,2]<- counts_array_mean_R021_75[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R021_75[i,j,3]<- counts_array_mean_R021_75[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R021_75[i,j,4]<- counts_array_mean_R021_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R021_75)){
    if(k<=11){
      counts_array_mean_R021_75[k,j,5]<- 0
    }
    else{
      counts_array_mean_R021_75[k,j,5]<- counts_array_mean_R021_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R021_75<- array(NA, dim=c(nrow(data_combined_cats_upper_R021_75),ncol(data_combined_cats_upper_R021_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R021_75)){
  for(i in 1:nrow(data_combined_cats_upper_R021_75)){
      counts_array_upper_R021_75[i,j,1]<- data_combined_cats_upper_R021_75[i,j]*prob_matrix[j,1]
      counts_array_upper_R021_75[i,j,2]<- counts_array_upper_R021_75[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R021_75[i,j,3]<- counts_array_upper_R021_75[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R021_75[i,j,4]<- counts_array_upper_R021_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R021_75)){
    if(k<=11){
      counts_array_upper_R021_75[k,j,5]<- 0
    }
    else{
      counts_array_upper_R021_75[k,j,5]<- counts_array_upper_R021_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_IQR_upper_R021_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_upper_R021_75),ncol(data_combined_cats_IQR_upper_R021_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_IQR_upper_R021_75)){
  for(i in 1:nrow(data_combined_cats_IQR_upper_R021_75)){
      counts_array_IQR_upper_R021_75[i,j,1]<- data_combined_cats_IQR_upper_R021_75[i,j]*prob_matrix[j,1]
      counts_array_IQR_upper_R021_75[i,j,2]<- counts_array_IQR_upper_R021_75[i,j,1]*prob_matrix[j,2]
      counts_array_IQR_upper_R021_75[i,j,3]<- counts_array_IQR_upper_R021_75[i,j,2]*prob_matrix[j,3]
      counts_array_IQR_upper_R021_75[i,j,4]<- counts_array_IQR_upper_R021_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_IQR_upper_R021_75)){
    if(k<=11){
      counts_array_IQR_upper_R021_75[k,j,5]<- 0
    }
    else{
      counts_array_IQR_upper_R021_75[k,j,5]<- counts_array_IQR_upper_R021_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R021_75<- array(NA, dim=c(nrow(data_combined_cats_lower_R021_75),ncol(data_combined_cats_lower_R021_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R021_75)){
  for(i in 1:nrow(data_combined_cats_lower_R021_75)){
      counts_array_lower_R021_75[i,j,1]<- data_combined_cats_lower_R021_75[i,j]*prob_matrix[j,1]
      counts_array_lower_R021_75[i,j,2]<- counts_array_lower_R021_75[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R021_75[i,j,3]<- counts_array_lower_R021_75[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R021_75[i,j,4]<- counts_array_lower_R021_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R021_75)){
    if(k<=11){
      counts_array_lower_R021_75[k,j,5]<- 0
    }
    else{
      counts_array_lower_R021_75[k,j,5]<- counts_array_lower_R021_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_IQR_lower_R021_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_lower_R021_75),ncol(data_combined_cats_IQR_lower_R021_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_IQR_lower_R021_75)){
  for(i in 1:nrow(data_combined_cats_IQR_lower_R021_75)){
      counts_array_IQR_lower_R021_75[i,j,1]<- data_combined_cats_IQR_lower_R021_75[i,j]*prob_matrix[j,1]
      counts_array_IQR_lower_R021_75[i,j,2]<- counts_array_IQR_lower_R021_75[i,j,1]*prob_matrix[j,2]
      counts_array_IQR_lower_R021_75[i,j,3]<- counts_array_IQR_lower_R021_75[i,j,2]*prob_matrix[j,3]
      counts_array_IQR_lower_R021_75[i,j,4]<- counts_array_IQR_lower_R021_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_IQR_lower_R021_75)){
    if(k<=11){
      counts_array_IQR_lower_R021_75[k,j,5]<- 0
    }
    else{
      counts_array_IQR_lower_R021_75[k,j,5]<- counts_array_IQR_lower_R021_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

#########################################


counts_array_median_R021_50<- array(NA, dim=c(nrow(data_combined_cats_median_R021_50),ncol(data_combined_cats_median_R021_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R021_50)){
  for(i in 1:nrow(data_combined_cats_median_R021_50)){
      counts_array_median_R021_50[i,j,1]<- data_combined_cats_median_R021_50[i,j]*prob_matrix[j,1]
      counts_array_median_R021_50[i,j,2]<- counts_array_median_R021_50[i,j,1]*prob_matrix[j,2]
      counts_array_median_R021_50[i,j,3]<- counts_array_median_R021_50[i,j,2]*prob_matrix[j,3]
      counts_array_median_R021_50[i,j,4]<- counts_array_median_R021_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R021_50)){
    if(k<=11){
      counts_array_median_R021_50[k,j,5]<- 0
    }
    else{
      counts_array_median_R021_50[k,j,5]<- counts_array_median_R021_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R021_50<- array(NA, dim=c(nrow(data_combined_cats_mean_R021_50),ncol(data_combined_cats_mean_R021_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R021_50)){
  for(i in 1:nrow(data_combined_cats_mean_R021_50)){
      counts_array_mean_R021_50[i,j,1]<- data_combined_cats_mean_R021_50[i,j]*prob_matrix[j,1]
      counts_array_mean_R021_50[i,j,2]<- counts_array_mean_R021_50[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R021_50[i,j,3]<- counts_array_mean_R021_50[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R021_50[i,j,4]<- counts_array_mean_R021_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R021_50)){
    if(k<=11){
      counts_array_mean_R021_50[k,j,5]<- 0
    }
    else{
      counts_array_mean_R021_50[k,j,5]<- counts_array_mean_R021_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R021_50<- array(NA, dim=c(nrow(data_combined_cats_upper_R021_50),ncol(data_combined_cats_upper_R021_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R021_50)){
  for(i in 1:nrow(data_combined_cats_upper_R021_50)){
      counts_array_upper_R021_50[i,j,1]<- data_combined_cats_upper_R021_50[i,j]*prob_matrix[j,1]
      counts_array_upper_R021_50[i,j,2]<- counts_array_upper_R021_50[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R021_50[i,j,3]<- counts_array_upper_R021_50[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R021_50[i,j,4]<- counts_array_upper_R021_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R021_50)){
    if(k<=11){
      counts_array_upper_R021_50[k,j,5]<- 0
    }
    else{
      counts_array_upper_R021_50[k,j,5]<- counts_array_upper_R021_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R021_50<- array(NA, dim=c(nrow(data_combined_cats_lower_R021_50),ncol(data_combined_cats_lower_R021_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R021_50)){
  for(i in 1:nrow(data_combined_cats_lower_R021_50)){
      counts_array_lower_R021_50[i,j,1]<- data_combined_cats_lower_R021_50[i,j]*prob_matrix[j,1]
      counts_array_lower_R021_50[i,j,2]<- counts_array_lower_R021_50[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R021_50[i,j,3]<- counts_array_lower_R021_50[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R021_50[i,j,4]<- counts_array_lower_R021_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R021_50)){
    if(k<=11){
      counts_array_lower_R021_50[k,j,5]<- 0
    }
    else{
      counts_array_lower_R021_50[k,j,5]<- counts_array_lower_R021_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

###############################


counts_array_median_R025_100<- array(NA, dim=c(nrow(data_combined_cats_median_R025_100),ncol(data_combined_cats_median_R025_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R025_100)){
  for(i in 1:nrow(data_combined_cats_median_R025_100)){
      counts_array_median_R025_100[i,j,1]<- data_combined_cats_median_R025_100[i,j]*prob_matrix[j,1]
      counts_array_median_R025_100[i,j,2]<- counts_array_median_R025_100[i,j,1]*prob_matrix[j,2]
      counts_array_median_R025_100[i,j,3]<- counts_array_median_R025_100[i,j,2]*prob_matrix[j,3]
      counts_array_median_R025_100[i,j,4]<- counts_array_median_R025_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R025_100)){
    if(k<=11){
      counts_array_median_R025_100[k,j,5]<- 0
    }
    else{
      counts_array_median_R025_100[k,j,5]<- counts_array_median_R025_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R025_100<- array(NA, dim=c(nrow(data_combined_cats_mean_R025_100),ncol(data_combined_cats_mean_R025_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R025_100)){
  for(i in 1:nrow(data_combined_cats_mean_R025_100)){
      counts_array_mean_R025_100[i,j,1]<- data_combined_cats_mean_R025_100[i,j]*prob_matrix[j,1]
      counts_array_mean_R025_100[i,j,2]<- counts_array_mean_R025_100[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R025_100[i,j,3]<- counts_array_mean_R025_100[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R025_100[i,j,4]<- counts_array_mean_R025_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R025_100)){
    if(k<=11){
      counts_array_mean_R025_100[k,j,5]<- 0
    }
    else{
      counts_array_mean_R025_100[k,j,5]<- counts_array_mean_R025_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R025_100<- array(NA, dim=c(nrow(data_combined_cats_upper_R025_100),ncol(data_combined_cats_upper_R025_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R025_100)){
  for(i in 1:nrow(data_combined_cats_upper_R025_100)){
      counts_array_upper_R025_100[i,j,1]<- data_combined_cats_upper_R025_100[i,j]*prob_matrix[j,1]
      counts_array_upper_R025_100[i,j,2]<- counts_array_upper_R025_100[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R025_100[i,j,3]<- counts_array_upper_R025_100[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R025_100[i,j,4]<- counts_array_upper_R025_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R025_100)){
    if(k<=11){
      counts_array_upper_R025_100[k,j,5]<- 0
    }
    else{
      counts_array_upper_R025_100[k,j,5]<- counts_array_upper_R025_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R025_100<- array(NA, dim=c(nrow(data_combined_cats_lower_R025_100),ncol(data_combined_cats_lower_R025_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R025_100)){
  for(i in 1:nrow(data_combined_cats_lower_R025_100)){
      counts_array_lower_R025_100[i,j,1]<- data_combined_cats_lower_R025_100[i,j]*prob_matrix[j,1]
      counts_array_lower_R025_100[i,j,2]<- counts_array_lower_R025_100[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R025_100[i,j,3]<- counts_array_lower_R025_100[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R025_100[i,j,4]<- counts_array_lower_R025_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R025_100)){
    if(k<=11){
      counts_array_lower_R025_100[k,j,5]<- 0
    }
    else{
      counts_array_lower_R025_100[k,j,5]<- counts_array_lower_R025_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

####################################


counts_array_median_R025_75<- array(NA, dim=c(nrow(data_combined_cats_median_R025_75),ncol(data_combined_cats_median_R025_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R025_75)){
  for(i in 1:nrow(data_combined_cats_median_R025_75)){
      counts_array_median_R025_75[i,j,1]<- data_combined_cats_median_R025_75[i,j]*prob_matrix[j,1]
      counts_array_median_R025_75[i,j,2]<- counts_array_median_R025_75[i,j,1]*prob_matrix[j,2]
      counts_array_median_R025_75[i,j,3]<- counts_array_median_R025_75[i,j,2]*prob_matrix[j,3]
      counts_array_median_R025_75[i,j,4]<- counts_array_median_R025_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R025_75)){
    if(k<=11){
      counts_array_median_R025_75[k,j,5]<- 0
    }
    else{
      counts_array_median_R025_75[k,j,5]<- counts_array_median_R025_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R025_75<- array(NA, dim=c(nrow(data_combined_cats_mean_R025_75),ncol(data_combined_cats_mean_R025_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R025_75)){
  for(i in 1:nrow(data_combined_cats_mean_R025_75)){
      counts_array_mean_R025_75[i,j,1]<- data_combined_cats_mean_R025_75[i,j]*prob_matrix[j,1]
      counts_array_mean_R025_75[i,j,2]<- counts_array_mean_R025_75[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R025_75[i,j,3]<- counts_array_mean_R025_75[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R025_75[i,j,4]<- counts_array_mean_R025_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R025_75)){
    if(k<=11){
      counts_array_mean_R025_75[k,j,5]<- 0
    }
    else{
      counts_array_mean_R025_75[k,j,5]<- counts_array_mean_R025_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R025_75<- array(NA, dim=c(nrow(data_combined_cats_upper_R025_75),ncol(data_combined_cats_upper_R025_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R025_75)){
  for(i in 1:nrow(data_combined_cats_upper_R025_75)){
      counts_array_upper_R025_75[i,j,1]<- data_combined_cats_upper_R025_75[i,j]*prob_matrix[j,1]
      counts_array_upper_R025_75[i,j,2]<- counts_array_upper_R025_75[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R025_75[i,j,3]<- counts_array_upper_R025_75[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R025_75[i,j,4]<- counts_array_upper_R025_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R025_75)){
    if(k<=11){
      counts_array_upper_R025_75[k,j,5]<- 0
    }
    else{
      counts_array_upper_R025_75[k,j,5]<- counts_array_upper_R025_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_IQR_upper_R025_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_upper_R025_75),ncol(data_combined_cats_IQR_upper_R025_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_IQR_upper_R025_75)){
  for(i in 1:nrow(data_combined_cats_IQR_upper_R025_75)){
      counts_array_IQR_upper_R025_75[i,j,1]<- data_combined_cats_IQR_upper_R025_75[i,j]*prob_matrix[j,1]
      counts_array_IQR_upper_R025_75[i,j,2]<- counts_array_IQR_upper_R025_75[i,j,1]*prob_matrix[j,2]
      counts_array_IQR_upper_R025_75[i,j,3]<- counts_array_IQR_upper_R025_75[i,j,2]*prob_matrix[j,3]
      counts_array_IQR_upper_R025_75[i,j,4]<- counts_array_IQR_upper_R025_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_IQR_upper_R025_75)){
    if(k<=11){
      counts_array_IQR_upper_R025_75[k,j,5]<- 0
    }
    else{
      counts_array_IQR_upper_R025_75[k,j,5]<- counts_array_IQR_upper_R025_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R025_75<- array(NA, dim=c(nrow(data_combined_cats_lower_R025_75),ncol(data_combined_cats_lower_R025_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R025_75)){
  for(i in 1:nrow(data_combined_cats_lower_R025_75)){
      counts_array_lower_R025_75[i,j,1]<- data_combined_cats_lower_R025_75[i,j]*prob_matrix[j,1]
      counts_array_lower_R025_75[i,j,2]<- counts_array_lower_R025_75[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R025_75[i,j,3]<- counts_array_lower_R025_75[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R025_75[i,j,4]<- counts_array_lower_R025_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R025_75)){
    if(k<=11){
      counts_array_lower_R025_75[k,j,5]<- 0
    }
    else{
      counts_array_lower_R025_75[k,j,5]<- counts_array_lower_R025_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_IQR_lower_R025_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_lower_R025_75),ncol(data_combined_cats_IQR_lower_R025_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_IQR_lower_R025_75)){
  for(i in 1:nrow(data_combined_cats_IQR_lower_R025_75)){
      counts_array_IQR_lower_R025_75[i,j,1]<- data_combined_cats_IQR_lower_R025_75[i,j]*prob_matrix[j,1]
      counts_array_IQR_lower_R025_75[i,j,2]<- counts_array_IQR_lower_R025_75[i,j,1]*prob_matrix[j,2]
      counts_array_IQR_lower_R025_75[i,j,3]<- counts_array_IQR_lower_R025_75[i,j,2]*prob_matrix[j,3]
      counts_array_IQR_lower_R025_75[i,j,4]<- counts_array_IQR_lower_R025_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_IQR_lower_R025_75)){
    if(k<=11){
      counts_array_IQR_lower_R025_75[k,j,5]<- 0
    }
    else{
      counts_array_IQR_lower_R025_75[k,j,5]<- counts_array_IQR_lower_R025_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

###########################################


counts_array_median_R025_50<- array(NA, dim=c(nrow(data_combined_cats_median_R025_50),ncol(data_combined_cats_median_R025_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R025_50)){
  for(i in 1:nrow(data_combined_cats_median_R025_50)){
      counts_array_median_R025_50[i,j,1]<- data_combined_cats_median_R025_50[i,j]*prob_matrix[j,1]
      counts_array_median_R025_50[i,j,2]<- counts_array_median_R025_50[i,j,1]*prob_matrix[j,2]
      counts_array_median_R025_50[i,j,3]<- counts_array_median_R025_50[i,j,2]*prob_matrix[j,3]
      counts_array_median_R025_50[i,j,4]<- counts_array_median_R025_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R025_50)){
    if(k<=11){
      counts_array_median_R025_50[k,j,5]<- 0
    }
    else{
      counts_array_median_R025_50[k,j,5]<- counts_array_median_R025_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R025_50<- array(NA, dim=c(nrow(data_combined_cats_mean_R025_50),ncol(data_combined_cats_mean_R025_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R025_50)){
  for(i in 1:nrow(data_combined_cats_mean_R025_50)){
      counts_array_mean_R025_50[i,j,1]<- data_combined_cats_mean_R025_50[i,j]*prob_matrix[j,1]
      counts_array_mean_R025_50[i,j,2]<- counts_array_mean_R025_50[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R025_50[i,j,3]<- counts_array_mean_R025_50[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R025_50[i,j,4]<- counts_array_mean_R025_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R025_50)){
    if(k<=11){
      counts_array_mean_R025_50[k,j,5]<- 0
    }
    else{
      counts_array_mean_R025_50[k,j,5]<- counts_array_mean_R025_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R025_50<- array(NA, dim=c(nrow(data_combined_cats_upper_R025_50),ncol(data_combined_cats_upper_R025_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R025_50)){
  for(i in 1:nrow(data_combined_cats_upper_R025_50)){
      counts_array_upper_R025_50[i,j,1]<- data_combined_cats_upper_R025_50[i,j]*prob_matrix[j,1]
      counts_array_upper_R025_50[i,j,2]<- counts_array_upper_R025_50[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R025_50[i,j,3]<- counts_array_upper_R025_50[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R025_50[i,j,4]<- counts_array_upper_R025_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R025_50)){
    if(k<=11){
      counts_array_upper_R025_50[k,j,5]<- 0
    }
    else{
      counts_array_upper_R025_50[k,j,5]<- counts_array_upper_R025_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R025_50<- array(NA, dim=c(nrow(data_combined_cats_lower_R025_50),ncol(data_combined_cats_lower_R025_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R025_50)){
  for(i in 1:nrow(data_combined_cats_lower_R025_50)){
      counts_array_lower_R025_50[i,j,1]<- data_combined_cats_lower_R025_50[i,j]*prob_matrix[j,1]
      counts_array_lower_R025_50[i,j,2]<- counts_array_lower_R025_50[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R025_50[i,j,3]<- counts_array_lower_R025_50[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R025_50[i,j,4]<- counts_array_lower_R025_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R025_50)){
    if(k<=11){
      counts_array_lower_R025_50[k,j,5]<- 0
    }
    else{
      counts_array_lower_R025_50[k,j,5]<- counts_array_lower_R025_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}
```

Now  load in a dataset that gives estimates of how long people stay hospitalized, in ICU or on vents
Compute a running total of each category.
```{r,message=FALSE, warning=FALSE, echo=TRUE}
#for now we are supposing we get a point estimate to determine how long people stay in each of the states. 

length_of_stay<- c(NA,11,11,11,NA)

cumulative_array_median_R017_100<- array(NA, dim=c(nrow(data_combined_cats_median_R017_100),ncol(data_combined_cats_median_R017_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R017_100)){
    cumulative_array_median_R017_100[1,j,]<- counts_array_median_R017_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R017_100)){
      cumulative_array_median_R017_100[i,j,1]<-cumulative_array_median_R017_100[i-1,j,1]+counts_array_median_R017_100[i,j,1]
      cumulative_array_median_R017_100[i,j,5]<-cumulative_array_median_R017_100[i-1,j,5]+counts_array_median_R017_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R017_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R017_100[k,j,2]<- cumulative_array_median_R017_100[k-1,j,2]+counts_array_median_R017_100[k,j,2]
      }
      else {
        cumulative_array_median_R017_100[k,j,2]<-cumulative_array_median_R017_100[k-1,j,2]+
          counts_array_median_R017_100[k,j,2]-counts_array_median_R017_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R017_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R017_100[l,j,3]<- cumulative_array_median_R017_100[l-1,j,3]+counts_array_median_R017_100[l,j,3]
      }
    else{
      cumulative_array_median_R017_100[l,j,3]<-cumulative_array_median_R017_100[l-1,j,3]+
          counts_array_median_R017_100[l,j,3]-counts_array_median_R017_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R017_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R017_100[m,j,4]<- cumulative_array_median_R017_100[m-1,j,4]+counts_array_median_R017_100[m,j,4]
    }
    else{
      cumulative_array_median_R017_100[m,j,4]<-cumulative_array_median_R017_100[m-1,j,4]+
          counts_array_median_R017_100[m,j,4]-counts_array_median_R017_100[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R017_100<- array(NA, dim=c(nrow(data_combined_cats_mean_R017_100),ncol(data_combined_cats_mean_R017_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R017_100)){
    cumulative_array_mean_R017_100[1,j,]<- counts_array_mean_R017_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R017_100)){
      cumulative_array_mean_R017_100[i,j,1]<-cumulative_array_mean_R017_100[i-1,j,1]+counts_array_mean_R017_100[i,j,1]
      cumulative_array_mean_R017_100[i,j,5]<-cumulative_array_mean_R017_100[i-1,j,5]+counts_array_mean_R017_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R017_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R017_100[k,j,2]<- cumulative_array_mean_R017_100[k-1,j,2]+counts_array_mean_R017_100[k,j,2]
      }
      else {
        cumulative_array_mean_R017_100[k,j,2]<-cumulative_array_mean_R017_100[k-1,j,2]+
          counts_array_mean_R017_100[k,j,2]-counts_array_mean_R017_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R017_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R017_100[l,j,3]<- cumulative_array_mean_R017_100[l-1,j,3]+counts_array_mean_R017_100[l,j,3]
      }
    else{
      cumulative_array_mean_R017_100[l,j,3]<-cumulative_array_mean_R017_100[l-1,j,3]+
          counts_array_mean_R017_100[l,j,3]-counts_array_mean_R017_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R017_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R017_100[m,j,4]<- cumulative_array_mean_R017_100[m-1,j,4]+counts_array_mean_R017_100[m,j,4]
    }
    else{
      cumulative_array_mean_R017_100[m,j,4]<-cumulative_array_mean_R017_100[m-1,j,4]+
          counts_array_mean_R017_100[m,j,4]-counts_array_mean_R017_100[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R017_100<- array(NA, dim=c(nrow(data_combined_cats_lower_R017_100),ncol(data_combined_cats_lower_R017_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R017_100)){
    cumulative_array_lower_R017_100[1,j,]<- counts_array_lower_R017_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R017_100)){
      cumulative_array_lower_R017_100[i,j,1]<-cumulative_array_lower_R017_100[i-1,j,1]+counts_array_lower_R017_100[i,j,1]
      cumulative_array_lower_R017_100[i,j,5]<-cumulative_array_lower_R017_100[i-1,j,5]+counts_array_lower_R017_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R017_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R017_100[k,j,2]<- cumulative_array_lower_R017_100[k-1,j,2]+counts_array_lower_R017_100[k,j,2]
      }
      else {
        cumulative_array_lower_R017_100[k,j,2]<-cumulative_array_lower_R017_100[k-1,j,2]+
          counts_array_lower_R017_100[k,j,2]-counts_array_lower_R017_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R017_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R017_100[l,j,3]<- cumulative_array_lower_R017_100[l-1,j,3]+counts_array_lower_R017_100[l,j,3]
      }
    else{
      cumulative_array_lower_R017_100[l,j,3]<-cumulative_array_lower_R017_100[l-1,j,3]+
          counts_array_lower_R017_100[l,j,3]-counts_array_lower_R017_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R017_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R017_100[m,j,4]<- cumulative_array_lower_R017_100[m-1,j,4]+counts_array_lower_R017_100[m,j,4]
    }
    else{
      cumulative_array_lower_R017_100[m,j,4]<-cumulative_array_lower_R017_100[m-1,j,4]+
          counts_array_lower_R017_100[m,j,4]-counts_array_lower_R017_100[m-length_of_stay[4],j,4]
      }
    }
   
}



cumulative_array_upper_R017_100<- array(NA, dim=c(nrow(data_combined_cats_upper_R017_100),ncol(data_combined_cats_upper_R017_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R017_100)){
    cumulative_array_upper_R017_100[1,j,]<- counts_array_upper_R017_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R017_100)){
      cumulative_array_upper_R017_100[i,j,1]<-cumulative_array_upper_R017_100[i-1,j,1]+counts_array_upper_R017_100[i,j,1]
      cumulative_array_upper_R017_100[i,j,5]<-cumulative_array_upper_R017_100[i-1,j,5]+counts_array_upper_R017_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R017_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R017_100[k,j,2]<- cumulative_array_upper_R017_100[k-1,j,2]+counts_array_upper_R017_100[k,j,2]
      }
      else {
        cumulative_array_upper_R017_100[k,j,2]<-cumulative_array_upper_R017_100[k-1,j,2]+
          counts_array_upper_R017_100[k,j,2]-counts_array_upper_R017_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R017_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R017_100[l,j,3]<- cumulative_array_upper_R017_100[l-1,j,3]+counts_array_upper_R017_100[l,j,3]
      }
    else{
      cumulative_array_upper_R017_100[l,j,3]<-cumulative_array_upper_R017_100[l-1,j,3]+
          counts_array_upper_R017_100[l,j,3]-counts_array_upper_R017_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R017_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R017_100[m,j,4]<- cumulative_array_upper_R017_100[m-1,j,4]+counts_array_upper_R017_100[m,j,4]
    }
    else{
      cumulative_array_upper_R017_100[m,j,4]<-cumulative_array_upper_R017_100[m-1,j,4]+
          counts_array_upper_R017_100[m,j,4]-counts_array_upper_R017_100[m-length_of_stay[4],j,4]
      }
    }
   
  }

##############################################

cumulative_array_median_R017_75<- array(NA, dim=c(nrow(data_combined_cats_median_R017_75),ncol(data_combined_cats_median_R017_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R017_75)){
    cumulative_array_median_R017_75[1,j,]<- counts_array_median_R017_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R017_75)){
      cumulative_array_median_R017_75[i,j,1]<-cumulative_array_median_R017_75[i-1,j,1]+counts_array_median_R017_75[i,j,1]
      cumulative_array_median_R017_75[i,j,5]<-cumulative_array_median_R017_75[i-1,j,5]+counts_array_median_R017_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R017_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R017_75[k,j,2]<- cumulative_array_median_R017_75[k-1,j,2]+counts_array_median_R017_75[k,j,2]
      }
      else {
        cumulative_array_median_R017_75[k,j,2]<-cumulative_array_median_R017_75[k-1,j,2]+
          counts_array_median_R017_75[k,j,2]-counts_array_median_R017_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R017_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R017_75[l,j,3]<- cumulative_array_median_R017_75[l-1,j,3]+counts_array_median_R017_75[l,j,3]
      }
    else{
      cumulative_array_median_R017_75[l,j,3]<-cumulative_array_median_R017_75[l-1,j,3]+
          counts_array_median_R017_75[l,j,3]-counts_array_median_R017_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R017_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R017_75[m,j,4]<- cumulative_array_median_R017_75[m-1,j,4]+counts_array_median_R017_75[m,j,4]
    }
    else{
      cumulative_array_median_R017_75[m,j,4]<-cumulative_array_median_R017_75[m-1,j,4]+
          counts_array_median_R017_75[m,j,4]-counts_array_median_R017_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R017_75<- array(NA, dim=c(nrow(data_combined_cats_mean_R017_75),ncol(data_combined_cats_mean_R017_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R017_75)){
    cumulative_array_mean_R017_75[1,j,]<- counts_array_mean_R017_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R017_75)){
      cumulative_array_mean_R017_75[i,j,1]<-cumulative_array_mean_R017_75[i-1,j,1]+counts_array_mean_R017_75[i,j,1]
      cumulative_array_mean_R017_75[i,j,5]<-cumulative_array_mean_R017_75[i-1,j,5]+counts_array_mean_R017_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R017_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R017_75[k,j,2]<- cumulative_array_mean_R017_75[k-1,j,2]+counts_array_mean_R017_75[k,j,2]
      }
      else {
        cumulative_array_mean_R017_75[k,j,2]<-cumulative_array_mean_R017_75[k-1,j,2]+
          counts_array_mean_R017_75[k,j,2]-counts_array_mean_R017_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R017_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R017_75[l,j,3]<- cumulative_array_mean_R017_75[l-1,j,3]+counts_array_mean_R017_75[l,j,3]
      }
    else{
      cumulative_array_mean_R017_75[l,j,3]<-cumulative_array_mean_R017_75[l-1,j,3]+
          counts_array_mean_R017_75[l,j,3]-counts_array_mean_R017_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R017_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R017_75[m,j,4]<- cumulative_array_mean_R017_75[m-1,j,4]+counts_array_mean_R017_75[m,j,4]
    }
    else{
      cumulative_array_mean_R017_75[m,j,4]<-cumulative_array_mean_R017_75[m-1,j,4]+
          counts_array_mean_R017_75[m,j,4]-counts_array_mean_R017_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R017_75<- array(NA, dim=c(nrow(data_combined_cats_lower_R017_75),ncol(data_combined_cats_lower_R017_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R017_75)){
    cumulative_array_lower_R017_75[1,j,]<- counts_array_lower_R017_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R017_75)){
      cumulative_array_lower_R017_75[i,j,1]<-cumulative_array_lower_R017_75[i-1,j,1]+counts_array_lower_R017_75[i,j,1]
      cumulative_array_lower_R017_75[i,j,5]<-cumulative_array_lower_R017_75[i-1,j,5]+counts_array_lower_R017_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R017_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R017_75[k,j,2]<- cumulative_array_lower_R017_75[k-1,j,2]+counts_array_lower_R017_75[k,j,2]
      }
      else {
        cumulative_array_lower_R017_75[k,j,2]<-cumulative_array_lower_R017_75[k-1,j,2]+
          counts_array_lower_R017_75[k,j,2]-counts_array_lower_R017_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R017_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R017_75[l,j,3]<- cumulative_array_lower_R017_75[l-1,j,3]+counts_array_lower_R017_75[l,j,3]
      }
    else{
      cumulative_array_lower_R017_75[l,j,3]<-cumulative_array_lower_R017_75[l-1,j,3]+
          counts_array_lower_R017_75[l,j,3]-counts_array_lower_R017_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R017_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R017_75[m,j,4]<- cumulative_array_lower_R017_75[m-1,j,4]+counts_array_lower_R017_75[m,j,4]
    }
    else{
      cumulative_array_lower_R017_75[m,j,4]<-cumulative_array_lower_R017_75[m-1,j,4]+
          counts_array_lower_R017_75[m,j,4]-counts_array_lower_R017_75[m-length_of_stay[4],j,4]
      }
    }
   
}



cumulative_array_IQR_lower_R017_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_lower_R017_75),ncol(data_combined_cats_IQR_lower_R017_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_IQR_lower_R017_75)){
    cumulative_array_IQR_lower_R017_75[1,j,]<- counts_array_IQR_lower_R017_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_IQR_lower_R017_75)){
      cumulative_array_IQR_lower_R017_75[i,j,1]<-cumulative_array_IQR_lower_R017_75[i-1,j,1]+counts_array_IQR_lower_R017_75[i,j,1]
      cumulative_array_IQR_lower_R017_75[i,j,5]<-cumulative_array_IQR_lower_R017_75[i-1,j,5]+counts_array_IQR_lower_R017_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_IQR_lower_R017_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_IQR_lower_R017_75[k,j,2]<- cumulative_array_IQR_lower_R017_75[k-1,j,2]+counts_array_IQR_lower_R017_75[k,j,2]
      }
      else {
        cumulative_array_IQR_lower_R017_75[k,j,2]<-cumulative_array_IQR_lower_R017_75[k-1,j,2]+
          counts_array_IQR_lower_R017_75[k,j,2]-counts_array_IQR_lower_R017_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_IQR_lower_R017_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_IQR_lower_R017_75[l,j,3]<- cumulative_array_IQR_lower_R017_75[l-1,j,3]+counts_array_IQR_lower_R017_75[l,j,3]
      }
    else{
      cumulative_array_IQR_lower_R017_75[l,j,3]<-cumulative_array_IQR_lower_R017_75[l-1,j,3]+
          counts_array_IQR_lower_R017_75[l,j,3]-counts_array_IQR_lower_R017_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_IQR_lower_R017_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_IQR_lower_R017_75[m,j,4]<- cumulative_array_IQR_lower_R017_75[m-1,j,4]+counts_array_IQR_lower_R017_75[m,j,4]
    }
    else{
      cumulative_array_IQR_lower_R017_75[m,j,4]<-cumulative_array_IQR_lower_R017_75[m-1,j,4]+
          counts_array_IQR_lower_R017_75[m,j,4]-counts_array_IQR_lower_R017_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_upper_R017_75<- array(NA, dim=c(nrow(data_combined_cats_upper_R017_75),ncol(data_combined_cats_upper_R017_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R017_75)){
    cumulative_array_upper_R017_75[1,j,]<- counts_array_upper_R017_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R017_75)){
      cumulative_array_upper_R017_75[i,j,1]<-cumulative_array_upper_R017_75[i-1,j,1]+counts_array_upper_R017_75[i,j,1]
      cumulative_array_upper_R017_75[i,j,5]<-cumulative_array_upper_R017_75[i-1,j,5]+counts_array_upper_R017_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R017_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R017_75[k,j,2]<- cumulative_array_upper_R017_75[k-1,j,2]+counts_array_upper_R017_75[k,j,2]
      }
      else {
        cumulative_array_upper_R017_75[k,j,2]<-cumulative_array_upper_R017_75[k-1,j,2]+
          counts_array_upper_R017_75[k,j,2]-counts_array_upper_R017_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R017_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R017_75[l,j,3]<- cumulative_array_upper_R017_75[l-1,j,3]+counts_array_upper_R017_75[l,j,3]
      }
    else{
      cumulative_array_upper_R017_75[l,j,3]<-cumulative_array_upper_R017_75[l-1,j,3]+
          counts_array_upper_R017_75[l,j,3]-counts_array_upper_R017_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R017_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R017_75[m,j,4]<- cumulative_array_upper_R017_75[m-1,j,4]+counts_array_upper_R017_75[m,j,4]
    }
    else{
      cumulative_array_upper_R017_75[m,j,4]<-cumulative_array_upper_R017_75[m-1,j,4]+
          counts_array_upper_R017_75[m,j,4]-counts_array_upper_R017_75[m-length_of_stay[4],j,4]
      }
    }
   
  }


cumulative_array_IQR_upper_R017_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_upper_R017_75),ncol(data_combined_cats_IQR_upper_R017_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_IQR_upper_R017_75)){
    cumulative_array_IQR_upper_R017_75[1,j,]<- counts_array_IQR_upper_R017_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_IQR_upper_R017_75)){
      cumulative_array_IQR_upper_R017_75[i,j,1]<-cumulative_array_IQR_upper_R017_75[i-1,j,1]+counts_array_IQR_upper_R017_75[i,j,1]
      cumulative_array_IQR_upper_R017_75[i,j,5]<-cumulative_array_IQR_upper_R017_75[i-1,j,5]+counts_array_IQR_upper_R017_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_IQR_upper_R017_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_IQR_upper_R017_75[k,j,2]<- cumulative_array_IQR_upper_R017_75[k-1,j,2]+counts_array_IQR_upper_R017_75[k,j,2]
      }
      else {
        cumulative_array_IQR_upper_R017_75[k,j,2]<-cumulative_array_IQR_upper_R017_75[k-1,j,2]+
          counts_array_IQR_upper_R017_75[k,j,2]-counts_array_IQR_upper_R017_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_IQR_upper_R017_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_IQR_upper_R017_75[l,j,3]<- cumulative_array_IQR_upper_R017_75[l-1,j,3]+counts_array_IQR_upper_R017_75[l,j,3]
      }
    else{
      cumulative_array_IQR_upper_R017_75[l,j,3]<-cumulative_array_IQR_upper_R017_75[l-1,j,3]+
          counts_array_IQR_upper_R017_75[l,j,3]-counts_array_IQR_upper_R017_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_IQR_upper_R017_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_IQR_upper_R017_75[m,j,4]<- cumulative_array_IQR_upper_R017_75[m-1,j,4]+counts_array_IQR_upper_R017_75[m,j,4]
    }
    else{
      cumulative_array_IQR_upper_R017_75[m,j,4]<-cumulative_array_IQR_upper_R017_75[m-1,j,4]+
          counts_array_IQR_upper_R017_75[m,j,4]-counts_array_IQR_upper_R017_75[m-length_of_stay[4],j,4]
      }
    }
   
  }
#################################
cumulative_array_median_R017_50<- array(NA, dim=c(nrow(data_combined_cats_median_R017_50),ncol(data_combined_cats_median_R017_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R017_50)){
    cumulative_array_median_R017_50[1,j,]<- counts_array_median_R017_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R017_50)){
      cumulative_array_median_R017_50[i,j,1]<-cumulative_array_median_R017_50[i-1,j,1]+counts_array_median_R017_50[i,j,1]
      cumulative_array_median_R017_50[i,j,5]<-cumulative_array_median_R017_50[i-1,j,5]+counts_array_median_R017_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R017_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R017_50[k,j,2]<- cumulative_array_median_R017_50[k-1,j,2]+counts_array_median_R017_50[k,j,2]
      }
      else {
        cumulative_array_median_R017_50[k,j,2]<-cumulative_array_median_R017_50[k-1,j,2]+
          counts_array_median_R017_50[k,j,2]-counts_array_median_R017_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R017_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R017_50[l,j,3]<- cumulative_array_median_R017_50[l-1,j,3]+counts_array_median_R017_50[l,j,3]
      }
    else{
      cumulative_array_median_R017_50[l,j,3]<-cumulative_array_median_R017_50[l-1,j,3]+
          counts_array_median_R017_50[l,j,3]-counts_array_median_R017_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R017_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R017_50[m,j,4]<- cumulative_array_median_R017_50[m-1,j,4]+counts_array_median_R017_50[m,j,4]
    }
    else{
      cumulative_array_median_R017_50[m,j,4]<-cumulative_array_median_R017_50[m-1,j,4]+
          counts_array_median_R017_50[m,j,4]-counts_array_median_R017_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R017_50<- array(NA, dim=c(nrow(data_combined_cats_mean_R017_50),ncol(data_combined_cats_mean_R017_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R017_50)){
    cumulative_array_mean_R017_50[1,j,]<- counts_array_mean_R017_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R017_50)){
      cumulative_array_mean_R017_50[i,j,1]<-cumulative_array_mean_R017_50[i-1,j,1]+counts_array_mean_R017_50[i,j,1]
      cumulative_array_mean_R017_50[i,j,5]<-cumulative_array_mean_R017_50[i-1,j,5]+counts_array_mean_R017_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R017_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R017_50[k,j,2]<- cumulative_array_mean_R017_50[k-1,j,2]+counts_array_mean_R017_50[k,j,2]
      }
      else {
        cumulative_array_mean_R017_50[k,j,2]<-cumulative_array_mean_R017_50[k-1,j,2]+
          counts_array_mean_R017_50[k,j,2]-counts_array_mean_R017_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R017_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R017_50[l,j,3]<- cumulative_array_mean_R017_50[l-1,j,3]+counts_array_mean_R017_50[l,j,3]
      }
    else{
      cumulative_array_mean_R017_50[l,j,3]<-cumulative_array_mean_R017_50[l-1,j,3]+
          counts_array_mean_R017_50[l,j,3]-counts_array_mean_R017_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R017_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R017_50[m,j,4]<- cumulative_array_mean_R017_50[m-1,j,4]+counts_array_mean_R017_50[m,j,4]
    }
    else{
      cumulative_array_mean_R017_50[m,j,4]<-cumulative_array_mean_R017_50[m-1,j,4]+
          counts_array_mean_R017_50[m,j,4]-counts_array_mean_R017_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R017_50<- array(NA, dim=c(nrow(data_combined_cats_lower_R017_50),ncol(data_combined_cats_lower_R017_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R017_50)){
    cumulative_array_lower_R017_50[1,j,]<- counts_array_lower_R017_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R017_50)){
      cumulative_array_lower_R017_50[i,j,1]<-cumulative_array_lower_R017_50[i-1,j,1]+counts_array_lower_R017_50[i,j,1]
      cumulative_array_lower_R017_50[i,j,5]<-cumulative_array_lower_R017_50[i-1,j,5]+counts_array_lower_R017_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R017_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R017_50[k,j,2]<- cumulative_array_lower_R017_50[k-1,j,2]+counts_array_lower_R017_50[k,j,2]
      }
      else {
        cumulative_array_lower_R017_50[k,j,2]<-cumulative_array_lower_R017_50[k-1,j,2]+
          counts_array_lower_R017_50[k,j,2]-counts_array_lower_R017_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R017_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R017_50[l,j,3]<- cumulative_array_lower_R017_50[l-1,j,3]+counts_array_lower_R017_50[l,j,3]
      }
    else{
      cumulative_array_lower_R017_50[l,j,3]<-cumulative_array_lower_R017_50[l-1,j,3]+
          counts_array_lower_R017_50[l,j,3]-counts_array_lower_R017_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R017_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R017_50[m,j,4]<- cumulative_array_lower_R017_50[m-1,j,4]+counts_array_lower_R017_50[m,j,4]
    }
    else{
      cumulative_array_lower_R017_50[m,j,4]<-cumulative_array_lower_R017_50[m-1,j,4]+
          counts_array_lower_R017_50[m,j,4]-counts_array_lower_R017_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_upper_R017_50<- array(NA, dim=c(nrow(data_combined_cats_upper_R017_50),ncol(data_combined_cats_upper_R017_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R017_50)){
    cumulative_array_upper_R017_50[1,j,]<- counts_array_upper_R017_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R017_50)){
      cumulative_array_upper_R017_50[i,j,1]<-cumulative_array_upper_R017_50[i-1,j,1]+counts_array_upper_R017_50[i,j,1]
      cumulative_array_upper_R017_50[i,j,5]<-cumulative_array_upper_R017_50[i-1,j,5]+counts_array_upper_R017_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R017_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R017_50[k,j,2]<- cumulative_array_upper_R017_50[k-1,j,2]+counts_array_upper_R017_50[k,j,2]
      }
      else {
        cumulative_array_upper_R017_50[k,j,2]<-cumulative_array_upper_R017_50[k-1,j,2]+
          counts_array_upper_R017_50[k,j,2]-counts_array_upper_R017_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R017_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R017_50[l,j,3]<- cumulative_array_upper_R017_50[l-1,j,3]+counts_array_upper_R017_50[l,j,3]
      }
    else{
      cumulative_array_upper_R017_50[l,j,3]<-cumulative_array_upper_R017_50[l-1,j,3]+
          counts_array_upper_R017_50[l,j,3]-counts_array_upper_R017_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R017_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R017_50[m,j,4]<- cumulative_array_upper_R017_50[m-1,j,4]+counts_array_upper_R017_50[m,j,4]
    }
    else{
      cumulative_array_upper_R017_50[m,j,4]<-cumulative_array_upper_R017_50[m-1,j,4]+
          counts_array_upper_R017_50[m,j,4]-counts_array_upper_R017_50[m-length_of_stay[4],j,4]
      }
    }
   
  }
####################################
cumulative_array_median_R021_100<- array(NA, dim=c(nrow(data_combined_cats_median_R021_100),ncol(data_combined_cats_median_R021_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R021_100)){
    cumulative_array_median_R021_100[1,j,]<- counts_array_median_R021_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R021_100)){
      cumulative_array_median_R021_100[i,j,1]<-cumulative_array_median_R021_100[i-1,j,1]+counts_array_median_R021_100[i,j,1]
      cumulative_array_median_R021_100[i,j,5]<-cumulative_array_median_R021_100[i-1,j,5]+counts_array_median_R021_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R021_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R021_100[k,j,2]<- cumulative_array_median_R021_100[k-1,j,2]+counts_array_median_R021_100[k,j,2]
      }
      else {
        cumulative_array_median_R021_100[k,j,2]<-cumulative_array_median_R021_100[k-1,j,2]+
          counts_array_median_R021_100[k,j,2]-counts_array_median_R021_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R021_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R021_100[l,j,3]<- cumulative_array_median_R021_100[l-1,j,3]+counts_array_median_R021_100[l,j,3]
      }
    else{
      cumulative_array_median_R021_100[l,j,3]<-cumulative_array_median_R021_100[l-1,j,3]+
          counts_array_median_R021_100[l,j,3]-counts_array_median_R021_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R021_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R021_100[m,j,4]<- cumulative_array_median_R021_100[m-1,j,4]+counts_array_median_R021_100[m,j,4]
    }
    else{
      cumulative_array_median_R021_100[m,j,4]<-cumulative_array_median_R021_100[m-1,j,4]+
          counts_array_median_R021_100[m,j,4]-counts_array_median_R021_100[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R021_100<- array(NA, dim=c(nrow(data_combined_cats_mean_R021_100),ncol(data_combined_cats_mean_R021_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R021_100)){
    cumulative_array_mean_R021_100[1,j,]<- counts_array_mean_R021_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R021_100)){
      cumulative_array_mean_R021_100[i,j,1]<-cumulative_array_mean_R021_100[i-1,j,1]+counts_array_mean_R021_100[i,j,1]
      cumulative_array_mean_R021_100[i,j,5]<-cumulative_array_mean_R021_100[i-1,j,5]+counts_array_mean_R021_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R021_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R021_100[k,j,2]<- cumulative_array_mean_R021_100[k-1,j,2]+counts_array_mean_R021_100[k,j,2]
      }
      else {
        cumulative_array_mean_R021_100[k,j,2]<-cumulative_array_mean_R021_100[k-1,j,2]+
          counts_array_mean_R021_100[k,j,2]-counts_array_mean_R021_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R021_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R021_100[l,j,3]<- cumulative_array_mean_R021_100[l-1,j,3]+counts_array_mean_R021_100[l,j,3]
      }
    else{
      cumulative_array_mean_R021_100[l,j,3]<-cumulative_array_mean_R021_100[l-1,j,3]+
          counts_array_mean_R021_100[l,j,3]-counts_array_mean_R021_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R021_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R021_100[m,j,4]<- cumulative_array_mean_R021_100[m-1,j,4]+counts_array_mean_R021_100[m,j,4]
    }
    else{
      cumulative_array_mean_R021_100[m,j,4]<-cumulative_array_mean_R021_100[m-1,j,4]+
          counts_array_mean_R021_100[m,j,4]-counts_array_mean_R021_100[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R021_100<- array(NA, dim=c(nrow(data_combined_cats_lower_R021_100),ncol(data_combined_cats_lower_R021_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R021_100)){
    cumulative_array_lower_R021_100[1,j,]<- counts_array_lower_R021_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R021_100)){
      cumulative_array_lower_R021_100[i,j,1]<-cumulative_array_lower_R021_100[i-1,j,1]+counts_array_lower_R021_100[i,j,1]
      cumulative_array_lower_R021_100[i,j,5]<-cumulative_array_lower_R021_100[i-1,j,5]+counts_array_lower_R021_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R021_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R021_100[k,j,2]<- cumulative_array_lower_R021_100[k-1,j,2]+counts_array_lower_R021_100[k,j,2]
      }
      else {
        cumulative_array_lower_R021_100[k,j,2]<-cumulative_array_lower_R021_100[k-1,j,2]+
          counts_array_lower_R021_100[k,j,2]-counts_array_lower_R021_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R021_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R021_100[l,j,3]<- cumulative_array_lower_R021_100[l-1,j,3]+counts_array_lower_R021_100[l,j,3]
      }
    else{
      cumulative_array_lower_R021_100[l,j,3]<-cumulative_array_lower_R021_100[l-1,j,3]+
          counts_array_lower_R021_100[l,j,3]-counts_array_lower_R021_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R021_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R021_100[m,j,4]<- cumulative_array_lower_R021_100[m-1,j,4]+counts_array_lower_R021_100[m,j,4]
    }
    else{
      cumulative_array_lower_R021_100[m,j,4]<-cumulative_array_lower_R021_100[m-1,j,4]+
          counts_array_lower_R021_100[m,j,4]-counts_array_lower_R021_100[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_upper_R021_100<- array(NA, dim=c(nrow(data_combined_cats_upper_R021_100),ncol(data_combined_cats_upper_R021_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R021_100)){
    cumulative_array_upper_R021_100[1,j,]<- counts_array_upper_R021_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R021_100)){
      cumulative_array_upper_R021_100[i,j,1]<-cumulative_array_upper_R021_100[i-1,j,1]+counts_array_upper_R021_100[i,j,1]
      cumulative_array_upper_R021_100[i,j,5]<-cumulative_array_upper_R021_100[i-1,j,5]+counts_array_upper_R021_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R021_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R021_100[k,j,2]<- cumulative_array_upper_R021_100[k-1,j,2]+counts_array_upper_R021_100[k,j,2]
      }
      else {
        cumulative_array_upper_R021_100[k,j,2]<-cumulative_array_upper_R021_100[k-1,j,2]+
          counts_array_upper_R021_100[k,j,2]-counts_array_upper_R021_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R021_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R021_100[l,j,3]<- cumulative_array_upper_R021_100[l-1,j,3]+counts_array_upper_R021_100[l,j,3]
      }
    else{
      cumulative_array_upper_R021_100[l,j,3]<-cumulative_array_upper_R021_100[l-1,j,3]+
          counts_array_upper_R021_100[l,j,3]-counts_array_upper_R021_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R021_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R021_100[m,j,4]<- cumulative_array_upper_R021_100[m-1,j,4]+counts_array_upper_R021_100[m,j,4]
    }
    else{
      cumulative_array_upper_R021_100[m,j,4]<-cumulative_array_upper_R021_100[m-1,j,4]+
          counts_array_upper_R021_100[m,j,4]-counts_array_upper_R021_100[m-length_of_stay[4],j,4]
      }
    }
   
  }
###########################################
cumulative_array_median_R021_75<- array(NA, dim=c(nrow(data_combined_cats_median_R021_75),ncol(data_combined_cats_median_R021_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R021_75)){
    cumulative_array_median_R021_75[1,j,]<- counts_array_median_R021_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R021_75)){
      cumulative_array_median_R021_75[i,j,1]<-cumulative_array_median_R021_75[i-1,j,1]+counts_array_median_R021_75[i,j,1]
      cumulative_array_median_R021_75[i,j,5]<-cumulative_array_median_R021_75[i-1,j,5]+counts_array_median_R021_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R021_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R021_75[k,j,2]<- cumulative_array_median_R021_75[k-1,j,2]+counts_array_median_R021_75[k,j,2]
      }
      else {
        cumulative_array_median_R021_75[k,j,2]<-cumulative_array_median_R021_75[k-1,j,2]+
          counts_array_median_R021_75[k,j,2]-counts_array_median_R021_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R021_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R021_75[l,j,3]<- cumulative_array_median_R021_75[l-1,j,3]+counts_array_median_R021_75[l,j,3]
      }
    else{
      cumulative_array_median_R021_75[l,j,3]<-cumulative_array_median_R021_75[l-1,j,3]+
          counts_array_median_R021_75[l,j,3]-counts_array_median_R021_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R021_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R021_75[m,j,4]<- cumulative_array_median_R021_75[m-1,j,4]+counts_array_median_R021_75[m,j,4]
    }
    else{
      cumulative_array_median_R021_75[m,j,4]<-cumulative_array_median_R021_75[m-1,j,4]+
          counts_array_median_R021_75[m,j,4]-counts_array_median_R021_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R021_75<- array(NA, dim=c(nrow(data_combined_cats_mean_R021_75),ncol(data_combined_cats_mean_R021_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R021_75)){
    cumulative_array_mean_R021_75[1,j,]<- counts_array_mean_R021_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R021_75)){
      cumulative_array_mean_R021_75[i,j,1]<-cumulative_array_mean_R021_75[i-1,j,1]+counts_array_mean_R021_75[i,j,1]
      cumulative_array_mean_R021_75[i,j,5]<-cumulative_array_mean_R021_75[i-1,j,5]+counts_array_mean_R021_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R021_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R021_75[k,j,2]<- cumulative_array_mean_R021_75[k-1,j,2]+counts_array_mean_R021_75[k,j,2]
      }
      else {
        cumulative_array_mean_R021_75[k,j,2]<-cumulative_array_mean_R021_75[k-1,j,2]+
          counts_array_mean_R021_75[k,j,2]-counts_array_mean_R021_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R021_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R021_75[l,j,3]<- cumulative_array_mean_R021_75[l-1,j,3]+counts_array_mean_R021_75[l,j,3]
      }
    else{
      cumulative_array_mean_R021_75[l,j,3]<-cumulative_array_mean_R021_75[l-1,j,3]+
          counts_array_mean_R021_75[l,j,3]-counts_array_mean_R021_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R021_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R021_75[m,j,4]<- cumulative_array_mean_R021_75[m-1,j,4]+counts_array_mean_R021_75[m,j,4]
    }
    else{
      cumulative_array_mean_R021_75[m,j,4]<-cumulative_array_mean_R021_75[m-1,j,4]+
          counts_array_mean_R021_75[m,j,4]-counts_array_mean_R021_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R021_75<- array(NA, dim=c(nrow(data_combined_cats_lower_R021_75),ncol(data_combined_cats_lower_R021_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R021_75)){
    cumulative_array_lower_R021_75[1,j,]<- counts_array_lower_R021_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R021_75)){
      cumulative_array_lower_R021_75[i,j,1]<-cumulative_array_lower_R021_75[i-1,j,1]+counts_array_lower_R021_75[i,j,1]
      cumulative_array_lower_R021_75[i,j,5]<-cumulative_array_lower_R021_75[i-1,j,5]+counts_array_lower_R021_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R021_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R021_75[k,j,2]<- cumulative_array_lower_R021_75[k-1,j,2]+counts_array_lower_R021_75[k,j,2]
      }
      else {
        cumulative_array_lower_R021_75[k,j,2]<-cumulative_array_lower_R021_75[k-1,j,2]+
          counts_array_lower_R021_75[k,j,2]-counts_array_lower_R021_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R021_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R021_75[l,j,3]<- cumulative_array_lower_R021_75[l-1,j,3]+counts_array_lower_R021_75[l,j,3]
      }
    else{
      cumulative_array_lower_R021_75[l,j,3]<-cumulative_array_lower_R021_75[l-1,j,3]+
          counts_array_lower_R021_75[l,j,3]-counts_array_lower_R021_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R021_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R021_75[m,j,4]<- cumulative_array_lower_R021_75[m-1,j,4]+counts_array_lower_R021_75[m,j,4]
    }
    else{
      cumulative_array_lower_R021_75[m,j,4]<-cumulative_array_lower_R021_75[m-1,j,4]+
          counts_array_lower_R021_75[m,j,4]-counts_array_lower_R021_75[m-length_of_stay[4],j,4]
      }
    }
   
}



cumulative_array_IQR_lower_R021_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_lower_R021_75),ncol(data_combined_cats_IQR_lower_R021_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_IQR_lower_R021_75)){
    cumulative_array_IQR_lower_R021_75[1,j,]<- counts_array_IQR_lower_R021_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_IQR_lower_R021_75)){
      cumulative_array_IQR_lower_R021_75[i,j,1]<-cumulative_array_IQR_lower_R021_75[i-1,j,1]+counts_array_IQR_lower_R021_75[i,j,1]
      cumulative_array_IQR_lower_R021_75[i,j,5]<-cumulative_array_IQR_lower_R021_75[i-1,j,5]+counts_array_IQR_lower_R021_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_IQR_lower_R021_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_IQR_lower_R021_75[k,j,2]<- cumulative_array_IQR_lower_R021_75[k-1,j,2]+counts_array_IQR_lower_R021_75[k,j,2]
      }
      else {
        cumulative_array_IQR_lower_R021_75[k,j,2]<-cumulative_array_IQR_lower_R021_75[k-1,j,2]+
          counts_array_IQR_lower_R021_75[k,j,2]-counts_array_IQR_lower_R021_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_IQR_lower_R021_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_IQR_lower_R021_75[l,j,3]<- cumulative_array_IQR_lower_R021_75[l-1,j,3]+counts_array_IQR_lower_R021_75[l,j,3]
      }
    else{
      cumulative_array_IQR_lower_R021_75[l,j,3]<-cumulative_array_IQR_lower_R021_75[l-1,j,3]+
          counts_array_IQR_lower_R021_75[l,j,3]-counts_array_IQR_lower_R021_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_IQR_lower_R021_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_IQR_lower_R021_75[m,j,4]<- cumulative_array_IQR_lower_R021_75[m-1,j,4]+counts_array_IQR_lower_R021_75[m,j,4]
    }
    else{
      cumulative_array_IQR_lower_R021_75[m,j,4]<-cumulative_array_IQR_lower_R021_75[m-1,j,4]+
          counts_array_IQR_lower_R021_75[m,j,4]-counts_array_IQR_lower_R021_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_upper_R021_75<- array(NA, dim=c(nrow(data_combined_cats_upper_R021_75),ncol(data_combined_cats_upper_R021_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R021_75)){
    cumulative_array_upper_R021_75[1,j,]<- counts_array_upper_R021_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R021_75)){
      cumulative_array_upper_R021_75[i,j,1]<-cumulative_array_upper_R021_75[i-1,j,1]+counts_array_upper_R021_75[i,j,1]
      cumulative_array_upper_R021_75[i,j,5]<-cumulative_array_upper_R021_75[i-1,j,5]+counts_array_upper_R021_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R021_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R021_75[k,j,2]<- cumulative_array_upper_R021_75[k-1,j,2]+counts_array_upper_R021_75[k,j,2]
      }
      else {
        cumulative_array_upper_R021_75[k,j,2]<-cumulative_array_upper_R021_75[k-1,j,2]+
          counts_array_upper_R021_75[k,j,2]-counts_array_upper_R021_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R021_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R021_75[l,j,3]<- cumulative_array_upper_R021_75[l-1,j,3]+counts_array_upper_R021_75[l,j,3]
      }
    else{
      cumulative_array_upper_R021_75[l,j,3]<-cumulative_array_upper_R021_75[l-1,j,3]+
          counts_array_upper_R021_75[l,j,3]-counts_array_upper_R021_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R021_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R021_75[m,j,4]<- cumulative_array_upper_R021_75[m-1,j,4]+counts_array_upper_R021_75[m,j,4]
    }
    else{
      cumulative_array_upper_R021_75[m,j,4]<-cumulative_array_upper_R021_75[m-1,j,4]+
          counts_array_upper_R021_75[m,j,4]-counts_array_upper_R021_75[m-length_of_stay[4],j,4]
      }
    }
   
  }


cumulative_array_IQR_upper_R021_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_upper_R021_75),ncol(data_combined_cats_IQR_upper_R021_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_IQR_upper_R021_75)){
    cumulative_array_IQR_upper_R021_75[1,j,]<- counts_array_IQR_upper_R021_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_IQR_upper_R021_75)){
      cumulative_array_IQR_upper_R021_75[i,j,1]<-cumulative_array_IQR_upper_R021_75[i-1,j,1]+counts_array_IQR_upper_R021_75[i,j,1]
      cumulative_array_IQR_upper_R021_75[i,j,5]<-cumulative_array_IQR_upper_R021_75[i-1,j,5]+counts_array_IQR_upper_R021_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_IQR_upper_R021_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_IQR_upper_R021_75[k,j,2]<- cumulative_array_IQR_upper_R021_75[k-1,j,2]+counts_array_IQR_upper_R021_75[k,j,2]
      }
      else {
        cumulative_array_IQR_upper_R021_75[k,j,2]<-cumulative_array_IQR_upper_R021_75[k-1,j,2]+
          counts_array_IQR_upper_R021_75[k,j,2]-counts_array_IQR_upper_R021_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_IQR_upper_R021_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_IQR_upper_R021_75[l,j,3]<- cumulative_array_IQR_upper_R021_75[l-1,j,3]+counts_array_IQR_upper_R021_75[l,j,3]
      }
    else{
      cumulative_array_IQR_upper_R021_75[l,j,3]<-cumulative_array_IQR_upper_R021_75[l-1,j,3]+
          counts_array_IQR_upper_R021_75[l,j,3]-counts_array_IQR_upper_R021_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_IQR_upper_R021_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_IQR_upper_R021_75[m,j,4]<- cumulative_array_IQR_upper_R021_75[m-1,j,4]+counts_array_IQR_upper_R021_75[m,j,4]
    }
    else{
      cumulative_array_IQR_upper_R021_75[m,j,4]<-cumulative_array_IQR_upper_R021_75[m-1,j,4]+
          counts_array_IQR_upper_R021_75[m,j,4]-counts_array_IQR_upper_R021_75[m-length_of_stay[4],j,4]
      }
    }
   
  }
####################################
cumulative_array_median_R021_50<- array(NA, dim=c(nrow(data_combined_cats_median_R021_50),ncol(data_combined_cats_median_R021_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R021_50)){
    cumulative_array_median_R021_50[1,j,]<- counts_array_median_R021_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R021_50)){
      cumulative_array_median_R021_50[i,j,1]<-cumulative_array_median_R021_50[i-1,j,1]+counts_array_median_R021_50[i,j,1]
      cumulative_array_median_R021_50[i,j,5]<-cumulative_array_median_R021_50[i-1,j,5]+counts_array_median_R021_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R021_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R021_50[k,j,2]<- cumulative_array_median_R021_50[k-1,j,2]+counts_array_median_R021_50[k,j,2]
      }
      else {
        cumulative_array_median_R021_50[k,j,2]<-cumulative_array_median_R021_50[k-1,j,2]+
          counts_array_median_R021_50[k,j,2]-counts_array_median_R021_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R021_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R021_50[l,j,3]<- cumulative_array_median_R021_50[l-1,j,3]+counts_array_median_R021_50[l,j,3]
      }
    else{
      cumulative_array_median_R021_50[l,j,3]<-cumulative_array_median_R021_50[l-1,j,3]+
          counts_array_median_R021_50[l,j,3]-counts_array_median_R021_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R021_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R021_50[m,j,4]<- cumulative_array_median_R021_50[m-1,j,4]+counts_array_median_R021_50[m,j,4]
    }
    else{
      cumulative_array_median_R021_50[m,j,4]<-cumulative_array_median_R021_50[m-1,j,4]+
          counts_array_median_R021_50[m,j,4]-counts_array_median_R021_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R021_50<- array(NA, dim=c(nrow(data_combined_cats_mean_R021_50),ncol(data_combined_cats_mean_R021_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R021_50)){
    cumulative_array_mean_R021_50[1,j,]<- counts_array_mean_R021_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R021_50)){
      cumulative_array_mean_R021_50[i,j,1]<-cumulative_array_mean_R021_50[i-1,j,1]+counts_array_mean_R021_50[i,j,1]
      cumulative_array_mean_R021_50[i,j,5]<-cumulative_array_mean_R021_50[i-1,j,5]+counts_array_mean_R021_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R021_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R021_50[k,j,2]<- cumulative_array_mean_R021_50[k-1,j,2]+counts_array_mean_R021_50[k,j,2]
      }
      else {
        cumulative_array_mean_R021_50[k,j,2]<-cumulative_array_mean_R021_50[k-1,j,2]+
          counts_array_mean_R021_50[k,j,2]-counts_array_mean_R021_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R021_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R021_50[l,j,3]<- cumulative_array_mean_R021_50[l-1,j,3]+counts_array_mean_R021_50[l,j,3]
      }
    else{
      cumulative_array_mean_R021_50[l,j,3]<-cumulative_array_mean_R021_50[l-1,j,3]+
          counts_array_mean_R021_50[l,j,3]-counts_array_mean_R021_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R021_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R021_50[m,j,4]<- cumulative_array_mean_R021_50[m-1,j,4]+counts_array_mean_R021_50[m,j,4]
    }
    else{
      cumulative_array_mean_R021_50[m,j,4]<-cumulative_array_mean_R021_50[m-1,j,4]+
          counts_array_mean_R021_50[m,j,4]-counts_array_mean_R021_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R021_50<- array(NA, dim=c(nrow(data_combined_cats_lower_R021_50),ncol(data_combined_cats_lower_R021_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R021_50)){
    cumulative_array_lower_R021_50[1,j,]<- counts_array_lower_R021_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R021_50)){
      cumulative_array_lower_R021_50[i,j,1]<-cumulative_array_lower_R021_50[i-1,j,1]+counts_array_lower_R021_50[i,j,1]
      cumulative_array_lower_R021_50[i,j,5]<-cumulative_array_lower_R021_50[i-1,j,5]+counts_array_lower_R021_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R021_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R021_50[k,j,2]<- cumulative_array_lower_R021_50[k-1,j,2]+counts_array_lower_R021_50[k,j,2]
      }
      else {
        cumulative_array_lower_R021_50[k,j,2]<-cumulative_array_lower_R021_50[k-1,j,2]+
          counts_array_lower_R021_50[k,j,2]-counts_array_lower_R021_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R021_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R021_50[l,j,3]<- cumulative_array_lower_R021_50[l-1,j,3]+counts_array_lower_R021_50[l,j,3]
      }
    else{
      cumulative_array_lower_R021_50[l,j,3]<-cumulative_array_lower_R021_50[l-1,j,3]+
          counts_array_lower_R021_50[l,j,3]-counts_array_lower_R021_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R021_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R021_50[m,j,4]<- cumulative_array_lower_R021_50[m-1,j,4]+counts_array_lower_R021_50[m,j,4]
    }
    else{
      cumulative_array_lower_R021_50[m,j,4]<-cumulative_array_lower_R021_50[m-1,j,4]+
          counts_array_lower_R021_50[m,j,4]-counts_array_lower_R021_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_upper_R021_50<- array(NA, dim=c(nrow(data_combined_cats_upper_R021_50),ncol(data_combined_cats_upper_R021_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R021_50)){
    cumulative_array_upper_R021_50[1,j,]<- counts_array_upper_R021_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R021_50)){
      cumulative_array_upper_R021_50[i,j,1]<-cumulative_array_upper_R021_50[i-1,j,1]+counts_array_upper_R021_50[i,j,1]
      cumulative_array_upper_R021_50[i,j,5]<-cumulative_array_upper_R021_50[i-1,j,5]+counts_array_upper_R021_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R021_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R021_50[k,j,2]<- cumulative_array_upper_R021_50[k-1,j,2]+counts_array_upper_R021_50[k,j,2]
      }
      else {
        cumulative_array_upper_R021_50[k,j,2]<-cumulative_array_upper_R021_50[k-1,j,2]+
          counts_array_upper_R021_50[k,j,2]-counts_array_upper_R021_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R021_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R021_50[l,j,3]<- cumulative_array_upper_R021_50[l-1,j,3]+counts_array_upper_R021_50[l,j,3]
      }
    else{
      cumulative_array_upper_R021_50[l,j,3]<-cumulative_array_upper_R021_50[l-1,j,3]+
          counts_array_upper_R021_50[l,j,3]-counts_array_upper_R021_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R021_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R021_50[m,j,4]<- cumulative_array_upper_R021_50[m-1,j,4]+counts_array_upper_R021_50[m,j,4]
    }
    else{
      cumulative_array_upper_R021_50[m,j,4]<-cumulative_array_upper_R021_50[m-1,j,4]+
          counts_array_upper_R021_50[m,j,4]-counts_array_upper_R021_50[m-length_of_stay[4],j,4]
      }
    }
   
  }
#######################################
cumulative_array_median_R025_100<- array(NA, dim=c(nrow(data_combined_cats_median_R025_100),ncol(data_combined_cats_median_R025_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R025_100)){
    cumulative_array_median_R025_100[1,j,]<- counts_array_median_R025_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R025_100)){
      cumulative_array_median_R025_100[i,j,1]<-cumulative_array_median_R025_100[i-1,j,1]+counts_array_median_R025_100[i,j,1]
      cumulative_array_median_R025_100[i,j,5]<-cumulative_array_median_R025_100[i-1,j,5]+counts_array_median_R025_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R025_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R025_100[k,j,2]<- cumulative_array_median_R025_100[k-1,j,2]+counts_array_median_R025_100[k,j,2]
      }
      else {
        cumulative_array_median_R025_100[k,j,2]<-cumulative_array_median_R025_100[k-1,j,2]+
          counts_array_median_R025_100[k,j,2]-counts_array_median_R025_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R025_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R025_100[l,j,3]<- cumulative_array_median_R025_100[l-1,j,3]+counts_array_median_R025_100[l,j,3]
      }
    else{
      cumulative_array_median_R025_100[l,j,3]<-cumulative_array_median_R025_100[l-1,j,3]+
          counts_array_median_R025_100[l,j,3]-counts_array_median_R025_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R025_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R025_100[m,j,4]<- cumulative_array_median_R025_100[m-1,j,4]+counts_array_median_R025_100[m,j,4]
    }
    else{
      cumulative_array_median_R025_100[m,j,4]<-cumulative_array_median_R025_100[m-1,j,4]+
          counts_array_median_R025_100[m,j,4]-counts_array_median_R025_100[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R025_100<- array(NA, dim=c(nrow(data_combined_cats_mean_R025_100),ncol(data_combined_cats_mean_R025_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R025_100)){
    cumulative_array_mean_R025_100[1,j,]<- counts_array_mean_R025_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R025_100)){
      cumulative_array_mean_R025_100[i,j,1]<-cumulative_array_mean_R025_100[i-1,j,1]+counts_array_mean_R025_100[i,j,1]
      cumulative_array_mean_R025_100[i,j,5]<-cumulative_array_mean_R025_100[i-1,j,5]+counts_array_mean_R025_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R025_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R025_100[k,j,2]<- cumulative_array_mean_R025_100[k-1,j,2]+counts_array_mean_R025_100[k,j,2]
      }
      else {
        cumulative_array_mean_R025_100[k,j,2]<-cumulative_array_mean_R025_100[k-1,j,2]+
          counts_array_mean_R025_100[k,j,2]-counts_array_mean_R025_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R025_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R025_100[l,j,3]<- cumulative_array_mean_R025_100[l-1,j,3]+counts_array_mean_R025_100[l,j,3]
      }
    else{
      cumulative_array_mean_R025_100[l,j,3]<-cumulative_array_mean_R025_100[l-1,j,3]+
          counts_array_mean_R025_100[l,j,3]-counts_array_mean_R025_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R025_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R025_100[m,j,4]<- cumulative_array_mean_R025_100[m-1,j,4]+counts_array_mean_R025_100[m,j,4]
    }
    else{
      cumulative_array_mean_R025_100[m,j,4]<-cumulative_array_mean_R025_100[m-1,j,4]+
          counts_array_mean_R025_100[m,j,4]-counts_array_mean_R025_100[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R025_100<- array(NA, dim=c(nrow(data_combined_cats_lower_R025_100),ncol(data_combined_cats_lower_R025_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R025_100)){
    cumulative_array_lower_R025_100[1,j,]<- counts_array_lower_R025_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R025_100)){
      cumulative_array_lower_R025_100[i,j,1]<-cumulative_array_lower_R025_100[i-1,j,1]+counts_array_lower_R025_100[i,j,1]
      cumulative_array_lower_R025_100[i,j,5]<-cumulative_array_lower_R025_100[i-1,j,5]+counts_array_lower_R025_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R025_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R025_100[k,j,2]<- cumulative_array_lower_R025_100[k-1,j,2]+counts_array_lower_R025_100[k,j,2]
      }
      else {
        cumulative_array_lower_R025_100[k,j,2]<-cumulative_array_lower_R025_100[k-1,j,2]+
          counts_array_lower_R025_100[k,j,2]-counts_array_lower_R025_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R025_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R025_100[l,j,3]<- cumulative_array_lower_R025_100[l-1,j,3]+counts_array_lower_R025_100[l,j,3]
      }
    else{
      cumulative_array_lower_R025_100[l,j,3]<-cumulative_array_lower_R025_100[l-1,j,3]+
          counts_array_lower_R025_100[l,j,3]-counts_array_lower_R025_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R025_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R025_100[m,j,4]<- cumulative_array_lower_R025_100[m-1,j,4]+counts_array_lower_R025_100[m,j,4]
    }
    else{
      cumulative_array_lower_R025_100[m,j,4]<-cumulative_array_lower_R025_100[m-1,j,4]+
          counts_array_lower_R025_100[m,j,4]-counts_array_lower_R025_100[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_upper_R025_100<- array(NA, dim=c(nrow(data_combined_cats_upper_R025_100),ncol(data_combined_cats_upper_R025_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R025_100)){
    cumulative_array_upper_R025_100[1,j,]<- counts_array_upper_R025_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R025_100)){
      cumulative_array_upper_R025_100[i,j,1]<-cumulative_array_upper_R025_100[i-1,j,1]+counts_array_upper_R025_100[i,j,1]
      cumulative_array_upper_R025_100[i,j,5]<-cumulative_array_upper_R025_100[i-1,j,5]+counts_array_upper_R025_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R025_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R025_100[k,j,2]<- cumulative_array_upper_R025_100[k-1,j,2]+counts_array_upper_R025_100[k,j,2]
      }
      else {
        cumulative_array_upper_R025_100[k,j,2]<-cumulative_array_upper_R025_100[k-1,j,2]+
          counts_array_upper_R025_100[k,j,2]-counts_array_upper_R025_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R025_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R025_100[l,j,3]<- cumulative_array_upper_R025_100[l-1,j,3]+counts_array_upper_R025_100[l,j,3]
      }
    else{
      cumulative_array_upper_R025_100[l,j,3]<-cumulative_array_upper_R025_100[l-1,j,3]+
          counts_array_upper_R025_100[l,j,3]-counts_array_upper_R025_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R025_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R025_100[m,j,4]<- cumulative_array_upper_R025_100[m-1,j,4]+counts_array_upper_R025_100[m,j,4]
    }
    else{
      cumulative_array_upper_R025_100[m,j,4]<-cumulative_array_upper_R025_100[m-1,j,4]+
          counts_array_upper_R025_100[m,j,4]-counts_array_upper_R025_100[m-length_of_stay[4],j,4]
      }
    }
   
  }
##########################################
cumulative_array_median_R025_75<- array(NA, dim=c(nrow(data_combined_cats_median_R025_75),ncol(data_combined_cats_median_R025_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R025_75)){
    cumulative_array_median_R025_75[1,j,]<- counts_array_median_R025_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R025_75)){
      cumulative_array_median_R025_75[i,j,1]<-cumulative_array_median_R025_75[i-1,j,1]+counts_array_median_R025_75[i,j,1]
      cumulative_array_median_R025_75[i,j,5]<-cumulative_array_median_R025_75[i-1,j,5]+counts_array_median_R025_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R025_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R025_75[k,j,2]<- cumulative_array_median_R025_75[k-1,j,2]+counts_array_median_R025_75[k,j,2]
      }
      else {
        cumulative_array_median_R025_75[k,j,2]<-cumulative_array_median_R025_75[k-1,j,2]+
          counts_array_median_R025_75[k,j,2]-counts_array_median_R025_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R025_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R025_75[l,j,3]<- cumulative_array_median_R025_75[l-1,j,3]+counts_array_median_R025_75[l,j,3]
      }
    else{
      cumulative_array_median_R025_75[l,j,3]<-cumulative_array_median_R025_75[l-1,j,3]+
          counts_array_median_R025_75[l,j,3]-counts_array_median_R025_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R025_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R025_75[m,j,4]<- cumulative_array_median_R025_75[m-1,j,4]+counts_array_median_R025_75[m,j,4]
    }
    else{
      cumulative_array_median_R025_75[m,j,4]<-cumulative_array_median_R025_75[m-1,j,4]+
          counts_array_median_R025_75[m,j,4]-counts_array_median_R025_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R025_75<- array(NA, dim=c(nrow(data_combined_cats_mean_R025_75),ncol(data_combined_cats_mean_R025_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R025_75)){
    cumulative_array_mean_R025_75[1,j,]<- counts_array_mean_R025_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R025_75)){
      cumulative_array_mean_R025_75[i,j,1]<-cumulative_array_mean_R025_75[i-1,j,1]+counts_array_mean_R025_75[i,j,1]
      cumulative_array_mean_R025_75[i,j,5]<-cumulative_array_mean_R025_75[i-1,j,5]+counts_array_mean_R025_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R025_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R025_75[k,j,2]<- cumulative_array_mean_R025_75[k-1,j,2]+counts_array_mean_R025_75[k,j,2]
      }
      else {
        cumulative_array_mean_R025_75[k,j,2]<-cumulative_array_mean_R025_75[k-1,j,2]+
          counts_array_mean_R025_75[k,j,2]-counts_array_mean_R025_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R025_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R025_75[l,j,3]<- cumulative_array_mean_R025_75[l-1,j,3]+counts_array_mean_R025_75[l,j,3]
      }
    else{
      cumulative_array_mean_R025_75[l,j,3]<-cumulative_array_mean_R025_75[l-1,j,3]+
          counts_array_mean_R025_75[l,j,3]-counts_array_mean_R025_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R025_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R025_75[m,j,4]<- cumulative_array_mean_R025_75[m-1,j,4]+counts_array_mean_R025_75[m,j,4]
    }
    else{
      cumulative_array_mean_R025_75[m,j,4]<-cumulative_array_mean_R025_75[m-1,j,4]+
          counts_array_mean_R025_75[m,j,4]-counts_array_mean_R025_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R025_75<- array(NA, dim=c(nrow(data_combined_cats_lower_R025_75),ncol(data_combined_cats_lower_R025_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R025_75)){
    cumulative_array_lower_R025_75[1,j,]<- counts_array_lower_R025_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R025_75)){
      cumulative_array_lower_R025_75[i,j,1]<-cumulative_array_lower_R025_75[i-1,j,1]+counts_array_lower_R025_75[i,j,1]
      cumulative_array_lower_R025_75[i,j,5]<-cumulative_array_lower_R025_75[i-1,j,5]+counts_array_lower_R025_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R025_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R025_75[k,j,2]<- cumulative_array_lower_R025_75[k-1,j,2]+counts_array_lower_R025_75[k,j,2]
      }
      else {
        cumulative_array_lower_R025_75[k,j,2]<-cumulative_array_lower_R025_75[k-1,j,2]+
          counts_array_lower_R025_75[k,j,2]-counts_array_lower_R025_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R025_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R025_75[l,j,3]<- cumulative_array_lower_R025_75[l-1,j,3]+counts_array_lower_R025_75[l,j,3]
      }
    else{
      cumulative_array_lower_R025_75[l,j,3]<-cumulative_array_lower_R025_75[l-1,j,3]+
          counts_array_lower_R025_75[l,j,3]-counts_array_lower_R025_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R025_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R025_75[m,j,4]<- cumulative_array_lower_R025_75[m-1,j,4]+counts_array_lower_R025_75[m,j,4]
    }
    else{
      cumulative_array_lower_R025_75[m,j,4]<-cumulative_array_lower_R025_75[m-1,j,4]+
          counts_array_lower_R025_75[m,j,4]-counts_array_lower_R025_75[m-length_of_stay[4],j,4]
      }
    }
   
}



cumulative_array_IQR_lower_R025_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_lower_R025_75),ncol(data_combined_cats_IQR_lower_R025_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_IQR_lower_R025_75)){
    cumulative_array_IQR_lower_R025_75[1,j,]<- counts_array_IQR_lower_R025_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_IQR_lower_R025_75)){
      cumulative_array_IQR_lower_R025_75[i,j,1]<-cumulative_array_IQR_lower_R025_75[i-1,j,1]+counts_array_IQR_lower_R025_75[i,j,1]
      cumulative_array_IQR_lower_R025_75[i,j,5]<-cumulative_array_IQR_lower_R025_75[i-1,j,5]+counts_array_IQR_lower_R025_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_IQR_lower_R025_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_IQR_lower_R025_75[k,j,2]<- cumulative_array_IQR_lower_R025_75[k-1,j,2]+counts_array_IQR_lower_R025_75[k,j,2]
      }
      else {
        cumulative_array_IQR_lower_R025_75[k,j,2]<-cumulative_array_IQR_lower_R025_75[k-1,j,2]+
          counts_array_IQR_lower_R025_75[k,j,2]-counts_array_IQR_lower_R025_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_IQR_lower_R025_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_IQR_lower_R025_75[l,j,3]<- cumulative_array_IQR_lower_R025_75[l-1,j,3]+counts_array_IQR_lower_R025_75[l,j,3]
      }
    else{
      cumulative_array_IQR_lower_R025_75[l,j,3]<-cumulative_array_IQR_lower_R025_75[l-1,j,3]+
          counts_array_IQR_lower_R025_75[l,j,3]-counts_array_IQR_lower_R025_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_IQR_lower_R025_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_IQR_lower_R025_75[m,j,4]<- cumulative_array_IQR_lower_R025_75[m-1,j,4]+counts_array_IQR_lower_R025_75[m,j,4]
    }
    else{
      cumulative_array_IQR_lower_R025_75[m,j,4]<-cumulative_array_IQR_lower_R025_75[m-1,j,4]+
          counts_array_IQR_lower_R025_75[m,j,4]-counts_array_IQR_lower_R025_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_upper_R025_75<- array(NA, dim=c(nrow(data_combined_cats_upper_R025_75),ncol(data_combined_cats_upper_R025_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R025_75)){
    cumulative_array_upper_R025_75[1,j,]<- counts_array_upper_R025_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R025_75)){
      cumulative_array_upper_R025_75[i,j,1]<-cumulative_array_upper_R025_75[i-1,j,1]+counts_array_upper_R025_75[i,j,1]
      cumulative_array_upper_R025_75[i,j,5]<-cumulative_array_upper_R025_75[i-1,j,5]+counts_array_upper_R025_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R025_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R025_75[k,j,2]<- cumulative_array_upper_R025_75[k-1,j,2]+counts_array_upper_R025_75[k,j,2]
      }
      else {
        cumulative_array_upper_R025_75[k,j,2]<-cumulative_array_upper_R025_75[k-1,j,2]+
          counts_array_upper_R025_75[k,j,2]-counts_array_upper_R025_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R025_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R025_75[l,j,3]<- cumulative_array_upper_R025_75[l-1,j,3]+counts_array_upper_R025_75[l,j,3]
      }
    else{
      cumulative_array_upper_R025_75[l,j,3]<-cumulative_array_upper_R025_75[l-1,j,3]+
          counts_array_upper_R025_75[l,j,3]-counts_array_upper_R025_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R025_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R025_75[m,j,4]<- cumulative_array_upper_R025_75[m-1,j,4]+counts_array_upper_R025_75[m,j,4]
    }
    else{
      cumulative_array_upper_R025_75[m,j,4]<-cumulative_array_upper_R025_75[m-1,j,4]+
          counts_array_upper_R025_75[m,j,4]-counts_array_upper_R025_75[m-length_of_stay[4],j,4]
      }
    }
   
  }


cumulative_array_IQR_upper_R025_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_upper_R025_75),ncol(data_combined_cats_IQR_upper_R025_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_IQR_upper_R025_75)){
    cumulative_array_IQR_upper_R025_75[1,j,]<- counts_array_IQR_upper_R025_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_IQR_upper_R025_75)){
      cumulative_array_IQR_upper_R025_75[i,j,1]<-cumulative_array_IQR_upper_R025_75[i-1,j,1]+counts_array_IQR_upper_R025_75[i,j,1]
      cumulative_array_IQR_upper_R025_75[i,j,5]<-cumulative_array_IQR_upper_R025_75[i-1,j,5]+counts_array_IQR_upper_R025_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_IQR_upper_R025_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_IQR_upper_R025_75[k,j,2]<- cumulative_array_IQR_upper_R025_75[k-1,j,2]+counts_array_IQR_upper_R025_75[k,j,2]
      }
      else {
        cumulative_array_IQR_upper_R025_75[k,j,2]<-cumulative_array_IQR_upper_R025_75[k-1,j,2]+
          counts_array_IQR_upper_R025_75[k,j,2]-counts_array_IQR_upper_R025_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_IQR_upper_R025_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_IQR_upper_R025_75[l,j,3]<- cumulative_array_IQR_upper_R025_75[l-1,j,3]+counts_array_IQR_upper_R025_75[l,j,3]
      }
    else{
      cumulative_array_IQR_upper_R025_75[l,j,3]<-cumulative_array_IQR_upper_R025_75[l-1,j,3]+
          counts_array_IQR_upper_R025_75[l,j,3]-counts_array_IQR_upper_R025_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_IQR_upper_R025_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_IQR_upper_R025_75[m,j,4]<- cumulative_array_IQR_upper_R025_75[m-1,j,4]+counts_array_IQR_upper_R025_75[m,j,4]
    }
    else{
      cumulative_array_IQR_upper_R025_75[m,j,4]<-cumulative_array_IQR_upper_R025_75[m-1,j,4]+
          counts_array_IQR_upper_R025_75[m,j,4]-counts_array_IQR_upper_R025_75[m-length_of_stay[4],j,4]
      }
    }
   
  }
#######################################
cumulative_array_median_R025_50<- array(NA, dim=c(nrow(data_combined_cats_median_R025_50),ncol(data_combined_cats_median_R025_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R025_50)){
    cumulative_array_median_R025_50[1,j,]<- counts_array_median_R025_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R025_50)){
      cumulative_array_median_R025_50[i,j,1]<-cumulative_array_median_R025_50[i-1,j,1]+counts_array_median_R025_50[i,j,1]
      cumulative_array_median_R025_50[i,j,5]<-cumulative_array_median_R025_50[i-1,j,5]+counts_array_median_R025_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R025_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R025_50[k,j,2]<- cumulative_array_median_R025_50[k-1,j,2]+counts_array_median_R025_50[k,j,2]
      }
      else {
        cumulative_array_median_R025_50[k,j,2]<-cumulative_array_median_R025_50[k-1,j,2]+
          counts_array_median_R025_50[k,j,2]-counts_array_median_R025_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R025_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R025_50[l,j,3]<- cumulative_array_median_R025_50[l-1,j,3]+counts_array_median_R025_50[l,j,3]
      }
    else{
      cumulative_array_median_R025_50[l,j,3]<-cumulative_array_median_R025_50[l-1,j,3]+
          counts_array_median_R025_50[l,j,3]-counts_array_median_R025_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R025_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R025_50[m,j,4]<- cumulative_array_median_R025_50[m-1,j,4]+counts_array_median_R025_50[m,j,4]
    }
    else{
      cumulative_array_median_R025_50[m,j,4]<-cumulative_array_median_R025_50[m-1,j,4]+
          counts_array_median_R025_50[m,j,4]-counts_array_median_R025_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R025_50<- array(NA, dim=c(nrow(data_combined_cats_mean_R025_50),ncol(data_combined_cats_mean_R025_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R025_50)){
    cumulative_array_mean_R025_50[1,j,]<- counts_array_mean_R025_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R025_50)){
      cumulative_array_mean_R025_50[i,j,1]<-cumulative_array_mean_R025_50[i-1,j,1]+counts_array_mean_R025_50[i,j,1]
      cumulative_array_mean_R025_50[i,j,5]<-cumulative_array_mean_R025_50[i-1,j,5]+counts_array_mean_R025_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R025_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R025_50[k,j,2]<- cumulative_array_mean_R025_50[k-1,j,2]+counts_array_mean_R025_50[k,j,2]
      }
      else {
        cumulative_array_mean_R025_50[k,j,2]<-cumulative_array_mean_R025_50[k-1,j,2]+
          counts_array_mean_R025_50[k,j,2]-counts_array_mean_R025_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R025_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R025_50[l,j,3]<- cumulative_array_mean_R025_50[l-1,j,3]+counts_array_mean_R025_50[l,j,3]
      }
    else{
      cumulative_array_mean_R025_50[l,j,3]<-cumulative_array_mean_R025_50[l-1,j,3]+
          counts_array_mean_R025_50[l,j,3]-counts_array_mean_R025_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R025_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R025_50[m,j,4]<- cumulative_array_mean_R025_50[m-1,j,4]+counts_array_mean_R025_50[m,j,4]
    }
    else{
      cumulative_array_mean_R025_50[m,j,4]<-cumulative_array_mean_R025_50[m-1,j,4]+
          counts_array_mean_R025_50[m,j,4]-counts_array_mean_R025_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R025_50<- array(NA, dim=c(nrow(data_combined_cats_lower_R025_50),ncol(data_combined_cats_lower_R025_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R025_50)){
    cumulative_array_lower_R025_50[1,j,]<- counts_array_lower_R025_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R025_50)){
      cumulative_array_lower_R025_50[i,j,1]<-cumulative_array_lower_R025_50[i-1,j,1]+counts_array_lower_R025_50[i,j,1]
      cumulative_array_lower_R025_50[i,j,5]<-cumulative_array_lower_R025_50[i-1,j,5]+counts_array_lower_R025_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R025_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R025_50[k,j,2]<- cumulative_array_lower_R025_50[k-1,j,2]+counts_array_lower_R025_50[k,j,2]
      }
      else {
        cumulative_array_lower_R025_50[k,j,2]<-cumulative_array_lower_R025_50[k-1,j,2]+
          counts_array_lower_R025_50[k,j,2]-counts_array_lower_R025_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R025_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R025_50[l,j,3]<- cumulative_array_lower_R025_50[l-1,j,3]+counts_array_lower_R025_50[l,j,3]
      }
    else{
      cumulative_array_lower_R025_50[l,j,3]<-cumulative_array_lower_R025_50[l-1,j,3]+
          counts_array_lower_R025_50[l,j,3]-counts_array_lower_R025_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R025_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R025_50[m,j,4]<- cumulative_array_lower_R025_50[m-1,j,4]+counts_array_lower_R025_50[m,j,4]
    }
    else{
      cumulative_array_lower_R025_50[m,j,4]<-cumulative_array_lower_R025_50[m-1,j,4]+
          counts_array_lower_R025_50[m,j,4]-counts_array_lower_R025_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_upper_R025_50<- array(NA, dim=c(nrow(data_combined_cats_upper_R025_50),ncol(data_combined_cats_upper_R025_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R025_50)){
    cumulative_array_upper_R025_50[1,j,]<- counts_array_upper_R025_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R025_50)){
      cumulative_array_upper_R025_50[i,j,1]<-cumulative_array_upper_R025_50[i-1,j,1]+counts_array_upper_R025_50[i,j,1]
      cumulative_array_upper_R025_50[i,j,5]<-cumulative_array_upper_R025_50[i-1,j,5]+counts_array_upper_R025_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R025_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R025_50[k,j,2]<- cumulative_array_upper_R025_50[k-1,j,2]+counts_array_upper_R025_50[k,j,2]
      }
      else {
        cumulative_array_upper_R025_50[k,j,2]<-cumulative_array_upper_R025_50[k-1,j,2]+
          counts_array_upper_R025_50[k,j,2]-counts_array_upper_R025_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R025_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R025_50[l,j,3]<- cumulative_array_upper_R025_50[l-1,j,3]+counts_array_upper_R025_50[l,j,3]
      }
    else{
      cumulative_array_upper_R025_50[l,j,3]<-cumulative_array_upper_R025_50[l-1,j,3]+
          counts_array_upper_R025_50[l,j,3]-counts_array_upper_R025_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R025_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R025_50[m,j,4]<- cumulative_array_upper_R025_50[m-1,j,4]+counts_array_upper_R025_50[m,j,4]
    }
    else{
      cumulative_array_upper_R025_50[m,j,4]<-cumulative_array_upper_R025_50[m-1,j,4]+
          counts_array_upper_R025_50[m,j,4]-counts_array_upper_R025_50[m-length_of_stay[4],j,4]
      }
    }
   
  }
#########################################


```

Figure 1: 
Cumulative total incident symptomatic cases across all ages: 


```{r,message=FALSE, echo=TRUE, warning=FALSE}
#figure 1:  Median daily incident cases by transmission scenarios. 

#incident_cases_R017_100<- apply(data_combined_cats_median_R017_100,1,sum)
incident_cases_R017_75<- apply(data_combined_cats_median_R017_75,1,sum)
#incident_cases_R017_50<- apply(data_combined_cats_median_R017_50,1,sum)
#incident_cases_R021_100<- apply(data_combined_cats_median_R021_100,1,sum)
incident_cases_R021_75<- apply(data_combined_cats_median_R021_75,1,sum)
#incident_cases_R021_50<- apply(data_combined_cats_median_R021_50,1,sum)
#incident_cases_R025_100<- apply(data_combined_cats_median_R025_100,1,sum)
incident_cases_R025_75<- apply(data_combined_cats_median_R025_75,1,sum)
#incident_cases_R025_50<- apply(data_combined_cats_median_R025_50,1,sum)
incident_cases_lower_R017_75<- apply(data_combined_cats_IQR_lower_R017_75,1,sum)
incident_cases_upper_R017_75<- apply(data_combined_cats_IQR_upper_R017_75,1,sum)
incident_cases_lower_R021_75<- apply(data_combined_cats_IQR_lower_R021_75,1,sum)
incident_cases_upper_R021_75<- apply(data_combined_cats_IQR_upper_R021_75,1,sum)
incident_cases_lower_R025_75<- apply(data_combined_cats_IQR_lower_R025_75,1,sum)
incident_cases_upper_R025_75<- apply(data_combined_cats_IQR_upper_R025_75,1,sum)

wide_incident_cases<- as.data.frame(cbind(rep(1:length(incident_cases_R017_75)),
                      incident_cases_R017_75,incident_cases_R021_75,incident_cases_R025_75))
                      
wide_bounds_lower<- as.data.frame(cbind(rep(1:length(incident_cases_R017_75)),
                        incident_cases_lower_R017_75,
                        incident_cases_lower_R021_75,
                        incident_cases_lower_R025_75))

wide_bounds_upper<- as.data.frame(cbind(rep(1:length(incident_cases_R017_75)),
                    incident_cases_upper_R017_75,incident_cases_upper_R021_75,
                    incident_cases_upper_R025_75))
colnames(wide_incident_cases)<- c("Day","R_0=1.7","R_0=2.1","R_0=2.5")

colnames(wide_bounds_lower)<- c("Day","lower_R_0=1.7","lower_R_0=2.1", "lower_R_0=2.5")

colnames(wide_bounds_upper)<- c("Day","upper_R_0=1.7","upper_R_0=2.1","upper_R_0=2.5")

long_incident_cases<- gather(wide_incident_cases,scenario, incident_cases,
                             "R_0=1.7":"R_0=2.5", factor_key=TRUE)

long_bounds_lower<- gather(wide_bounds_lower,scenario, incident_lower,
                     "lower_R_0=1.7":"lower_R_0=2.5")
long_bounds_upper<- gather(wide_bounds_upper,scenario, incident_upper,
                     "upper_R_0=1.7":"upper_R_0=2.5")

combined_long_matrix<- as.data.frame(cbind(long_incident_cases,long_bounds_lower$incident_lower,
                                           long_bounds_upper$incident_upper))

colnames(combined_long_matrix)<- c("Day", "scenario","incident_cases","lower","upper")

combined_long_matrix<-combined_long_matrix%>%
  mutate(lower=ifelse(incident_cases==0,0,lower))


plt_incident_cases<- ggplot(combined_long_matrix)+ 
  geom_line(aes(y= incident_cases, x=Day,color=scenario))+
  labs(title="Median Incident Symptomatic Cases Per Day",y="Median Number of Incident Cases")
  #geom_ribbon(aes(ymax=upper,ymin=lower,x=Day, fill='band'))+
  #scale_fill_manual("",values="grey12")


plt_incident_cases


```

Figure 2: 

```{r, message=FALSE, warning=FALSE, echo=TRUE}
#incident_cases_R017_100<- apply(data_combined_cats_median_R017_100,1,sum)
incident_hosp_R017_75<- apply(counts_array_median_R017_75[,,2],1,sum)
#incident_cases_R017_50<- apply(data_combined_cats_median_R017_50,1,sum)
#incident_cases_R021_100<- apply(data_combined_cats_median_R021_100,1,sum)
incident_hosp_R021_75<- apply(counts_array_median_R021_75[,,2],1,sum)
#incident_cases_R021_50<- apply(data_combined_cats_median_R021_50,1,sum)
#incident_cases_R025_100<- apply(data_combined_cats_median_R025_100,1,sum)
incident_hosp_R025_75<- apply(counts_array_median_R025_75[,,2],1,sum)
#incident_cases_R025_50<- apply(data_combined_cats_median_R025_50,1,sum)
incident_hosp_lower_R017_75<- apply(counts_array_IQR_lower_R017_75[,,2],1,sum)
incident_hosp_upper_R017_75<- apply(counts_array_IQR_upper_R017_75[,,2],1,sum)
incident_hosp_lower_R021_75<- apply(counts_array_IQR_lower_R021_75[,,2],1,sum)
incident_hosp_upper_R021_75<- apply(counts_array_IQR_upper_R021_75[,,2],1,sum)
incident_hosp_lower_R025_75<- apply(counts_array_IQR_lower_R025_75[,,2],1,sum)
incident_hosp_upper_R025_75<- apply(counts_array_IQR_upper_R025_75[,,2],1,sum)

wide_hosp_cases<- as.data.frame(cbind(rep(1:length(incident_hosp_R017_75)),
                      incident_hosp_R017_75,incident_hosp_R021_75,incident_hosp_R025_75))
                      
wide_bounds_lower<- as.data.frame(cbind(rep(1:length(incident_hosp_R017_75)),
                        incident_hosp_lower_R017_75,
                        incident_hosp_lower_R021_75,
                        incident_hosp_lower_R025_75))

wide_bounds_upper<- as.data.frame(cbind(rep(1:length(incident_hosp_R017_75)),
                    incident_hosp_upper_R017_75,incident_hosp_upper_R021_75,
                    incident_hosp_upper_R025_75))
colnames(wide_hosp_cases)<- c("Day","R_0=1.7","R_0=2.1","R_0=2.5")

colnames(wide_bounds_lower)<- c("Day","lower_R_0=1.7","lower_R_0=2.1", "lower_R_0=2.5")

colnames(wide_bounds_upper)<- c("Day","upper_R_0=1.7","upper_R_0=2.1","upper_R_0=2.5")

long_incident_cases<- gather(wide_hosp_cases,scenario, incident_cases,
                             "R_0=1.7":"R_0=2.5", factor_key=TRUE)

long_bounds_lower<- gather(wide_bounds_lower,scenario, incident_lower,
                     "lower_R_0=1.7":"lower_R_0=2.5")
long_bounds_upper<- gather(wide_bounds_upper,scenario, incident_upper,
                     "upper_R_0=1.7":"upper_R_0=2.5")

combined_long_matrix<- as.data.frame(cbind(long_incident_cases,long_bounds_lower$incident_lower,
                                           long_bounds_upper$incident_upper))

colnames(combined_long_matrix)<- c("Day", "scenario","incident_cases","lower","upper")

combined_long_matrix<-combined_long_matrix%>%
  mutate(lower=ifelse(incident_cases==0,0,lower))



plt_hosp_cases<- ggplot(combined_long_matrix)+ 
  geom_line(aes(y= incident_cases, x=Day,color=scenario))+
  labs(title="Median Incident Hospitalizations Per Day",
       y="Median Number of Hospitalizations Cases")
  #geom_ribbon(aes(ymax=upper,ymin=lower,x=Day, fill='band'))+
  #scale_fill_manual("",values="grey12")


plt_hosp_cases


```


Figure 3:
```{r, message=FALSE, warning=FALSE, echo=FALSE}
#incident_cases_R017_100<- apply(data_combined_cats_median_R017_100,1,sum)
incident_death_R017_75<- apply(counts_array_median_R017_75[,,5],1,sum)
#incident_cases_R017_50<- apply(data_combined_cats_median_R017_50,1,sum)
#incident_cases_R021_100<- apply(data_combined_cats_median_R021_100,1,sum)
incident_death_R021_75<- apply(counts_array_median_R021_75[,,5],1,sum)
#incident_cases_R021_50<- apply(data_combined_cats_median_R021_50,1,sum)
#incident_cases_R025_100<- apply(data_combined_cats_median_R025_100,1,sum)
incident_death_R025_75<- apply(counts_array_median_R025_75[,,5],1,sum)
#incident_cases_R025_50<- apply(data_combined_cats_median_R025_50,1,sum)
incident_death_lower_R017_75<- apply(counts_array_IQR_lower_R017_75[,,5],1,sum)
incident_death_upper_R017_75<- apply(counts_array_IQR_upper_R017_75[,,5],1,sum)
incident_death_lower_R021_75<- apply(counts_array_IQR_lower_R021_75[,,5],1,sum)
incident_death_upper_R021_75<- apply(counts_array_IQR_upper_R021_75[,,5],1,sum)
incident_death_lower_R025_75<- apply(counts_array_IQR_lower_R025_75[,,5],1,sum)
incident_death_upper_R025_75<- apply(counts_array_IQR_upper_R025_75[,,5],1,sum)

wide_death_cases<- as.data.frame(cbind(rep(1:length(incident_death_R017_75)),
                      incident_death_R017_75,incident_death_R021_75,incident_death_R025_75))
                      
wide_bounds_lower<- as.data.frame(cbind(rep(1:length(incident_death_R017_75)),
                        incident_death_lower_R017_75,
                        incident_death_lower_R021_75,
                        incident_death_lower_R025_75))

wide_bounds_upper<- as.data.frame(cbind(rep(1:length(incident_death_R017_75)),
                    incident_death_upper_R017_75,incident_death_upper_R021_75,
                    incident_death_upper_R025_75))
colnames(wide_death_cases)<- c("Day","R_0=1.7","R_0=2.1","R_0=2.5")

colnames(wide_bounds_lower)<- c("Day","lower_R_0=1.7","lower_R_0=2.1", "lower_R_0=2.5")

colnames(wide_bounds_upper)<- c("Day","upper_R_0=1.7","upper_R_0=2.1","upper_R_0=2.5")

long_incident_cases<- gather(wide_death_cases,scenario, incident_cases,
                             "R_0=1.7":"R_0=2.5", factor_key=TRUE)

long_bounds_lower<- gather(wide_bounds_lower,scenario, incident_lower,
                     "lower_R_0=1.7":"lower_R_0=2.5")
long_bounds_upper<- gather(wide_bounds_upper,scenario, incident_upper,
                     "upper_R_0=1.7":"upper_R_0=2.5")

combined_long_matrix<- as.data.frame(cbind(long_incident_cases,long_bounds_lower$incident_lower,
                                           long_bounds_upper$incident_upper))

colnames(combined_long_matrix)<- c("Day", "scenario","incident_cases","lower","upper")

combined_long_matrix<-combined_long_matrix%>%
  mutate(lower=ifelse(incident_cases==0,0,lower))



plt_death_cases<- ggplot(combined_long_matrix)+ 
  geom_line(aes(y= incident_cases, x=Day,color=scenario))+
  labs(title="Median Deaths Per Day",
       y="Median Number of Deaths")
  #geom_ribbon(aes(ymax=upper,ymin=lower,x=Day, fill='band'))+
  #scale_fill_manual("",values="grey12")


plt_death_cases

```


Figure 4: 

```{r, message=FALSE, warning=FALSE, echo=TRUE}

cumulative_symptomatic_cases_R017<- matrix(NA, nrow(data_combined_cats_median_R017_75), ncol=ncol(data_combined_cats_median_R017_75))

for(i in 1:ncol(cumulative_symptomatic_cases_R017)){
  cumulative_symptomatic_cases_R017[1,i]<- data_combined_cats_median_R017_75[1,i]
  for(j in 2:nrow(cumulative_symptomatic_cases_R017)){
    cumulative_symptomatic_cases_R017[j,i]<- cumulative_symptomatic_cases_R017[(j-1),i]+data_combined_cats_median_R017_75[(j),i]
  }
}


cumulative_symptomatic_cases_R021<- matrix(NA, nrow(data_combined_cats_median_R021_75), ncol=ncol(data_combined_cats_median_R021_75))

for(i in 1:ncol(cumulative_symptomatic_cases_R021)){
  cumulative_symptomatic_cases_R021[1,i]<- data_combined_cats_median_R021_75[1,i]
  for(j in 2:nrow(cumulative_symptomatic_cases_R021)){
    cumulative_symptomatic_cases_R021[j,i]<- cumulative_symptomatic_cases_R021[(j-1),i]+data_combined_cats_median_R021_75[(j),i]
  }
}

cumulative_symptomatic_cases_R025<- matrix(NA, nrow(data_combined_cats_median_R025_75), ncol=ncol(data_combined_cats_median_R025_75))

for(i in 1:ncol(cumulative_symptomatic_cases_R025)){
  cumulative_symptomatic_cases_R025[1,i]<- data_combined_cats_median_R025_75[1,i]
  for(j in 2:nrow(cumulative_symptomatic_cases_R025)){
    cumulative_symptomatic_cases_R025[j,i]<- cumulative_symptomatic_cases_R025[(j-1),i]+data_combined_cats_median_R025_75[(j),i]
  }
}

cumulative_symptomatic_cases<- as.data.frame(cbind(rep(1:nrow(data_combined_cats_median_R017_75)),
                                              apply(cumulative_symptomatic_cases_R017,1,sum),
                                              apply(cumulative_symptomatic_cases_R021,1,sum),
                                              apply(cumulative_symptomatic_cases_R025,1,sum)))

colnames(cumulative_symptomatic_cases)<- c("Day", "R_0=1.7","R_0=2.1", "R_0=2.5")

cumulative_symptomatic_cases_long<- gather(cumulative_symptomatic_cases, scenario, num_cases,
                                           "R_0=1.7":"R_0=2.5",factor_key=TRUE)

plt_cumulative_symptomatic<- ggplot(cumulative_symptomatic_cases_long)+
  geom_line(aes(x= Day, y= num_cases, color=scenario))+
  labs(y="Number of Symptomatic Cases", title="Median Number of Symptomatic Cases")

plt_cumulative_symptomatic

######################


cumulative_hosp_cases<- as.data.frame(cbind(rep(1:nrow(data_combined_cats_median_R017_75)),
                                              apply(cumulative_array_median_R017_75[,,1],1,sum),
                                              apply(cumulative_array_median_R021_75[,,1],1,sum),
                                              apply(cumulative_array_median_R025_75[,,1],1,sum)))

colnames(cumulative_hosp_cases)<- c("Day", "R_0=1.7","R_0=2.1", "R_0=2.5")

cumulative_hosp_cases_long<- gather(cumulative_hosp_cases, scenario, num_cases,
                                           "R_0=1.7":"R_0=2.5",factor_key=TRUE)

plt_cumulative_hosp<- ggplot(cumulative_hosp_cases_long)+
  geom_line(aes(x= Day, y= num_cases, color=scenario))+
  labs(y="Number of Hospitalizations", title="Median Number of Hospitalizations")

plt_cumulative_hosp

#############################

cumulative_hosp_cases_R017<- as.data.frame(cbind(rep(1:nrow(data_combined_cats_median_R017_75)),
                                              cumulative_array_median_R017_75[,,1]))

colnames(cumulative_hosp_cases_R017)<- c("Day","Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless" )

cumulative_hosp_R017_long<- gather(cumulative_hosp_cases_R017, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_hosp_R017<- ggplot(cumulative_hosp_R017_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of Hospitalizations", title="Cumulative Number of Hospitalizations R_0=1.7")

plt_cumulative_hosp_R017


cumulative_hosp_cases_R021<- as.data.frame(cbind(rep(1:nrow(data_combined_cats_median_R021_75)),
                                              cumulative_array_median_R021_75[,,1]))

colnames(cumulative_hosp_cases_R021)<- c("Day","Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless" )

cumulative_hosp_R021_long<- gather(cumulative_hosp_cases_R021, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_hosp_R021<- ggplot(cumulative_hosp_R021_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of Hospitalizations", title="Cumulative Number of Hospitalizations R_0=2.1")

plt_cumulative_hosp_R021

cumulative_hosp_cases_R025<- as.data.frame(cbind(rep(1:nrow(data_combined_cats_median_R025_75)),
                                              cumulative_array_median_R025_75[,,1]))

colnames(cumulative_hosp_cases_R025)<- c("Day","Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless" )

cumulative_hosp_R025_long<- gather(cumulative_hosp_cases_R025, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_hosp_R025<- ggplot(cumulative_hosp_R025_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of Hospitalizations", title="Cumulative Number of Hospitalizations R_0=2.5")

plt_cumulative_hosp_R025

```

Figure 5:

```{r, message=FALSE, echo=TRUE, message=FALSE}

cumulative_deaths<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,5])),
                    apply(cumulative_array_median_R017_75[,,5],1,sum),
                    apply(cumulative_array_median_R021_75[,,5],1,sum),
                    apply(cumulative_array_median_R025_75[,,5],1,sum)))



colnames(cumulative_deaths)<- c("Day","R_0=1.7","R_0=2.1","R_0=2.5")

long_cumulative_deaths<- gather(cumulative_deaths,scenario, num_cases,
                             "R_0=1.7":"R_0=2.5", factor_key=TRUE)


plt_cumulative_death<- ggplot(long_cumulative_deaths)+ 
  geom_line(aes(y= num_cases, x=Day,color=scenario))+
  labs(title="Median Total Deaths",
       y="Median Number of Deaths")
  #geom_ribbon(aes(ymax=upper,ymin=lower,x=Day, fill='band'))+
  #scale_fill_manual("",values="grey12")


plt_cumulative_death

#######################


cumulative_deaths_R_017<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,5])),
                                        cumulative_array_median_R017_75[,,5]))


colnames(cumulative_deaths_R_017)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_deaths_R_017_long<- gather(cumulative_deaths_R_017, age_group, cumulative_deaths,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_death_by_R_017<- ggplot(cumulative_deaths_R_017_long)+
  geom_line(aes(x=Day,y=cumulative_deaths,color=age_group))+
  labs(y="Number of Deaths", title="Cumulative Number of Deaths for R_0=1.7")

plt_cumulative_death_by_R_017

######################

cumulative_deaths_R_021<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,5])),
                                        cumulative_array_median_R021_75[,,5]))


colnames(cumulative_deaths_R_021)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_deaths_R_021_long<- gather(cumulative_deaths_R_021, age_group, cumulative_deaths,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_death_by_R_021<- ggplot(cumulative_deaths_R_021_long)+
  geom_line(aes(x=Day,y=cumulative_deaths,color=age_group))+
  labs(y="Number of Deaths", title="Cumulative Number of Deaths for R_0=2.1")

plt_cumulative_death_by_R_021

###########################


cumulative_deaths_R_025<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,5])),
                                        cumulative_array_median_R025_75[,,5]))


colnames(cumulative_deaths_R_025)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_deaths_R_025_long<- gather(cumulative_deaths_R_025, age_group, cumulative_deaths,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_death_by_R_025<- ggplot(cumulative_deaths_R_025_long)+
  geom_line(aes(x=Day,y=cumulative_deaths,color=age_group))+
  labs(y="Number of Deaths", title="Cumulative Number of Deaths for R_0=2.5")

plt_cumulative_death_by_R_025

```

Figure 6: 

```{r, warning=FALSE, message=FALSE, echo=TRUE}

cumulative_hosp_R_017<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,2])),
                                        cumulative_array_median_R017_75[,,2]))


colnames(cumulative_hosp_R_017)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_hosp_R_017_long<- gather(cumulative_hosp_R_017, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_hosp_by_R_017<- ggplot(cumulative_hosp_R_017_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of Hospital Beds Used", title="Number of Hospital Beds In Use Per Day for R_0=1.7")

plt_cumulative_hosp_by_R_017

cumulative_hosp_R_021<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R021_75[,,2])),
                                        cumulative_array_median_R021_75[,,2]))


colnames(cumulative_hosp_R_021)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_hosp_R_021_long<- gather(cumulative_hosp_R_021, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_hosp_by_R_021<- ggplot(cumulative_hosp_R_021_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of Hospital Beds Used", title="Number of Hospital Beds In Use Per Day for R_0=2.1")

plt_cumulative_hosp_by_R_021

cumulative_hosp_R_025<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R025_75[,,2])),
                                        cumulative_array_median_R025_75[,,2]))


colnames(cumulative_hosp_R_025)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_hosp_R_025_long<- gather(cumulative_hosp_R_025, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_hosp_by_R_025<- ggplot(cumulative_hosp_R_025_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of Hospital Beds Used", title="Number of Hospital Beds In Use Per Day for R_0=2.5")

plt_cumulative_hosp_by_R_025

############
cumulative_ICU_R_017<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,3])),
                                        cumulative_array_median_R017_75[,,3]))


colnames(cumulative_ICU_R_017)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_ICU_R_017_long<- gather(cumulative_ICU_R_017, age_group, cumulative_ICU,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_ICU_by_R_017<- ggplot(cumulative_ICU_R_017_long)+
  geom_line(aes(x=Day,y=cumulative_ICU,color=age_group))+
  labs(y="Number of ICU Beds Used", title="Number of ICU Beds In Use Per Day for R_0=1.7")

plt_cumulative_ICU_by_R_017

cumulative_ICU_R_021<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R021_75[,,3])),
                                        cumulative_array_median_R021_75[,,3]))


colnames(cumulative_ICU_R_021)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_ICU_R_021_long<- gather(cumulative_ICU_R_021, age_group, cumulative_ICU,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_ICU_by_R_021<- ggplot(cumulative_ICU_R_021_long)+
  geom_line(aes(x=Day,y=cumulative_ICU,color=age_group))+
  labs(y="Number of ICU Beds Used", title="Number of ICU Beds In Use Per Day for R_0=2.1")

plt_cumulative_ICU_by_R_021

cumulative_ICU_R_025<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R025_75[,,3])),
                                        cumulative_array_median_R025_75[,,3]))


colnames(cumulative_ICU_R_025)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_ICU_R_025_long<- gather(cumulative_ICU_R_025, age_group, cumulative_ICU,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_ICU_by_R_025<- ggplot(cumulative_ICU_R_025_long)+
  geom_line(aes(x=Day,y=cumulative_ICU,color=age_group))+
  labs(y="Number of ICU Beds Used", title="Number of ICU Beds In Use Per Day for R_0=2.5")

plt_cumulative_ICU_by_R_025

##################

cumulative_vent_R_017<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,4])),
                                        cumulative_array_median_R017_75[,,4]))


colnames(cumulative_vent_R_017)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_vent_R_017_long<- gather(cumulative_vent_R_017, age_group, cumulative_vent,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_vent_by_R_017<- ggplot(cumulative_vent_R_017_long)+
  geom_line(aes(x=Day,y=cumulative_vent,color=age_group))+
  labs(y="Number of Vents Used", title="Number of Vents In Use Per Day for R_0=1.7")

plt_cumulative_vent_by_R_017

cumulative_vent_R_021<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R021_75[,,4])),
                                        cumulative_array_median_R021_75[,,4]))


colnames(cumulative_vent_R_021)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_vent_R_021_long<- gather(cumulative_vent_R_021, age_group, cumulative_vent,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_vent_by_R_021<- ggplot(cumulative_vent_R_021_long)+
  geom_line(aes(x=Day,y=cumulative_vent,color=age_group))+
  labs(y="Number of Vents Used", title="Number of Vents In Use Per Day for R_0=2.1")

plt_cumulative_vent_by_R_021

cumulative_vent_R_025<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R025_75[,,4])),
                                        cumulative_array_median_R025_75[,,4]))


colnames(cumulative_vent_R_025)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_vent_R_025_long<- gather(cumulative_vent_R_025, age_group, cumulative_vent,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_vent_by_R_025<- ggplot(cumulative_vent_R_025_long)+
  geom_line(aes(x=Day,y=cumulative_vent,color=age_group))+
  labs(y="Number of Vents Used", title="Number of Vents In Use Per Day for R_0=2.5")

plt_cumulative_vent_by_R_025


```