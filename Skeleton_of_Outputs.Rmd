---
title: "Skeleton_of_Outputs"
author: ""
date: "3/19/2020"
output: pdf_document
---

This is a document for a code skeleton for the outputs section of the project.

Loading in relevant data sources for this: 
```{r, message=FALSE, echo=TRUE, warning=FALSE}

setwd('~/Dropbox/COVID-BaltimoreCity/Output_20200322_v2')

require(socialmixr)
require(xlsx)
require(magrittr)
require(stringr)
require(reshape2)
require(dplyr)
require(ggplot2) 
require(tidyr)
require(xtable)

#cleaning function, we want to take in incident symptomatic cases in each of the original 14 age groups and time the simulation has been running for (days since introduction to state) for each of the 500 simulations
#we want the function to return a matrix for each R_0 scenario that includes incident symptomatic infections for each of the 7 (consolidated) age categories over 365 days for each of the 500 simulations. 
complete_R017<- read.csv("SEIR_results__n500__r017__75.csv")
complete_R021<- read.csv("SEIR_results__n500__r021__75.csv")
complete_R025<- read.csv("SEIR_results__n500__r025__75.csv")


load_and_clean<- function(data, r0val){
  complete_incident_r0val<- data[-182501,]%>%
    select(time,incid_I1,incid_I2,incid_I3,incid_I4,incid_I5,
         incid_I6,incid_I7,incid_I8,incid_I9,
         incid_I10,incid_I11,incid_I12,incid_I13,incid_I14)
  
  combined_incident_r0val<- complete_incident_r0val%>%
        mutate(cat1=rowSums(.[2:5]))%>%
        mutate(cat2=rowSums(.[6:8]))%>%
        mutate(cat3=rowSums(.[9]))%>%
        mutate(cat4=rowSums(.[10:12]))%>%
        mutate(cat5=rowSums(.[13]))%>%
        mutate(cat6=rowSums(.[14]))%>%
        mutate(cat7=rowSums(.[15]))
  
  combined_incident_r0val<- combined_incident_r0val%>%
    select(time, cat1, cat2, cat3, cat4, cat5, cat6, cat7)
  
  return(combined_incident_r0val)
}
  
combined_incident_R017<- load_and_clean(complete_R017,R017)  
combined_incident_R021<- load_and_clean(complete_R021,R021)  
combined_incident_R025<- load_and_clean(complete_R025,R025)  


```




```{r, message=FALSE, warning=FALSE, echo=TRUE}

#working probabilities for severe cases, hospitalization, ICU, vent and death. 
#these are nested conditional probabilities, and they rely on the following  assumptions: 
#the percentage of severe cases in each categories is obtained from CDC table where we combined the 55-74 age groups and the 75-80 and 80+ age groups. 
#we assume now that 100% of severe cases get hospitalized (this could be adjusted)
# the remainder of the nested probabilities come from the CDC table, instead of using the denominator as all the cases in that age group, we shift the denoinator to be the preceding categoriy of sverity so prob ICU is the number of icu cases for that age group/ number of hospitalized cases for that age group. 

#HCW workers and homeless have the same nested prob scheme as the 45-540y.o group.
prob_severe<- c(0.02, 0.029, 0.066, 0.088,0.364,0.066,0.066)

prob_hospitalized<- rep(1,ncol(combined_incident_R017)-1)

prob_ICU<- c(0,0.2,0.367,0.4,0.465,0.367,0.367)

prob_vent<-c(0,0.238,0.288,0.467,0.8,0.288,0.288)

prob_death<-c(0,0.2,0.267,0.536,0.788,0.267,0.267)

prob_matrix<- cbind(prob_severe,prob_hospitalized,prob_ICU,
                    prob_vent,prob_death)



```


Now calculate the number in of severe, hospitalized, ICU and vented infections at each timepoint (day) in each group (age groups 1-12 and healthcare workers and homeless). 


```{r, message=FALSE, echo=TRUE, warning=FALSE}
#calculate number of incident cases that get classified as severe,  of those, 
#the number get hospitalized (currently 100%), of that then those that get classified as ICU and then of those that get put on a vent and of those the ones that die 11 days later (11 day lag for death prob)
#this is for each age group (+ HCW and homeless)
#note this categorization is NOT a disease progression, a person gets assigned based on the worst state they could possibly reach. 


incident_classifications<- function(data, R0val){
  counts_array_R0val<- array(NA, dim=c(nrow(data),
                                       ncol(data),
                                       ncol(prob_matrix)))
  counts_array_R0val[,1,]<- data$time
  
  for(j in 2:ncol(data)){
  for(i in 1:nrow(data)){
      counts_array_R0val[i,j,1]<- data[i,j]*prob_matrix[j-1,1]
      counts_array_R0val[i,j,2]<- counts_array_R0val[i,j,1]*prob_matrix[j-1,2]
      counts_array_R0val[i,j,3]<- counts_array_R0val[i,j,2]*prob_matrix[j-1,3]
      counts_array_R0val[i,j,4]<- counts_array_R0val[i,j,3]*prob_matrix[j-1,4]
  }
  for(k in 1:365){
    if(k<=11){
      counts_array_R0val[which(counts_array_R0val[,1,1]==k),j,5]<- 0
    }
    else{
      counts_array_R0val[which(counts_array_R0val[,1,1]==k),j,5]<-
        counts_array_R0val[which(counts_array_R0val[,1,1]==k-11),j,4]*prob_matrix[j-1,5]
    }
  }
  }
  
return(counts_array_R0val)

}

counts_array_R017<- incident_classifications(combined_incident_R017,R017)
counts_array_R021<- incident_classifications(combined_incident_R021,R021)
counts_array_R025<- incident_classifications(combined_incident_R025,R025)


```

Now  load in a dataset that gives estimates of how long people stay hospitalized, in ICU or on vents
Compute a running total of each category.
```{r,message=FALSE, warning=FALSE, echo=TRUE}
#for now we are supposing we get a point estimate to determine how long people stay in each of the states. 

length_of_stay<- c(NA,11,11,11,NA)

#now we want a running total of how many severe cases, hospitalizations, ICU, vents, and deaths are occuring we are keeping people in hospital, or ICU, or on a vent for 11 days (i.e. fixed point estimate, this can be adapted to be a distribution). We do this for each day in each of the 500 sims, we will compute summary statistics seperately. 
cumulative_counts<- function(data, R0val){
  cumulative_array_R0val<- array(NA, dim=dim(data))
  
  cumulative_array_R0val[,1,]<- data[,1,]

  for(j in 2:dim(cumulative_array_R0val)[2]){
    cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==1),j,]<-
      data[which(data[,1,1]==1),j,]
    
    for(i in 2:365){
      cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==i),j,1]<-
        cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==(i-1)),j,1]+
        data[which(data[,1,1]==i),j,1]
      cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==i),j,5]<-
        cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==(i-1)),j,5]+
        data[which(data[,1,1]==i),j,5]
    }

    for(k in 2:365){
      if(k<=length_of_stay[2]){
      cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==k),j,2]<-
        cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==(k-1)),j,2]+
        data[which(data[,1,1]==k),j,2]
      }
      else {
        cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==k),j,2]<-
          cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==k-1),j,2]+
          data[which(data[,1,1]==k),j,2]-data[which(data[,1,1]==(k-length_of_stay[2])),j,2]
      }
    }
  for(l in 2:365){
      if(l <= length_of_stay[3]){
        cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==l),j,3]<-
          cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==(l-1)),j,3]+
          data[which(data[,1,1]==l),j,3]
      }
    else{
      cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==l),j,3]<-
        cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==(l-1)),j,3]+
          data[which(data[,1,1]==l),j,3]-data[which(data[,1,1]==(k-length_of_stay[3])),j,3]
    }
  }
    for(m in 2:365){
    if(m<=length_of_stay[4]){
      cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==m),j,4]<-
        cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==(m-1)),j,4]+
        data[which(data[,1,1]==m),j,4]
    }
    else{
      cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==m),j,4]<-
        cumulative_array_R0val[which(cumulative_array_R0val[,1,1]==(m-1)),j,4]+
          data[which(data[,1,1]==m),j,4]-data[which(data[,1,1]==(m-length_of_stay[4])),j,4]
      }
    }
   
}
return(cumulative_array_R0val)
  
}

cumulative_array_R017<- cumulative_counts(counts_array_R017,R017)
cumulative_array_R021<- cumulative_counts(counts_array_R021,R021)
cumulative_array_R025<- cumulative_counts(counts_array_R025,R025)

```


```{r, message=FALSE, warning-FALSE, echo=TRUE}

#get median and 75th and 25th quantile for each output, incident and cumulative counts. 

#this is the part where we could get fancy and do a bootstrap median, min and max??? if we wanted. eventually....

median_incident_symptomatic<- function(data, R0val){
  median_incident_combined_R0val<- matrix(NA,365,ncol(data))

    for(i in 1:nrow(median_incident_combined_R0val)){
      median_incident_combined_R0val[i,]<-
        apply(data[which(data[,1]==i),],2,median)
    }
  upper_incident_combined_R0val<- matrix(NA,365,ncol(data))

    for(i in 1:nrow(upper_incident_combined_R0val)){
      upper_incident_combined_R0val[i,]<-
        apply(data[which(data[,1]==i),],2,quantile, probs=(0.75), na.rm=TRUE)
    }
  
  lower_incident_combined_R0val<- matrix(NA,365,ncol(data))

    for(i in 1:nrow(lower_incident_combined_R0val)){
      lower_incident_combined_R0val[i,]<-
        apply(data[which(data[,1]==i),],2,quantile, probs=(0.25), na.rm=TRUE)
    }
  
  
  return(list(median_incident_combined_R0val, upper_incident_combined_R0val,
              lower_incident_combined_R0val))
  }

incident_symptomatic_R017<- median_incident_symptomatic(combined_incident_R017,R017)

median_incident_symptomatic_R017<- incident_symptomatic_R017[[1]]
upper_incident_symptomatic_R017<- incident_symptomatic_R017[[2]]
lower_incident_symptomatic_R017<- incident_symptomatic_R017[[3]]


incident_symptomatic_R021<- median_incident_symptomatic(combined_incident_R021,R021)
median_incident_symptomatic_R021<- incident_symptomatic_R021[[1]]
upper_incident_symptomatic_R021<- incident_symptomatic_R021[[2]]
lower_incident_symptomatic_R021<- incident_symptomatic_R021[[3]]

incident_symptomatic_R025<- median_incident_symptomatic(combined_incident_R025,R025)
median_incident_symptomatic_R025<- incident_symptomatic_R025[[1]]
upper_incident_symptomatic_R025<- incident_symptomatic_R025[[2]]
lower_incident_symptomatic_R025<- incident_symptomatic_R025[[3]]

####################################################################

median_counts_array<- function(data, R0val){
  median_counts_array<- array(NA, dim=c(365,dim(data)[2], dim(data)[3]))
  
  for(i in 1:dim(median_counts_array)[3]){
    for(j in 1:dim(median_counts_array)[1]){
      median_counts_array[j,,i]<- apply(data[which(data[,1,1]==j),,i],2,median)
    }
  }
 
   upper_counts_array<- array(NA, dim=c(365,dim(data)[2], dim(data)[3]))
  
  for(i in 1:dim(upper_counts_array)[3]){
    for(j in 1:dim(upper_counts_array)[1]){
      upper_counts_array[j,,i]<- apply(data[which(data[,1,1]==j),,i],2,quantile, prob=0.75,na.rm=T)
    }
  } 
   
    lower_counts_array<- array(NA, dim=c(365,dim(data)[2], dim(data)[3]))
  
  for(i in 1:dim(lower_counts_array)[3]){
    for(j in 1:dim(lower_counts_array)[1]){
      lower_counts_array[j,,i]<- apply(data[which(data[,1,1]==j),,i],2,quantile, prob=0.25,na.rm=T)
    }
  } 
    return(list(median_counts_array, upper_counts_array,lower_counts_array))
}

summary_counts_array_R017<- median_counts_array(counts_array_R017,R017)
median_counts_array_R017<- summary_counts_array_R017[[1]]
upper_counts_array_R017<- summary_counts_array_R017[[2]]
lower_counts_array_R017<- summary_counts_array_R017[[3]]

summary_counts_array_R021<- median_counts_array(counts_array_R021,R021)
median_counts_array_R021<- summary_counts_array_R021[[1]]
upper_counts_array_R021<- summary_counts_array_R021[[2]]
lower_counts_array_R021<- summary_counts_array_R021[[3]]

summary_counts_array_R025<- median_counts_array(counts_array_R025,R025)
median_counts_array_R025<- summary_counts_array_R025[[1]]
upper_counts_array_R025<- summary_counts_array_R025[[2]]
lower_counts_array_R025<- summary_counts_array_R025[[3]]
########################################

median_cumulative_array<- function(data, R0val){
  median_cumulative_array<- array(NA, dim=c(365,dim(data)[2], dim(data)[3]))
  
  for(i in 1:dim(median_cumulative_array)[3]){
    for(j in 1:dim(median_cumulative_array)[1]){
      median_cumulative_array[j,,i]<- apply(data[which(data[,1,1]==j),,i],2,median,na.rm=T)
    }
  }
 
   upper_cumulative_array<- array(NA, dim=c(365,dim(data)[2], dim(data)[3]))
  
  for(i in 1:dim(upper_cumulative_array)[3]){
    for(j in 1:dim(upper_cumulative_array)[1]){
      upper_cumulative_array[j,,i]<- apply(data[which(data[,1,1]==j),,i],2,quantile, prob=0.75,na.rm=T)
    }
  } 
   
    lower_cumulative_array<- array(NA, dim=c(365,dim(data)[2], dim(data)[3]))
  
  for(i in 1:dim(lower_cumulative_array)[3]){
    for(j in 1:dim(lower_cumulative_array)[1]){
      lower_cumulative_array[j,,i]<- apply(data[which(data[,1,1]==j),,i],2,quantile, prob=0.25,na.rm=T)
    }
  } 
    return(list(median_cumulative_array, upper_cumulative_array,lower_cumulative_array))
}


summary_cumulative_array_R017<- median_cumulative_array(cumulative_array_R017,R017)
median_cumulative_array_R017<- summary_cumulative_array_R017[[1]]
upper_cumulative_array_R017<- summary_cumulative_array_R017[[2]]
lower_cumulative_array_R017<- summary_cumulative_array_R017[[3]]

summary_cumulative_array_R021<- median_cumulative_array(cumulative_array_R021,R021)
median_cumulative_array_R021<- summary_cumulative_array_R021[[1]]
upper_cumulative_array_R021<- summary_cumulative_array_R021[[2]]
lower_cumulative_array_R021<- summary_cumulative_array_R021[[3]]

summary_cumulative_array_R025<- median_cumulative_array(cumulative_array_R025,R025)
median_cumulative_array_R025<- summary_cumulative_array_R025[[1]]
upper_cumulative_array_R025<- summary_cumulative_array_R025[[2]]
lower_cumulative_array_R025<- summary_cumulative_array_R025[[3]]

```
Figure 1: 
Cumulative total incident symptomatic cases across all ages: 


```{r,message=FALSE, echo=TRUE, warning=FALSE}
#figure 1:  Median daily incident cases by transmission scenarios. 


#randomly select 15 sims to show for each R_0 scenario

random_sample_R017<- which(complete_R017$run_index%in%sample(rep(1:500),15,replace=F))
random_sample_R021<- which(complete_R021$run_index%in%sample(rep(1:500), 15, replace=F))
random_sample_R025<- which(complete_R025$run_index%in%sample(rep(1:500), 15, replace = F))


incident_symptomatic_wide<- as.data.frame(cbind(median_incident_symptomatic_R017[,1],
                            apply(median_incident_symptomatic_R017[,-1],1,sum),
                            apply(median_incident_symptomatic_R021[,-1],1,sum),
                            apply(median_incident_symptomatic_R025[,-1],1,sum)))

colnames(incident_symptomatic_wide)<- c("Day", "R_0=1.7,Median", "R_0=2.1,Median", "R_0=2.5,Median") 

random_sims<- as.data.frame(cbind(combined_incident_R017[random_sample_R017,1],
                                apply(combined_incident_R017[random_sample_R017,-1],1,sum),
                                apply(combined_incident_R021[random_sample_R021,-1],1,sum),
                                apply(combined_incident_R025[random_sample_R021,-1],1,sum)))

colnames(random_sims)<- c("Day","R_0=1.7,Random", "R_0=2.1,Random", "R_0=2.5,Random")


incident_symptomatic_long<- incident_symptomatic_wide%>%
  gather(scenario, incident_symptomatic, "R_0=1.7,Median":"R_0=2.5,Median", factor_key = TRUE)

random_sims_long<- random_sims%>%
  gather(scenario, incident_symptomatic, "R_0=1.7,Random":"R_0=2.5,Random", factor_key=TRUE)


symptomatic_df<- as.data.frame(rbind(incident_symptomatic_long,random_sims_long))

symptomatic_df_sep<- symptomatic_df%>%
  separate(scenario, into=c("scenario", "summary_stat"), sep=",")%>%
  mutate(scenario=ifelse(scenario=="R_0=1.7", "Low Transmission",
                         ifelse(scenario=="R_0=2.1", "Moderate Transmission", "High Transmission")))

which(symptomatic_df_sep$summary_stat=="Random")

plt_incident_cases<- ggplot(symptomatic_df_sep[1096:(1096+365*2),])+ 
  geom_line(aes(y= incident_symptomatic, x=Day,color=summary_stat,linetype=scenario))+
  #geom_ribbon(aes(ymax=upper,ymin=lower,x=Day,fill=scenario), alpha=.5) +
  labs(title="Incident Symptomatic Cases Per Day",y="Median Number of Cases") +
  labs(color="Scenario") 



```

Figure 2: 

```{r, message=FALSE, warning=FALSE, echo=TRUE}
#incident_cases_R017_100<- apply(data_combined_cats_median_R017_100,1,sum)
incident_hosp_R017_75<- apply(counts_array_median_R017_75[,,2],1,sum)
#incident_cases_R017_50<- apply(data_combined_cats_median_R017_50,1,sum)
#incident_cases_R021_100<- apply(data_combined_cats_median_R021_100,1,sum)
incident_hosp_R021_75<- apply(counts_array_median_R021_75[,,2],1,sum)
#incident_cases_R021_50<- apply(data_combined_cats_median_R021_50,1,sum)
#incident_cases_R025_100<- apply(data_combined_cats_median_R025_100,1,sum)
incident_hosp_R025_75<- apply(counts_array_median_R025_75[,,2],1,sum)
#incident_cases_R025_50<- apply(data_combined_cats_median_R025_50,1,sum)
incident_hosp_lower_R017_75<- apply(counts_array_IQR_lower_R017_75[,,2],1,sum)
incident_hosp_upper_R017_75<- apply(counts_array_IQR_upper_R017_75[,,2],1,sum)
incident_hosp_lower_R021_75<- apply(counts_array_IQR_lower_R021_75[,,2],1,sum)
incident_hosp_upper_R021_75<- apply(counts_array_IQR_upper_R021_75[,,2],1,sum)
incident_hosp_lower_R025_75<- apply(counts_array_IQR_lower_R025_75[,,2],1,sum)
incident_hosp_upper_R025_75<- apply(counts_array_IQR_upper_R025_75[,,2],1,sum)

wide_hosp_cases<- as.data.frame(cbind(rep(1:length(incident_hosp_R017_75)),
                      incident_hosp_R017_75,incident_hosp_R021_75,incident_hosp_R025_75))
                      
wide_bounds_lower<- as.data.frame(cbind(rep(1:length(incident_hosp_R017_75)),
                        incident_hosp_lower_R017_75,
                        incident_hosp_lower_R021_75,
                        incident_hosp_lower_R025_75))

wide_bounds_upper<- as.data.frame(cbind(rep(1:length(incident_hosp_R017_75)),
                    incident_hosp_upper_R017_75,incident_hosp_upper_R021_75,
                    incident_hosp_upper_R025_75))
colnames(wide_hosp_cases)<- c("Day","R_0=1.7","R_0=2.1","R_0=2.5")

colnames(wide_bounds_lower)<- c("Day","lower_R_0=1.7","lower_R_0=2.1", "lower_R_0=2.5")

colnames(wide_bounds_upper)<- c("Day","upper_R_0=1.7","upper_R_0=2.1","upper_R_0=2.5")

long_incident_cases<- gather(wide_hosp_cases,scenario, incident_cases,
                             "R_0=1.7":"R_0=2.5", factor_key=TRUE)

long_bounds_lower<- gather(wide_bounds_lower,scenario, incident_lower,
                     "lower_R_0=1.7":"lower_R_0=2.5")
long_bounds_upper<- gather(wide_bounds_upper,scenario, incident_upper,
                     "upper_R_0=1.7":"upper_R_0=2.5")

combined_long_matrix<- as.data.frame(cbind(long_incident_cases,long_bounds_lower$incident_lower,
                                           long_bounds_upper$incident_upper))

colnames(combined_long_matrix)<- c("Day", "scenario","incident_cases","lower","upper")

combined_long_matrix<-combined_long_matrix%>%
  mutate(lower=ifelse(incident_cases==0,0,lower)) %>%
  dplyr::mutate(scenario=recode(scenario, 
                                "R_0=1.7"="Low transmission",
                                "R_0=2.1"="Moderate transmission",
                                "R_0=2.5"="High transmission"))%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=length(incident_hosp_R017_75)),times=3))

plt_hosp_cases <- ggplot(combined_long_matrix)+ 
  geom_line(aes(y= incident_cases, x=Day,color=scenario))+
  geom_ribbon(aes(ymax=upper,ymin=lower,x=Day,fill=scenario), alpha=.5) +
  labs(title="Incident Hospitalizations Per Day", y="Median Number of Hospitalized Cases") +
  labs(color="Scenario", fill="Scenario") 

plt_hosp_cases


```


Figure 3:
```{r, message=FALSE, warning=FALSE, echo=FALSE}
#incident_cases_R017_100<- apply(data_combined_cats_median_R017_100,1,sum)
incident_death_R017_75<- apply(counts_array_median_R017_75[,,5],1,sum)
#incident_cases_R017_50<- apply(data_combined_cats_median_R017_50,1,sum)
#incident_cases_R021_100<- apply(data_combined_cats_median_R021_100,1,sum)
incident_death_R021_75<- apply(counts_array_median_R021_75[,,5],1,sum)
#incident_cases_R021_50<- apply(data_combined_cats_median_R021_50,1,sum)
#incident_cases_R025_100<- apply(data_combined_cats_median_R025_100,1,sum)
incident_death_R025_75<- apply(counts_array_median_R025_75[,,5],1,sum)
#incident_cases_R025_50<- apply(data_combined_cats_median_R025_50,1,sum)
incident_death_lower_R017_75<- apply(counts_array_IQR_lower_R017_75[,,5],1,sum)
incident_death_upper_R017_75<- apply(counts_array_IQR_upper_R017_75[,,5],1,sum)
incident_death_lower_R021_75<- apply(counts_array_IQR_lower_R021_75[,,5],1,sum)
incident_death_upper_R021_75<- apply(counts_array_IQR_upper_R021_75[,,5],1,sum)
incident_death_lower_R025_75<- apply(counts_array_IQR_lower_R025_75[,,5],1,sum)
incident_death_upper_R025_75<- apply(counts_array_IQR_upper_R025_75[,,5],1,sum)

wide_death_cases<- as.data.frame(cbind(rep(1:length(incident_death_R017_75)),
                      incident_death_R017_75,incident_death_R021_75,incident_death_R025_75))
                      
wide_bounds_lower<- as.data.frame(cbind(rep(1:length(incident_death_R017_75)),
                        incident_death_lower_R017_75,
                        incident_death_lower_R021_75,
                        incident_death_lower_R025_75))

wide_bounds_upper<- as.data.frame(cbind(rep(1:length(incident_death_R017_75)),
                    incident_death_upper_R017_75,incident_death_upper_R021_75,
                    incident_death_upper_R025_75))
colnames(wide_death_cases)<- c("Day","R_0=1.7","R_0=2.1","R_0=2.5")

colnames(wide_bounds_lower)<- c("Day","lower_R_0=1.7","lower_R_0=2.1", "lower_R_0=2.5")

colnames(wide_bounds_upper)<- c("Day","upper_R_0=1.7","upper_R_0=2.1","upper_R_0=2.5")

long_incident_cases<- gather(wide_death_cases,scenario, incident_cases,
                             "R_0=1.7":"R_0=2.5", factor_key=TRUE)

long_bounds_lower<- gather(wide_bounds_lower,scenario, incident_lower,
                     "lower_R_0=1.7":"lower_R_0=2.5")
long_bounds_upper<- gather(wide_bounds_upper,scenario, incident_upper,
                     "upper_R_0=1.7":"upper_R_0=2.5")

combined_long_matrix<- as.data.frame(cbind(long_incident_cases,long_bounds_lower$incident_lower,
                                           long_bounds_upper$incident_upper))

colnames(combined_long_matrix)<- c("Day", "scenario","incident_cases","lower","upper")

combined_long_matrix<-combined_long_matrix%>%
  mutate(lower=ifelse(incident_cases==0,0,lower)) %>%
  dplyr::mutate(scenario=recode(scenario, 
                                "R_0=1.7"="Low transmission",
                                "R_0=2.1"="Moderate transmission",
                                "R_0=2.5"="High transmission"))%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=length(incident_death_R017_75)),times=3))




plt_death_cases<- ggplot(combined_long_matrix)+ 
  geom_line(aes(y= incident_cases, x=Day,color=scenario))+
  geom_ribbon(aes(ymax=upper,ymin=lower,x=Day,fill=scenario), alpha=.5) +
  labs(title="Incident Deaths Per Day", y="Median Number of Deaths") +
  labs(color="Scenario", fill="Scenario") 

plt_death_cases

```


Figure 4: 

```{r, message=FALSE, warning=FALSE, echo=TRUE}

cumulative_symptomatic_cases_R017<- matrix(NA, nrow(data_combined_cats_median_R017_75), ncol=ncol(data_combined_cats_median_R017_75))

for(i in 1:ncol(cumulative_symptomatic_cases_R017)){
  cumulative_symptomatic_cases_R017[1,i]<- data_combined_cats_median_R017_75[1,i]
  for(j in 2:nrow(cumulative_symptomatic_cases_R017)){
    cumulative_symptomatic_cases_R017[j,i]<- cumulative_symptomatic_cases_R017[(j-1),i]+data_combined_cats_median_R017_75[(j),i]
  }
}


cumulative_symptomatic_cases_R021<- matrix(NA, nrow(data_combined_cats_median_R021_75), ncol=ncol(data_combined_cats_median_R021_75))

for(i in 1:ncol(cumulative_symptomatic_cases_R021)){
  cumulative_symptomatic_cases_R021[1,i]<- data_combined_cats_median_R021_75[1,i]
  for(j in 2:nrow(cumulative_symptomatic_cases_R021)){
    cumulative_symptomatic_cases_R021[j,i]<- cumulative_symptomatic_cases_R021[(j-1),i]+data_combined_cats_median_R021_75[(j),i]
  }
}

cumulative_symptomatic_cases_R025<- matrix(NA, nrow(data_combined_cats_median_R025_75), ncol=ncol(data_combined_cats_median_R025_75))

for(i in 1:ncol(cumulative_symptomatic_cases_R025)){
  cumulative_symptomatic_cases_R025[1,i]<- data_combined_cats_median_R025_75[1,i]
  for(j in 2:nrow(cumulative_symptomatic_cases_R025)){
    cumulative_symptomatic_cases_R025[j,i]<- cumulative_symptomatic_cases_R025[(j-1),i]+data_combined_cats_median_R025_75[(j),i]
  }
}

cumulative_symptomatic_cases<- as.data.frame(cbind(rep(1:nrow(data_combined_cats_median_R017_75)),
                                              apply(cumulative_symptomatic_cases_R017,1,sum),
                                              apply(cumulative_symptomatic_cases_R021,1,sum),
                                              apply(cumulative_symptomatic_cases_R025,1,sum)))

colnames(cumulative_symptomatic_cases)<- c("Day", "R_0=1.7","R_0=2.1", "R_0=2.5")

cumulative_symptomatic_cases_long<- gather(cumulative_symptomatic_cases, scenario, num_cases,
                                           "R_0=1.7":"R_0=2.5",factor_key=TRUE)



plt_cumulative_symptomatic<- ggplot(cumulative_symptomatic_cases_long)+
  geom_line(aes(x= Day, y= num_cases, color=scenario))+
  labs(y="Number of Symptomatic Cases", title="Median Number of Symptomatic Cases")

#plt_cumulative_symptomatic

######################


cumulative_hosp_cases<- as.data.frame(cbind(rep(1:nrow(data_combined_cats_median_R017_75)),
                                              apply(cumulative_array_median_R017_75[,,1],1,sum),
                                              apply(cumulative_array_median_R021_75[,,1],1,sum),
                                              apply(cumulative_array_median_R025_75[,,1],1,sum)))

colnames(cumulative_hosp_cases)<- c("Day", "R_0=1.7","R_0=2.1", "R_0=2.5")

cumulative_hosp_cases_long<- gather(cumulative_hosp_cases, scenario, num_cases,
                                           "R_0=1.7":"R_0=2.5",factor_key=TRUE)

cumulative_hosp_cases_long<-cumulative_hosp_cases_long%>%
dplyr::mutate(scenario=recode(scenario, 
                                "R_0=1.7"="Low transmission",
                                "R_0=2.1"="Moderate transmission",
                                "R_0=2.5"="High transmission"))%>%
mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(data_combined_cats_median_R017_75)),times=3))
  
plt_cumulative_hosp<- ggplot(cumulative_hosp_cases_long)+
  geom_line(aes(x= Day, y= num_cases, color=str_wrap(scenario,10)))+
  labs(y="Number of Hospitalizations", title="Cumulative Hospitalizations") + labs(color="Scenario")

plt_A <- plt_cumulative_hosp

#############################

cumulative_hosp_cases_R017<- as.data.frame(cbind(rep(1:nrow(data_combined_cats_median_R017_75)),
                                              cumulative_array_median_R017_75[,,1]))

colnames(cumulative_hosp_cases_R017)<- c("Day","Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless" )

cumulative_hosp_R017_long<- gather(cumulative_hosp_cases_R017, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)


cumulative_hosp_R017_long<- cumulative_hosp_R017_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(data_combined_cats_median_R017_75)),times=7))

plt_cumulative_hosp_R017<- ggplot(cumulative_hosp_R017_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of Hospitalizations", title="Low transmission") + ylim(0,2000) + labs(color="Age group")

plt_B <- plt_cumulative_hosp_R017


cumulative_hosp_cases_R021<- as.data.frame(cbind(rep(1:nrow(data_combined_cats_median_R021_75)),
                                              cumulative_array_median_R021_75[,,1]))

colnames(cumulative_hosp_cases_R021)<- c("Day","Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless" )

cumulative_hosp_R021_long<- gather(cumulative_hosp_cases_R021, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

cumulative_hosp_R021_long<- cumulative_hosp_R021_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(data_combined_cats_median_R017_75)),times=7))


plt_cumulative_hosp_R021<- ggplot(cumulative_hosp_R021_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of Hospitalizations", title="Moderate transmission") + ylim(0,2000) + labs(color="Age group")

plt_C <- plt_cumulative_hosp_R021

cumulative_hosp_cases_R025<- as.data.frame(cbind(rep(1:nrow(data_combined_cats_median_R025_75)),
                                              cumulative_array_median_R025_75[,,1]))

colnames(cumulative_hosp_cases_R025)<- c("Day","Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless" )

cumulative_hosp_R025_long<- gather(cumulative_hosp_cases_R025, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

cumulative_hosp_R025_long<- cumulative_hosp_R025_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(data_combined_cats_median_R017_75)),times=7))


plt_cumulative_hosp_R025<- ggplot(cumulative_hosp_R025_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of Hospitalizations", title="High transmission") + ylim(0,2000) + labs(color="Age group")

plt_D <- plt_cumulative_hosp_R025

plt1 <- cowplot::plot_grid(plt_B, plt_C, plt_D, labels=c('B','C','D'), align = "h", ncol=3)
plt <- cowplot::plot_grid(plt_A, plt1, labels=c('A',''), align = "h", nrow=2)
print(plt)

```

New(but actually old) figure 5:
```{r, message=FALSE, warning=FALSE, echo=TRUE}
#cumulative cases (symptomatic)
#cumulative sum of incident cases for each of the 500 sims
daily_incident_cases<- matrix(NA,nrow(combined_incident_R017),ncol=4)

daily_incident_cases[,1]<- combined_incident_R017[,1]
daily_incident_cases[,2]<- apply(combined_incident_R017[,-1],1,sum)
daily_incident_cases[,3]<- apply(combined_incident_R021[,-1],1,sum)
daily_incident_cases[,4]<- apply(combined_incident_R025[,-1],1,sum)

cumulative_cases_symptomatic<- matrix(NA, nrow(daily_incident_cases), ncol(daily_incident_cases))
cumulative_cases_symptomatic[,1]<- combined_incident_R017[,1]
cumulative_cases_symptomatic[which(cumulative_cases_symptomatic[,1]==1),]<- 
  daily_incident_cases[which(daily_incident_cases[,1]==1),]
for(i in 2:365){
  for(j in 2: ncol(daily_incident_cases)){
    cumulative_cases_symptomatic[which(cumulative_cases_symptomatic[,1]==i),j]<-
      cumulative_cases_symptomatic[which(cumulative_cases_symptomatic[,1]==(i-1)),j]+
      daily_incident_cases[which(daily_incident_cases[,1]==i),j]
  }
  
}

median_cumulative_cases_symptomatic<- matrix(NA, 365, ncol= 4)

median_cumulative_cases_symptomatic[,1]<- rep(1:365)
for(i in 1:nrow(median_cumulative_cases_symptomatic)){
  median_cumulative_cases_symptomatic[i,-1]<- 
    apply(cumulative_cases_symptomatic[which(cumulative_cases_symptomatic[,1]==i),-1],2,median)
}

cumulative_cases_symptomatic<- as.data.frame(median_cumulative_cases_symptomatic)
colnames(cumulative_cases_symptomatic)<- c("Day", "Low Transmission",
                                          "Moderate Transmission", "High Transmission")

cumulative_cases_symptomatic_long<- cumulative_cases_symptomatic%>%
  gather(scenario, cumulative_cases, "Low Transmission": "High Transmission", factor_key = T)%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by="day", length.out = 365),3))



cumulative_symptomatic_cases_plt<- ggplot(cumulative_cases_symptomatic_long)+
  geom_line(aes(x=Day, y= cumulative_cases, color=scenario))+
  labs(y="Median Cumulative Symptomatic Cases", title= "Median Cumulative Symptomatic Cases")

#cumulative deaths
cumulative_deaths<- as.data.frame(cbind(rep(1:nrow(cumulative_array_R017[,,5])),
                    apply(cumulative_array_R017[,-1,5],1,sum),
                    apply(cumulative_array_R021[,-1,5],1,sum),
                    apply(cumulative_array_R025[,-1,5],1,sum)))


median_cumulative_deaths<- matrix(NA, 365, 4)
median_cumulative_deaths[,1]<- rep(1:365)
for(i in 1:nrow(median_cumulative_deaths)){

    median_cumulative_deaths[i,-1]<- 
      apply(cumulative_deaths[which(cumulative_deaths[,1]==i),-1],2,median)
  
}

colnames(median_cumulative_deaths)<- c("Day", "Low Transmission", "Moderate Transmission", 
                                       "High Transmission")

median_cumulative_deaths<- as.data.frame(median_cumulative_deaths)

median_cumulative_deaths_long<- median_cumulative_deaths%>%
  gather(scenario, cumulative_death, "Low Transmission": "High Transmission", factor_key = T)%>%
   mutate(Day= rep(seq(as.Date('2020/03/1'),by="day", length.out = 365),3))


cumulative_deaths_plot<- ggplot(median_cumulative_deaths_long)+
  geom_line(aes(x=Day, y= cumulative_death, color=scenario))+
  labs(y= "Median Deaths", "Median Deaths")

```

Figure 5:

```{r, message=FALSE, echo=TRUE, message=FALSE}

cumulative_deaths<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,5])),
                    apply(cumulative_array_median_R017_75[,,5],1,sum),
                    apply(cumulative_array_median_R021_75[,,5],1,sum),
                    apply(cumulative_array_median_R025_75[,,5],1,sum)))



colnames(cumulative_deaths)<- c("Day","R_0=1.7","R_0=2.1","R_0=2.5")



long_cumulative_deaths<- gather(cumulative_deaths,scenario, num_cases,
                             "R_0=1.7":"R_0=2.5", factor_key=TRUE)


long_cumulative_deaths<- long_cumulative_deaths%>%
  dplyr::mutate(scenario=recode(scenario, 
                "R_0=1.7"="Low transmission",
                "R_0=2.1"="Moderate transmission",
                "R_0=2.5"="High transmission"))%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(cumulative_array_median_R017_75[,,5])),times=3))


plt_cumulative_death<- ggplot(long_cumulative_deaths)+ 
  geom_line(aes(y= num_cases, x=Day,color=str_wrap(scenario,10)))+
  labs(title="Cumulative Deaths",
       y="Number of Deaths") + labs(color="Scenario") + labs(color="Scenario")

plt_A <- plt_cumulative_death

#######################


cumulative_deaths_R_017<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,5])),
                                        cumulative_array_median_R017_75[,,5]))


colnames(cumulative_deaths_R_017)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_deaths_R_017_long<- gather(cumulative_deaths_R_017, age_group, cumulative_deaths,
                                      "Age0-19":"Homeless",factor_key=TRUE)

cumulative_deaths_R_017_long<- cumulative_deaths_R_017_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(cumulative_array_median_R017_75[,,5])),times=7))


plt_cumulative_death_by_R_017<- ggplot(cumulative_deaths_R_017_long)+
  geom_line(aes(x=Day,y=cumulative_deaths,color=age_group))+
  labs(y="Number of Deaths", title="Low transmission") + labs(color="Age group") + ylim(0,560)


plt_B <- plt_cumulative_death_by_R_017


######################

cumulative_deaths_R_021<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,5])),
                                        cumulative_array_median_R021_75[,,5]))


colnames(cumulative_deaths_R_021)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_deaths_R_021_long<- gather(cumulative_deaths_R_021, age_group, cumulative_deaths,
                                      "Age0-19":"Homeless",factor_key=TRUE)

cumulative_deaths_R_021_long<- cumulative_deaths_R_021_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(data_combined_cats_median_R017_75[,,5])),times=7))


plt_cumulative_death_by_R_021<- ggplot(cumulative_deaths_R_021_long)+
  geom_line(aes(x=Day,y=cumulative_deaths,color=age_group))+
  labs(y="Number of Deaths", title="Moderate transmission") + labs(color="Age group") + ylim(0,560)

plt_C <- plt_cumulative_death_by_R_021

###########################


cumulative_deaths_R_025<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,5])),
                                        cumulative_array_median_R025_75[,,5]))


colnames(cumulative_deaths_R_025)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_deaths_R_025_long<- gather(cumulative_deaths_R_025, age_group, cumulative_deaths,
                                      "Age0-19":"Homeless",factor_key=TRUE)

cumulative_deaths_R_025_long<- cumulative_deaths_R_025_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(data_combined_cats_median_R017_75[,,5])),times=7))


plt_cumulative_death_by_R_025<- ggplot(cumulative_deaths_R_025_long)+
  geom_line(aes(x=Day,y=cumulative_deaths,color=age_group))+
  labs(y="Number of Deaths", title="High transmission") + labs(color="Age group") + ylim(0,560)

plt_D <- plt_cumulative_death_by_R_025

plt1 <- cowplot::plot_grid(plt_B, plt_C, plt_D, labels=c('B','C','D'), align = "h", ncol=3)
plt <- cowplot::plot_grid(plt_A, plt1, labels=c('A',''), align = "h", nrow=2)
print(plt)
```

Figure 6: 

```{r, warning=FALSE, message=FALSE, echo=TRUE}

cumulative_hosp_R_017<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,2])),
                                        cumulative_array_median_R017_75[,,2]))


colnames(cumulative_hosp_R_017)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_hosp_R_017_long<- gather(cumulative_hosp_R_017, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

cumulative_hosp_R_017_long<- cumulative_hosp_R_017_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(cumulative_array_median_R017_75[,,5])),times=7))


plt_cumulative_hosp_by_R_017<- ggplot(cumulative_hosp_R_017_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of hospital beds in use per day", title="Low transmission") + ylim(0,360) + labs(color="Age group")

plt_A<-plt_cumulative_hosp_by_R_017

cumulative_hosp_R_021<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R021_75[,,2])),
                                        cumulative_array_median_R021_75[,,2]))


colnames(cumulative_hosp_R_021)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_hosp_R_021_long<- gather(cumulative_hosp_R_021, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

cumulative_hosp_R_021_long<- cumulative_hosp_R_021_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(cumulative_array_median_R017_75[,,5])),times=7))



plt_cumulative_hosp_by_R_021<- ggplot(cumulative_hosp_R_021_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of hospital beds in use per day", title="Moderate transmission") + ylim(0,360) + labs(color="Age group")

plt_B<-plt_cumulative_hosp_by_R_021

cumulative_hosp_R_025<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R025_75[,,2])),
                                        cumulative_array_median_R025_75[,,2]))


colnames(cumulative_hosp_R_025)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_hosp_R_025_long<- gather(cumulative_hosp_R_025, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

cumulative_hosp_R_025_long<- cumulative_hosp_R_025_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(cumulative_array_median_R017_75[,,5])),times=7))


plt_cumulative_hosp_by_R_025<- ggplot(cumulative_hosp_R_025_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of hospital beds in use per day", title="High transmission") + ylim(0,360) + labs(color="Age group")

plt_C<-plt_cumulative_hosp_by_R_025

############
cumulative_ICU_R_017<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,3])),
                                        cumulative_array_median_R017_75[,,3]))


colnames(cumulative_ICU_R_017)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_ICU_R_017_long<- gather(cumulative_ICU_R_017, age_group, cumulative_ICU,
                                      "Age0-19":"Homeless",factor_key=TRUE)

cumulative_ICU_R_017_long<- cumulative_ICU_R_017_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(cumulative_array_median_R017_75[,,5])),times=7))


plt_cumulative_ICU_by_R_017<- ggplot(cumulative_ICU_R_017_long)+
  geom_line(aes(x=Day,y=cumulative_ICU,color=age_group))+
  labs(y="Number of ICU beds in use per day", title="Low transmission") + ylim(0,200) + labs(color="Age group")

plt_D<-plt_cumulative_ICU_by_R_017

cumulative_ICU_R_021<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R021_75[,,3])),
                                        cumulative_array_median_R021_75[,,3]))


colnames(cumulative_ICU_R_021)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_ICU_R_021_long<- gather(cumulative_ICU_R_021, age_group, cumulative_ICU,
                                      "Age0-19":"Homeless",factor_key=TRUE)


cumulative_ICU_R_021_long<- cumulative_ICU_R_021_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(cumulative_array_median_R017_75[,,5])),times=7))


plt_cumulative_ICU_by_R_021<- ggplot(cumulative_ICU_R_021_long)+
  geom_line(aes(x=Day,y=cumulative_ICU,color=age_group))+
  labs(y="Number of ICU beds in use per day", title="Moderate transmission") + ylim(0,200) + labs(color="Age group")

plt_E<-plt_cumulative_ICU_by_R_021


cumulative_ICU_R_025<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R025_75[,,3])),
                                        cumulative_array_median_R025_75[,,3]))


colnames(cumulative_ICU_R_025)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_ICU_R_025_long<- gather(cumulative_ICU_R_025, age_group, cumulative_ICU,
                                      "Age0-19":"Homeless",factor_key=TRUE)


cumulative_ICU_R_025_long<- cumulative_ICU_R_025_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(cumulative_array_median_R017_75[,,5])),times=7))


plt_cumulative_ICU_by_R_025<- ggplot(cumulative_ICU_R_025_long)+
  geom_line(aes(x=Day,y=cumulative_ICU,color=age_group))+
  labs(y="Number of ICU beds in use per day", title="High transmission") + ylim(0,200) + labs(color="Age group")

plt_F<-plt_cumulative_ICU_by_R_025
##################

cumulative_vent_R_017<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,4])),
                                        cumulative_array_median_R017_75[,,4]))


colnames(cumulative_vent_R_017)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_vent_R_017_long<- gather(cumulative_vent_R_017, age_group, cumulative_vent,
                                      "Age0-19":"Homeless",factor_key=TRUE)


cumulative_vent_R_017_long<- cumulative_vent_R_017_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(cumulative_array_median_R017_75[,,5])),times=7))


plt_cumulative_vent_by_R_017<- ggplot(cumulative_vent_R_017_long)+
  geom_line(aes(x=Day,y=cumulative_vent,color=age_group))+
  labs(y="Number of vents in use per day", title="Low transmission") + ylim(0,150) + labs(color="Age group")

plt_G <-plt_cumulative_vent_by_R_017

cumulative_vent_R_021<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R021_75[,,4])),
                                        cumulative_array_median_R021_75[,,4]))


colnames(cumulative_vent_R_021)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_vent_R_021_long<- gather(cumulative_vent_R_021, age_group, cumulative_vent,
                                      "Age0-19":"Homeless",factor_key=TRUE)
cumulative_vent_R_021_long<- cumulative_vent_R_021_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(cumulative_array_median_R017_75[,,5])),times=7))

plt_cumulative_vent_by_R_021<- ggplot(cumulative_vent_R_021_long)+
  geom_line(aes(x=Day,y=cumulative_vent,color=age_group))+
  labs(y="Number of vents in use per day", title="Moderate transmission") + ylim(0,150) + labs(color="Age group")

plt_H <-plt_cumulative_vent_by_R_021

cumulative_vent_R_025<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R025_75[,,4])),
                                        cumulative_array_median_R025_75[,,4]))


colnames(cumulative_vent_R_025)<- c('Day', "Age0-19",
                                      "Age20-34", "Age35-59", "Age60-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_vent_R_025_long<- gather(cumulative_vent_R_025, age_group, cumulative_vent,
                                      "Age0-19":"Homeless",factor_key=TRUE)
cumulative_vent_R_025_long<- cumulative_vent_R_025_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(cumulative_array_median_R017_75[,,5])),times=7))


plt_cumulative_vent_by_R_025<- ggplot(cumulative_vent_R_025_long)+
  geom_line(aes(x=Day,y=cumulative_vent,color=age_group))+
  labs(y="Number of vents in use per day", title="High transmission") + ylim(0,150) + labs(color="Age group")

plt_I <- plt_cumulative_vent_by_R_025

plt <- cowplot::plot_grid(plt_A, plt_B, plt_C, plt_D, plt_E, plt_F, plt_G, plt_H, plt_I, labels=c('A', 'B','C','D','E','F','G','H','I'), align = "h", nrow=3)
print(plt)


```


Figure 4 and 5 combined across ages:

```{r, message=FALSE, warning=FALSE, echo=TRUE}

cumulative_hosp<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,2])),
                                      apply(cumulative_array_median_R017_75[,,2],1,sum),
                                      apply(cumulative_array_median_R021_75[,,2],1,sum),
                                      apply(cumulative_array_median_R025_75[,,2],1,sum)))


colnames(cumulative_hosp)<- c('Day', "R_0=1.7",
                                      "R_0=2.1", "R_0=2.5")

cumulative_hosp_long<- gather(cumulative_hosp, scenario, cumulative_hosp,
                                      "R_0=1.7":"R_0=2.5",factor_key=TRUE)

cumulative_hosp_long<- cumulative_hosp_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(cumulative_array_median_R017_75[,,2])),times=3))


plt_cumulative_hosp<- ggplot(cumulative_hosp_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=scenario))+
  labs(y="Number of hospital beds in use per day", title="Daily Hospital Bed Use") + labs(color="Age group")

pltA<- plt_cumulative_hosp

###########################

cumulative_ICU<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,3])),
                                      apply(cumulative_array_median_R017_75[,,3],1,sum),
                                      apply(cumulative_array_median_R021_75[,,3],1,sum),
                                      apply(cumulative_array_median_R025_75[,,3],1,sum)))


colnames(cumulative_ICU)<- c('Day', "R_0=1.7",
                                      "R_0=2.1", "R_0=2.5")

cumulative_ICU_long<- gather(cumulative_ICU, scenario, cumulative_ICU,
                                      "R_0=1.7":"R_0=2.5",factor_key=TRUE)

cumulative_ICU_long<- cumulative_ICU_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(cumulative_array_median_R017_75[,,3])),times=3))


plt_cumulative_ICU<- ggplot(cumulative_ICU_long)+
  geom_line(aes(x=Day,y=cumulative_ICU,color=scenario))+
  labs(y="Number of ICU beds in use per day", title="Daily ICU Bed Use") + labs(color="Age group")

pltB<- plt_cumulative_ICU

############################

cumulative_vent<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,4])),
                                      apply(cumulative_array_median_R017_75[,,4],1,sum),
                                      apply(cumulative_array_median_R021_75[,,4],1,sum),
                                      apply(cumulative_array_median_R025_75[,,4],1,sum)))


colnames(cumulative_vent)<- c('Day', "R_0=1.7",
                                      "R_0=2.1", "R_0=2.5")

cumulative_vent_long<- gather(cumulative_vent, scenario, cumulative_vent_use,
                                      "R_0=1.7":"R_0=2.5",factor_key=TRUE)

cumulative_vent_long<- cumulative_vent_long%>%
  mutate(Day= rep(seq(as.Date('2020/03/1'),by='day', 
                      length.out=nrow(cumulative_array_median_R017_75[,,3])),times=3))


plt_cumulative_vent<- ggplot(cumulative_vent_long)+
  geom_line(aes(x=Day,y=cumulative_vent_use,color=scenario))+
  labs(y="Number of Vents in use per day", title="Daily Vent Use") + labs(color="Age group")

pltC<- plt_cumulative_vent


```



Table 1:
```{r, message=FALSE, echo=TRUE, warning=FALSE}

wide_incident_cases<- t(as.data.frame(cbind(incident_cases_R017_75,incident_cases_R021_75,
                                            incident_cases_R025_75)))
                      
wide_incident_lowbound<- t(as.data.frame(cbind(incident_cases_lower_R017_75,
                      incident_cases_lower_R021_75,incident_cases_lower_R025_75)))
                      
wide_incident_upbound<- t(as.data.frame(cbind(incident_cases_upper_R017_75,
                      incident_cases_upper_R021_75,incident_cases_upper_R025_75)))
                                      
                                      



wide_hosp_cases<- t(as.data.frame(cbind(apply(cumulative_array_median_R017_75[,,2],1,sum),
                    apply(cumulative_array_median_R021_75[,,2],1,sum),
                    apply(cumulative_array_median_R025_75[,,2],1,sum))))
                      
wide_hosp_lowbound<- t(as.data.frame(cbind(apply(cumulative_array_IQR_lower_R017_75[,,2],1,sum),
                      apply(cumulative_array_IQR_lower_R021_75[,,2],1,sum),
                      apply(cumulative_array_IQR_lower_R025_75[,,2],1,sum))))
                      
wide_hosp_upbound<- t(as.data.frame(cbind(apply(cumulative_array_IQR_upper_R017_75[,,2],1,sum),
                      apply(cumulative_array_IQR_upper_R021_75[,,2],1,sum),
                      apply(cumulative_array_IQR_upper_R025_75[,,2],1,sum))))



wide_ICU_cases<- t(as.data.frame(cbind(apply(cumulative_array_median_R017_75[,,3],1,sum),
                    apply(cumulative_array_median_R021_75[,,3],1,sum),
                    apply(cumulative_array_median_R025_75[,,3],1,sum))))
                      
wide_ICU_lowbound<- t(as.data.frame(cbind(apply(cumulative_array_IQR_lower_R017_75[,,3],1,sum),
                      apply(cumulative_array_IQR_lower_R021_75[,,3],1,sum),
                      apply(cumulative_array_IQR_lower_R025_75[,,3],1,sum))))
                      
wide_ICU_upbound<- t(as.data.frame(cbind(apply(cumulative_array_IQR_upper_R017_75[,,3],1,sum),
                      apply(cumulative_array_IQR_upper_R021_75[,,3],1,sum),
                      apply(cumulative_array_IQR_upper_R025_75[,,3],1,sum))))




wide_vent_cases<- t(as.data.frame(cbind(apply(cumulative_array_median_R017_75[,,4],1,sum),
                    apply(cumulative_array_median_R021_75[,,4],1,sum),
                    apply(cumulative_array_median_R025_75[,,4],1,sum))))
                      
wide_vent_lowbound<- t(as.data.frame(cbind(apply(cumulative_array_IQR_lower_R017_75[,,4],1,sum),
                      apply(cumulative_array_IQR_lower_R021_75[,,4],1,sum),
                      apply(cumulative_array_IQR_lower_R025_75[,,4],1,sum))))
                      
wide_vent_upbound<- t(as.data.frame(cbind(apply(cumulative_array_IQR_upper_R017_75[,,4],1,sum),
                      apply(cumulative_array_IQR_upper_R021_75[,,4],1,sum),
                      apply(cumulative_array_IQR_upper_R025_75[,,4],1,sum))))



wide_death_cases<- t(as.data.frame(cbind(apply(cumulative_array_median_R017_75[,,5],1,sum),
                    apply(cumulative_array_median_R021_75[,,5],1,sum),
                    apply(cumulative_array_median_R025_75[,,5],1,sum))))
                      
wide_death_lowbound<- t(as.data.frame(cbind(apply(cumulative_array_IQR_lower_R017_75[,,5],1,sum),
                      apply(cumulative_array_IQR_lower_R021_75[,,5],1,sum),
                      apply(cumulative_array_IQR_lower_R025_75[,,5],1,sum))))
                      
wide_death_upbound<- t(as.data.frame(cbind(apply(cumulative_array_IQR_upper_R017_75[,,5],1,sum),
                      apply(cumulative_array_IQR_upper_R021_75[,,5],1,sum),
                      apply(cumulative_array_IQR_upper_R025_75[,,5],1,sum))))

max_date_may<- which(wide_hosp_cases[3,]==max(wide_hosp_cases[3,61:91]))
max_date_june<- which(wide_hosp_cases[3,]==max(wide_hosp_cases[3,92:121]))
max_date_july<- which(wide_hosp_cases[3,]==max(wide_hosp_cases[3,122:152]))
max_date_august<- which(wide_hosp_cases[3,]==max(wide_hosp_cases[3,153:183]))



cumulative_time_groups <- rbind(cbind(wide_incident_cases[,max_date_may],
                        wide_incident_lowbound[,max_date_may],wide_incident_upbound[,max_date_may],
                        wide_incident_cases[,max_date_june],wide_incident_lowbound[,max_date_june],
                        wide_incident_upbound[,max_date_june],wide_incident_cases[,max_date_july],
                        wide_incident_lowbound[,max_date_july],wide_incident_upbound[,max_date_july],
                        wide_incident_cases[,max_date_august],wide_incident_lowbound[,max_date_august],
                        wide_incident_upbound[,max_date_august]),
                        cbind(wide_hosp_cases[,max_date_may],wide_hosp_lowbound[,max_date_may],
                        wide_hosp_upbound[,max_date_may],wide_hosp_cases[,max_date_june],
                        wide_hosp_lowbound[,max_date_june],wide_hosp_upbound[,max_date_june],
                        wide_hosp_cases[,max_date_july],wide_hosp_lowbound[,max_date_july],
                        wide_hosp_upbound[,max_date_july],wide_hosp_cases[,max_date_august],
                        wide_hosp_lowbound[,max_date_august],wide_hosp_upbound[,max_date_august]),
                        cbind(wide_ICU_cases[,max_date_may],wide_ICU_lowbound[,max_date_may],
                        wide_ICU_upbound[,max_date_may],wide_ICU_cases[,max_date_june],
                        wide_ICU_lowbound[,max_date_june],wide_ICU_upbound[,max_date_june],
                        wide_ICU_cases[,max_date_july],wide_ICU_lowbound[,max_date_july],
                        wide_ICU_upbound[,max_date_july],wide_ICU_cases[,max_date_august],
                        wide_ICU_lowbound[,max_date_august],wide_ICU_upbound[,max_date_august]),
                        cbind(wide_vent_cases[,max_date_may],wide_vent_lowbound[,max_date_may],
                        wide_vent_upbound[,max_date_may],wide_vent_cases[,max_date_june],
                        wide_vent_lowbound[,max_date_june],wide_vent_upbound[,max_date_june],
                        wide_vent_cases[,max_date_july],wide_vent_lowbound[,max_date_july],
                        wide_vent_upbound[,max_date_july],wide_vent_cases[,max_date_august],
                        wide_vent_lowbound[,max_date_august],wide_vent_upbound[,max_date_august]),
                        cbind(wide_death_cases[,max_date_may],wide_death_lowbound[,max_date_may],
                        wide_death_upbound[,max_date_may],wide_death_cases[,max_date_june],
                        wide_death_lowbound[,max_date_june],wide_death_upbound[,max_date_june],
                        wide_death_cases[,max_date_july],wide_death_lowbound[,max_date_july],
                        wide_death_upbound[,max_date_july],wide_death_cases[,max_date_august],
                        wide_death_lowbound[,max_date_august],wide_death_upbound[,max_date_august]))


dim(cumulative_time_groups)

colnames(cumulative_time_groups)<- c("Median","25th","75th",
                                     "Median ","25th ", "75th ", 
                                     "Median  ","25th  ", "75th  ",
                                     "Median   ", "25th   ", "75th   ")

rownames(cumulative_time_groups)<- c("R_0=1.7","R_0=2.1","R_0=2.5","R_0=1.7 ",
                                     "R_0=2.1 ","R_0=2.5 ",
                                     "R_0=1.7  ",
                                     "R_0=2.1  ","R_0=2.5  ",
                                     "R_0=1.7   ","R_0=2.1   ","R_0=2.5   ",
                                     "R_0=1.7     ","R_0=2.1     ","R_0=2.5     ")
mode(cumulative_time_groups)<-"integer"

cumulative_time_groups<- as.data.frame(cumulative_time_groups)

kable(cumulative_time_groups)%>%
  kable_styling()%>%
  pack_rows("Symptomatic Infections",1,3)%>%
  pack_rows("Hospitalizations",4,6)%>%
  pack_rows("ICU Beds",7,9)%>%
  pack_rows("Vents",10,12)%>%
  pack_rows("Death",13,15)%>%
  add_header_above(c(" "=1, "May, 2020"=3, "June, 2020"=3, "July, 2020"=3, "August, 2020"=3))

```


Table 2: 

```{r, message=FALSE, warning=FALSE, echo=TRUE}


wide_incident_cases<- t(as.data.frame(cbind(data_combined_cats_median_R017_75,
                                            data_combined_cats_median_R021_75,
                                            data_combined_cats_median_R025_75)))
                      
wide_incident_lowbound<- t(as.data.frame(cbind(data_combined_cats_IQR_lower_R017_75,
                                               data_combined_cats_IQR_lower_R021_75,
                                               data_combined_cats_IQR_lower_R021_75)))

wide_incident_upbound<- t(as.data.frame(cbind(data_combined_cats_IQR_upper_R017_75,
                                               data_combined_cats_IQR_upper_R021_75,
                                               data_combined_cats_IQR_upper_R021_75)))                               
                                      



wide_hosp_cases<- t(as.data.frame(cbind(cumulative_array_median_R017_75[,,2],
                    cumulative_array_median_R021_75[,,2],
                    cumulative_array_median_R025_75[,,2])))
                      
wide_hosp_lowbound<- t(as.data.frame(cbind(cumulative_array_IQR_lower_R017_75[,,2],
                      cumulative_array_IQR_lower_R021_75[,,2],
                      cumulative_array_IQR_lower_R025_75[,,2])))
                      
wide_hosp_upbound<- t(as.data.frame(cbind(cumulative_array_IQR_upper_R017_75[,,2],
                      cumulative_array_IQR_upper_R021_75[,,2],
                      cumulative_array_IQR_upper_R025_75[,,2])))



wide_ICU_cases<- t(as.data.frame(cbind(cumulative_array_median_R017_75[,,3],
                    cumulative_array_median_R021_75[,,3],
                    cumulative_array_median_R025_75[,,3])))
                      
wide_ICU_lowbound<- t(as.data.frame(cbind(cumulative_array_IQR_lower_R017_75[,,3],
                      cumulative_array_IQR_lower_R021_75[,,3],
                      cumulative_array_IQR_lower_R025_75[,,3])))
                      
wide_ICU_upbound<- t(as.data.frame(cbind(cumulative_array_IQR_upper_R017_75[,,3],
                      cumulative_array_IQR_upper_R021_75[,,3],
                      cumulative_array_IQR_upper_R025_75[,,3])))




wide_vent_cases<- t(as.data.frame(cbind(cumulative_array_median_R017_75[,,4],
                    cumulative_array_median_R021_75[,,4],
                    cumulative_array_median_R025_75[,,4])))
                      
wide_vent_lowbound<- t(as.data.frame(cbind(cumulative_array_IQR_lower_R017_75[,,4],
                      cumulative_array_IQR_lower_R021_75[,,4],
                      cumulative_array_IQR_lower_R025_75[,,4])))
                      
wide_vent_upbound<- t(as.data.frame(cbind(cumulative_array_IQR_upper_R017_75[,,4],
                      cumulative_array_IQR_upper_R021_75[,,4],
                      cumulative_array_IQR_upper_R025_75[,,4])))



wide_death_cases<- t(as.data.frame(cbind(cumulative_array_median_R017_75[,,5],
                    cumulative_array_median_R021_75[,,5],
                    cumulative_array_median_R025_75[,,5])))
                      
wide_death_lowbound<- t(as.data.frame(cbind(cumulative_array_IQR_lower_R017_75[,,5],
                      cumulative_array_IQR_lower_R021_75[,,5],
                      cumulative_array_IQR_lower_R025_75[,,5])))
                      
wide_death_upbound<- t(as.data.frame(cbind(cumulative_array_IQR_upper_R017_75[,,5],
                      cumulative_array_IQR_upper_R021_75[,,5],
                      cumulative_array_IQR_upper_R025_75[,,5])))



cumulative_time_groups <- rbind(cbind(wide_incident_cases[,max_date_may],
                        wide_incident_lowbound[,max_date_may],wide_incident_upbound[,max_date_may],
                        wide_incident_cases[,max_date_june],wide_incident_lowbound[,max_date_june],
                        wide_incident_upbound[,max_date_june],wide_incident_cases[,max_date_july],
                        wide_incident_lowbound[,max_date_july],wide_incident_upbound[,max_date_july],
                        wide_incident_cases[,max_date_august],wide_incident_lowbound[,max_date_august],
                        wide_incident_upbound[,max_date_august]),
                        cbind(wide_hosp_cases[,max_date_may],wide_hosp_lowbound[,max_date_may],
                        wide_hosp_upbound[,max_date_may],wide_hosp_cases[,max_date_june],
                        wide_hosp_lowbound[,max_date_june],wide_hosp_upbound[,max_date_june],
                        wide_hosp_cases[,max_date_july],wide_hosp_lowbound[,max_date_july],
                        wide_hosp_upbound[,max_date_july],wide_hosp_cases[,max_date_august],
                        wide_hosp_lowbound[,max_date_august],wide_hosp_upbound[,max_date_august]),
                        cbind(wide_ICU_cases[,max_date_may],wide_ICU_lowbound[,max_date_may],
                        wide_ICU_upbound[,max_date_may],wide_ICU_cases[,max_date_june],
                        wide_ICU_lowbound[,max_date_june],wide_ICU_upbound[,max_date_june],
                        wide_ICU_cases[,max_date_july],wide_ICU_lowbound[,max_date_july],
                        wide_ICU_upbound[,max_date_july],wide_ICU_cases[,max_date_august],
                        wide_ICU_lowbound[,max_date_august],wide_ICU_upbound[,max_date_august]),
                        cbind(wide_vent_cases[,max_date_may],wide_vent_lowbound[,max_date_may],
                        wide_vent_upbound[,max_date_may],wide_vent_cases[,max_date_june],
                        wide_vent_lowbound[,max_date_june],wide_vent_upbound[,max_date_june],
                        wide_vent_cases[,max_date_july],wide_vent_lowbound[,max_date_july],
                        wide_vent_upbound[,max_date_july],wide_vent_cases[,max_date_august],
                        wide_vent_lowbound[,max_date_august],wide_vent_upbound[,max_date_august]),
                        cbind(wide_death_cases[,max_date_may],wide_death_lowbound[,max_date_may],
                        wide_death_upbound[,max_date_may],wide_death_cases[,max_date_june],
                        wide_death_lowbound[,max_date_june],wide_death_upbound[,max_date_june],
                        wide_death_cases[,max_date_july],wide_death_lowbound[,max_date_july],
                        wide_death_upbound[,max_date_july],wide_death_cases[,max_date_august],
                        wide_death_lowbound[,max_date_august],wide_death_upbound[,max_date_august]))


dim(cumulative_time_groups)

colnames(cumulative_time_groups)<- c("Median","25th","75th",
                                     "Median ","25th ", "75th ", 
                                     "Median  ","25th  ", "75th  ",
                                     "Median   ", "25th   ", "75th   ")

rownames(cumulative_time_groups)<-c("Age 0-19","Age 20-34","Age 35-59","Age60-74",
                                    "Age 75+","HCW","Homeless",
                                    "Age 0-19 ","Age 20-34 ","Age 35-59 ","Age60-74 ",
                                    "Age 75+ ","HCW ","Homeless ",
                                    "Age 0-19  ","Age 20-34  ","Age 35-59  ","Age60-74  ",
                                    "Age 75+  ","HCW  ","Homeless  ",
                                    "Age 0-19   ","Age 20-34   ","Age 35-59   ","Age60-74   ",
                                    "Age 75+   ","HCW   ","Homeless   ",
                                    "Age 0-19    ","Age 20-34    ","Age 35-59    ","Age60-74    ",
                                    "Age 75+    ","HCW    ","Homeless    ",
                                    "Age 0-19     ","Age 20-34     ","Age 35-59     ","Age60-74     ",
                                    "Age 75+     ","HCW     ","Homeless     ",
                                    "Age 0-19      ","Age 20-34      ","Age 35-59      ","Age60-74      ",
                                    "Age 75+      ","HCW      ","Homeless      ",
                                    "Age 0-19       ","Age 20-34       ","Age 35-59       ","Age60-74       ",
                                    "Age 75+       ","HCW       ","Homeless       ",
                                    "Age 0-19        ","Age 20-34        ","Age 35-59        ","Age60-74        ",
                                    "Age 75+        ","HCW        ","Homeless        ",
                                    "Age 0-19         ","Age 20-34         ","Age 35-59         ","Age60-74         ",
                                    "Age 75+         ","HCW         ","Homeless         ",
                                    "Age 0-19          ","Age 20-34          ","Age 35-59          ","Age60-74          ",
                                    "Age 75+          ","HCW          ","Homeless          ",
                                    "Age 0-19           ","Age 20-34           ","Age 35-59           ","Age60-74           ",
                                    "Age 75+           ","HCW           ","Homeless           ",
                                    "Age 0-19            ","Age 20-34            ","Age 35-59            ","Age60-74            ",
                                    "Age 75+            ","HCW            ","Homeless            ",
                                    "Age 0-19             ","Age 20-34             ","Age 35-59             ","Age60-74             ",
                                    "Age 75+             ","HCW             ","Homeless             ",
                                    "Age 0-19              ","Age 20-34              ","Age 35-59              ","Age60-74              ",
                                    "Age 75+              ","HCW              ","Homeless               ")
mode(cumulative_time_groups)<-"integer"

cumulative_time_groups<- as.data.frame(cumulative_time_groups)

kable(cumulative_time_groups)%>%
  kable_styling()%>%
  pack_rows("Symptomatic Infections, R_0=1.7",1,7)%>%
  pack_rows("Symptomatic Infections, R_0=2.1",8,14)%>%
  pack_rows("Symptomatic Infections, R_0=2.5",15,21)%>%
  pack_rows("Hospitalizations, R_0=1.7",22,28)%>%
  pack_rows("Hospitalizations, R_0=2.1",29,35)%>%
  pack_rows("Hospitalizations, R_0=2.5",36,42)%>%
  pack_rows("ICU Beds, R_0=1.7",43,49)%>%
  pack_rows("ICU Beds, R_0=2.1",50,56)%>%
  pack_rows("ICU Beds, R_0=2.5",57,63)%>%
  pack_rows("Vents, R_0=1.7",64,70)%>%
  pack_rows("Vents, R_0=2.1",71,77)%>%
  pack_rows("Vents, R_0=2.5",78,84)%>%
  pack_rows("Death, R_0=1.7",85,91)%>%
  pack_rows("Death, R_0=2.1",92,98)%>%
   pack_rows("Death, R_0=2.5",99,105)%>%
  add_header_above(c(" "=1, "May, 2020"=3, "June, 2020"=3, "July, 2020"=3, "August, 2020"=3))



```
