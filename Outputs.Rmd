---
knit: (function(inputFile, encoding) { 
          rmarkdown::render(inputFile,
                        encoding=encoding, 
                output_file='Outputs.html') })
---

# Planning for COVID-19
## Baltimore City

Prepared by [Johns Hopkins ID Dynamics](https://iddynamics.jhsph.edu/) Working Group  
Updated `r Sys.Date()`

**THIS IS FOR PLANNING PURPOSES AND IS NOT A FORECAST.**

```{r setup, include=FALSE, eval=TRUE}
options(tinytex.verbose = TRUE, scipen = 999)
knitr::opts_chunk$set(echo = FALSE, cache = FALSE, warning=FALSE, message=FALSE, fig.align="center")
```

```{r captioner, include=FALSE, eval=TRUE}
library(captioner)
tab_nums <- captioner(prefix = "Table ", auto_space = FALSE)
fig_nums <- captioner(prefix = "Figure ", auto_space = FALSE)
```

```{r data, include=FALSE, eval=TRUE}

setwd("~/Dropbox/Postdoc/COVID19/COVID-BaltimoreCity/Output_20200322_v2")

require(socialmixr)
require(xlsx)
require(magrittr)
require(stringr)
require(reshape2)
require(dplyr)
require(ggplot2) 
require(tidyr)
require(xtable)
require(kableExtra)
require(cowplot)
require(tidyverse)
require(gridExtra)

#load in data, subset incident cases/day (eventually should be symptomatic incident cases)
data_infected_R017_100<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r017__100.csv")
data_infected_R017_75<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r017__75.csv")
data_infected_R017_50<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r017__50.csv")
data_infected_R021_100<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r021__100.csv")
data_infected_R021_75<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r021__75.csv")
data_infected_R021_50<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r021__50.csv")
data_infected_R025_100<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r025__100.csv")
data_infected_R025_75<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r025__75.csv")
data_infected_R025_50<- read.csv("SUMMARY_INCIDENCE_SEIR_results__n500__r025__50.csv")


#calculate bounds on IQR, we are sticking with just 75 contact, since they are so similar. 

complete_infected_R017_75<- read.csv("SEIR_results__n500__r017__75.csv")
complete_infected_R021_75<- read.csv("SEIR_results__n500__r021__75.csv")
complete_infected_R025_75<- read.csv("SEIR_results__n500__r025__75.csv")

complete_incident_R017_75<- complete_infected_R017_75%>%
  select(time,incid_I1,incid_I2,incid_I3,incid_I4,incid_I5,
         incid_I6,incid_I7,incid_I8,incid_I9,
         incid_I10,incid_I11,incid_I12,incid_I13,incid_I14)

complete_incident_R021_75<- complete_infected_R021_75%>%
  select(time,incid_I1,incid_I2,incid_I3,incid_I4,incid_I5,
         incid_I6,incid_I7,incid_I8,incid_I9,
         incid_I10,incid_I11,incid_I12,incid_I13,incid_I14)

complete_incident_R025_75<- complete_infected_R025_75%>%
  select(time,incid_I1,incid_I2,incid_I3,incid_I4,incid_I5,
         incid_I6,incid_I7,incid_I8,incid_I9,
         incid_I10,incid_I11,incid_I12,incid_I13,incid_I14)

#each day calculate the upper and lower bound of the IQR.
#upper: 
IQR_upper_R017_75<- matrix(NA,365,14)
for(i in 1:nrow(IQR_upper_R017_75)){

    IQR_upper_R017_75[i,]<-
      apply(complete_incident_R017_75[which(complete_incident_R017_75$time==i),2:15]
                                  ,2,quantile,probs=c(0.75),na.rm=TRUE)
  
}

IQR_upper_R021_75<- matrix(NA,365,14)
for(i in 1:nrow(IQR_upper_R021_75)){

    IQR_upper_R021_75[i,]<-
      apply(complete_incident_R021_75[which(complete_incident_R021_75$time==i),2:15]
                                  ,2,quantile,probs=c(0.75),na.rm=TRUE)
  
}

IQR_upper_R025_75<- matrix(NA,365,14)
for(i in 1:nrow(IQR_upper_R025_75)){

    IQR_upper_R025_75[i,]<-
      apply(complete_incident_R025_75[which(complete_incident_R025_75$time==i),2:15]
                                  ,2,quantile,probs=c(0.75),na.rm=TRUE)
  
}
################
#lower: 
IQR_lower_R017_75<- matrix(NA,365,14)
for(i in 1:nrow(IQR_lower_R017_75)){

    IQR_lower_R017_75[i,]<-
      apply(complete_incident_R017_75[which(complete_incident_R017_75$time==i),2:15]
                                  ,2,quantile,probs=c(0.25),na.rm=TRUE)
  
}

IQR_lower_R021_75<- matrix(NA,365,14)
for(i in 1:nrow(IQR_lower_R021_75)){

    IQR_lower_R021_75[i,]<-
      apply(complete_incident_R021_75[which(complete_incident_R021_75$time==i),2:15]
                                  ,2,quantile,probs=c(0.25),na.rm=TRUE)
  
}

IQR_lower_R025_75<- matrix(NA,365,14)
for(i in 1:nrow(IQR_lower_R025_75)){

    IQR_lower_R025_75[i,]<-
      apply(complete_incident_R025_75[which(complete_incident_R025_75$time==i),2:15]
                                  ,2,quantile,probs=c(0.25),na.rm=TRUE)
  
}



```


```{r, include=FALSE, eval=TRUE}

data_incident_median_R017_100<- data_infected_R017_100%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R017_100<- data_infected_R017_100%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R017_100<- data_infected_R017_100%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R017_100<- data_infected_R017_100%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)

##########################
data_incident_median_R017_75<- data_infected_R017_75%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R017_75<- data_infected_R017_75%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R017_75<- data_infected_R017_75%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R017_75<- data_infected_R017_75%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)
###########################
data_incident_median_R017_50<- data_infected_R017_50%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R017_50<- data_infected_R017_50%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R017_50<- data_infected_R017_50%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R017_50<- data_infected_R017_50%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)
############################
data_incident_median_R021_100<- data_infected_R021_100%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R021_100<- data_infected_R021_100%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R021_100<- data_infected_R021_100%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R021_100<- data_infected_R021_100%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)
############################
data_incident_median_R021_75<- data_infected_R021_75%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R021_75<- data_infected_R021_75%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R021_75<- data_infected_R021_75%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R021_75<- data_infected_R021_75%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)
##############################
data_incident_median_R021_50<- data_infected_R021_50%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R021_50<- data_infected_R021_50%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R021_50<- data_infected_R021_50%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R021_50<- data_infected_R021_50%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)

#############################
data_incident_median_R025_100<- data_infected_R025_100%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R025_100<- data_infected_R025_100%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R025_100<- data_infected_R025_100%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R025_100<- data_infected_R025_100%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)
#############################
data_incident_median_R025_75<- data_infected_R025_75%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R025_75<- data_infected_R025_75%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R025_75<- data_infected_R025_75%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R025_75<- data_infected_R025_75%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)
###############################
data_incident_median_R025_50<- data_infected_R025_50%>%
  select(incid_I1_median,incid_I2_median,incid_I3_median,incid_I4_median,incid_I5_median,
         incid_I6_median,incid_I7_median,incid_I8_median,incid_I9_median,
         incid_I10_median,incid_I11_median,incid_I12_median,incid_I13_median,incid_I14_median)

data_incident_mean_R025_50<- data_infected_R025_50%>%
  select(incid_I1_mean,incid_I2_mean,incid_I3_mean,incid_I4_mean,incid_I5_mean,
         incid_I6_mean,incid_I7_mean,incid_I8_mean,incid_I9_mean,incid_I10_mean,
         incid_I11_mean,incid_I12_mean,incid_I13_mean,incid_I14_mean)

data_incident_upper_R025_50<- data_infected_R025_50%>%
  select(incid_I1_Q4,incid_I2_Q4,incid_I3_Q4,incid_I4_Q4,incid_I5_Q4,incid_I6_Q4,incid_I7_Q4,
         incid_I8_Q4,incid_I9_Q4,incid_I10_Q4,incid_I11_Q4,incid_I12_Q4,incid_I13_Q4,incid_I14_Q4)

data_incident_lower_R025_50<- data_infected_R025_50%>%
  select(incid_I1_Q1,incid_I2_Q1,incid_I3_Q1,incid_I4_Q1,incid_I5_Q1,incid_I6_Q1,incid_I7_Q1,
         incid_I8_Q1,incid_I9_Q1,incid_I10_Q1,incid_I11_Q1,incid_I12_Q1,incid_I13_Q1,incid_I14_Q1)

#consolidate age categories, 1-4 is now cat1, 5-6 is now cat2, 7-9 is now cat3, 10 is cat 4, 11 is cat5, 12 is cat 6, HCW is cat 7, homeless is cat 8 


data_incident_median_R017_100<- data_incident_median_R017_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R017_100<- data_incident_mean_R017_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R017_100<- data_incident_upper_R017_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R017_100<- data_incident_lower_R017_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))

####################################

data_incident_median_R017_75<- data_incident_median_R017_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R017_75<- data_incident_mean_R017_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R017_75<- data_incident_upper_R017_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R017_75<- data_incident_lower_R017_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))
#######################################

data_incident_median_R017_50<- data_incident_median_R017_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R017_50<- data_incident_mean_R017_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R017_50<- data_incident_upper_R017_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R017_50<- data_incident_lower_R017_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))
########################################

data_incident_median_R021_100<- data_incident_median_R021_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R021_100<- data_incident_mean_R021_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R021_100<- data_incident_upper_R021_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R021_100<- data_incident_lower_R021_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))
########################################

data_incident_median_R021_75<- data_incident_median_R021_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R021_75<- data_incident_mean_R021_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R021_75<- data_incident_upper_R021_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R021_75<- data_incident_lower_R021_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))

########################################

data_incident_median_R021_50<- data_incident_median_R021_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R021_50<- data_incident_mean_R021_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R021_50<- data_incident_upper_R021_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R021_50<- data_incident_lower_R021_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))
#########################################

data_incident_median_R025_100<- data_incident_median_R025_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R025_100<- data_incident_mean_R025_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R025_100<- data_incident_upper_R025_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R025_100<- data_incident_lower_R025_100%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))
###########################################

data_incident_median_R025_75<- data_incident_median_R025_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R025_75<- data_incident_mean_R025_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R025_75<- data_incident_upper_R025_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R025_75<- data_incident_lower_R025_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))
#####################################

data_incident_median_R025_50<- data_incident_median_R025_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_mean_R025_50<- data_incident_mean_R025_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_upper_R025_50<- data_incident_upper_R025_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


data_incident_lower_R025_50<- data_incident_lower_R025_50%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))
##############################################

IQR_lower_R017_75<- as.data.frame(IQR_lower_R017_75)
data_incident_IQR_lower_R017_75<- IQR_lower_R017_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))

IQR_lower_R021_75<- as.data.frame(IQR_lower_R021_75)
data_incident_IQR_lower_R021_75<- IQR_lower_R021_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))

IQR_lower_R025_75<- as.data.frame(IQR_lower_R025_75)
data_incident_IQR_lower_R025_75<- IQR_lower_R025_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))
########################################

IQR_upper_R017_75<- as.data.frame(IQR_upper_R017_75)
data_incident_IQR_upper_R017_75<- IQR_upper_R017_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))

IQR_upper_R021_75<- as.data.frame(IQR_upper_R021_75)
data_incident_IQR_upper_R021_75<- IQR_upper_R021_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))

IQR_upper_R025_75<- as.data.frame(IQR_upper_R025_75)
data_incident_IQR_upper_R025_75<- IQR_upper_R025_75%>%
  mutate(cat1=rowSums(.[1:4]))%>%
  mutate(cat2=rowSums(.[5:7]))%>%
  mutate(cat3=rowSums(.[8]))%>%
  mutate(cat4=rowSums(.[9:11]))%>%
  mutate(cat5=rowSums(.[12]))%>%
  mutate(cat6=rowSums(.[13]))%>%
  mutate(cat7=rowSums(.[14]))


########################################
data_combined_cats_median_R017_100<- data_incident_median_R017_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R017_100<- data_incident_mean_R017_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R017_100<- data_incident_upper_R017_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R017_100<- data_incident_lower_R017_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)
#########################################
data_combined_cats_median_R017_75<- data_incident_median_R017_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R017_75<- data_incident_mean_R017_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R017_75<- data_incident_upper_R017_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R017_75<- data_incident_lower_R017_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_IQR_lower_R017_75<- data_incident_IQR_lower_R017_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_IQR_upper_R017_75<- data_incident_IQR_upper_R017_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)
####################################
data_combined_cats_median_R017_50<- data_incident_median_R017_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R017_50<- data_incident_mean_R017_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R017_50<- data_incident_upper_R017_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R017_50<- data_incident_lower_R017_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)
#####################################
data_combined_cats_median_R021_100<- data_incident_median_R021_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R021_100<- data_incident_mean_R021_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R021_100<- data_incident_upper_R021_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R021_100<- data_incident_lower_R021_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)
#####################################
data_combined_cats_median_R021_75<- data_incident_median_R021_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R021_75<- data_incident_mean_R021_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R021_75<- data_incident_upper_R021_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R021_75<- data_incident_lower_R021_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_IQR_lower_R021_75<- data_incident_IQR_lower_R021_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_IQR_upper_R021_75<- data_incident_IQR_upper_R021_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)
#######################################
data_combined_cats_median_R021_50<- data_incident_median_R021_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R021_50<- data_incident_mean_R021_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R021_50<- data_incident_upper_R021_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R021_50<- data_incident_lower_R021_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)
#######################################
data_combined_cats_median_R025_100<- data_incident_median_R025_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R025_100<- data_incident_mean_R025_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R025_100<- data_incident_upper_R025_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R025_100<- data_incident_lower_R025_100%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)
########################################
data_combined_cats_median_R025_75<- data_incident_median_R025_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R025_75<- data_incident_mean_R025_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R025_75<- data_incident_upper_R025_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R025_75<- data_incident_lower_R025_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_IQR_lower_R025_75<- data_incident_IQR_lower_R025_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_IQR_upper_R025_75<- data_incident_IQR_upper_R025_75%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)
##########################################
data_combined_cats_median_R025_50<- data_incident_median_R025_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_mean_R025_50<- data_incident_mean_R025_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_upper_R025_50<- data_incident_upper_R025_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)

data_combined_cats_lower_R025_50<- data_incident_lower_R025_50%>%
  select(cat1,cat2,cat3,cat4,cat5,cat6,cat7)



```



This report compares the health impact and surge capacity needs for the 2020 COVID-19 epidemic in Baltimore City across three different transmission scenarios. We use an age-structured SEIR model to predict the number of incident cases within age groups, and among healthcare workers and the homeless population. To estimate surge capacity needs, we use our best understanding of the natural history of SARS-CoV-2. Given our uncertainty of the true number of existing cases and that we are in the early stages of the epidemic, **the aim of this model is not to forecast the epidemic but rather to provide estimates of the course of the epidemic in Baltimore City under a specific set of assumptions for planning purposes**. 

We make the following assumptions:

(1) We seed the epidemic with 8 asymptomatic cases and 2 symptomatic cases and assume the age structure of Baltimore City using data from the U.S. Census. 
(2) Using age-specific data from the National Center for Health Statistics on hypertension, diabetes, and cancer we assume the percentage of incident cases that become severe is roughly an average of the percentage of people that have any of the above co-morbidities.
(3) We assume 100% of severe cases get hospitalized.
(4) Using current estimates from the CDC, we assume age-specific probabilities of getting moved to ICU if hospitalized (https://www.cdc.gov/mmwr/volumes/69/wr/mm6912e2.htm#T1_down). 
(5) Using current statistics from the WHO, we assume 25% of cases in ICU across age groups get put on a ventilator.
(6) Based on expert clinical opinion and similar estimates used in Great Britain, we assume 50% of those on a ventilator die and an age-dependent proportion of those that do not require a ventilator die (calculated to match the CDC age-specific CFR).
(7) We assume healthcare workers and those who are homeless have the same hospitalization, ICU, ventilator probabilities as those in the 45-54 age category. 


```{r, include=FALSE, eval=TRUE}

#working probabilities for severe cases, hospitalization, ICU, vent and death. 
#these are nested conditional probabilities, and they rely on the following  assumptions: 
#the percentage of severe cases in each categories is obtained from CDC table where we combined the 55-74 age groups and the 75-80 and 80+ age groups. 
#we assume now that 100% of severe cases get hospitalized (this could be adjusted)
# the remainder of the nested probabilities come from the CDC table, instead of using the denominator as all the cases in that age group, we shift the denoinator to be the preceding categoriy of sverity so prob ICU is the number of icu cases for that age group/ number of hospitalized cases for that age group. 

#HCW workers and homeless have the same nested prob scheme as the 45-540y.o group.
prob_severe<- c(0.02, 0.029, 0.066, 0.088,0.364,0.066,0.066)

prob_hospitalized<- rep(1,ncol(data_combined_cats_median_R017_100))

prob_ICU<- c(0,0.2,0.367,0.4,0.465,0.367,0.367)

prob_vent<-c(0,0.238,0.288,0.467,0.8,0.288,0.288)

prob_death<-c(0,0.2,0.267,0.536,0.788,0.267,0.267)

prob_matrix<- cbind(prob_severe,prob_hospitalized,prob_ICU,
                    prob_vent,prob_death)



```


```{r, include=FALSE, eval=TRUE}
#calculate number of incident cases that get classified as severe, of those, 
#the number get hospitalized (currently 100%), of that then those that get classified as ICU and then of those that get put on a vent and of those the ones that die 11 days later (11 day lag for death prob)
#this is for each age group (+ HCW and homeless)
#note this categorization is NOT a disease progression, a person gets assigned based on the worst state they could possibly reach. 


counts_array_median_R017_100<- array(NA, dim=c(nrow(data_combined_cats_median_R017_100),ncol(data_combined_cats_median_R017_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R017_100)){
  for(i in 1:nrow(data_combined_cats_median_R017_100)){
      counts_array_median_R017_100[i,j,1]<- data_combined_cats_median_R017_100[i,j]*prob_matrix[j,1]
      counts_array_median_R017_100[i,j,2]<- counts_array_median_R017_100[i,j,1]*prob_matrix[j,2]
      counts_array_median_R017_100[i,j,3]<- counts_array_median_R017_100[i,j,2]*prob_matrix[j,3]
      counts_array_median_R017_100[i,j,4]<- counts_array_median_R017_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R017_100)){
    if(k<=11){
      counts_array_median_R017_100[k,j,5]<- 0
    }
    else{
      counts_array_median_R017_100[k,j,5]<- counts_array_median_R017_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R017_100<- array(NA, dim=c(nrow(data_combined_cats_mean_R017_100),ncol(data_combined_cats_mean_R017_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R017_100)){
  for(i in 1:nrow(data_combined_cats_mean_R017_100)){
      counts_array_mean_R017_100[i,j,1]<- data_combined_cats_mean_R017_100[i,j]*prob_matrix[j,1]
      counts_array_mean_R017_100[i,j,2]<- counts_array_mean_R017_100[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R017_100[i,j,3]<- counts_array_mean_R017_100[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R017_100[i,j,4]<- counts_array_mean_R017_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R017_100)){
    if(k<=11){
      counts_array_mean_R017_100[k,j,5]<- 0
    }
    else{
      counts_array_mean_R017_100[k,j,5]<- counts_array_mean_R017_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R017_100<- array(NA, dim=c(nrow(data_combined_cats_upper_R017_100),ncol(data_combined_cats_upper_R017_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R017_100)){
  for(i in 1:nrow(data_combined_cats_upper_R017_100)){
      counts_array_upper_R017_100[i,j,1]<- data_combined_cats_upper_R017_100[i,j]*prob_matrix[j,1]
      counts_array_upper_R017_100[i,j,2]<- counts_array_upper_R017_100[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R017_100[i,j,3]<- counts_array_upper_R017_100[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R017_100[i,j,4]<- counts_array_upper_R017_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R017_100)){
    if(k<=11){
      counts_array_upper_R017_100[k,j,5]<- 0
    }
    else{
      counts_array_upper_R017_100[k,j,5]<- counts_array_upper_R017_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R017_100<- array(NA, dim=c(nrow(data_combined_cats_lower_R017_100),ncol(data_combined_cats_lower_R017_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R017_100)){
  for(i in 1:nrow(data_combined_cats_lower_R017_100)){
      counts_array_lower_R017_100[i,j,1]<- data_combined_cats_lower_R017_100[i,j]*prob_matrix[j,1]
      counts_array_lower_R017_100[i,j,2]<- counts_array_lower_R017_100[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R017_100[i,j,3]<- counts_array_lower_R017_100[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R017_100[i,j,4]<- counts_array_lower_R017_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R017_100)){
    if(k<=11){
      counts_array_lower_R017_100[k,j,5]<- 0
    }
    else{
      counts_array_lower_R017_100[k,j,5]<- counts_array_lower_R017_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}
#################################################



counts_array_median_R017_75<- array(NA, dim=c(nrow(data_combined_cats_median_R017_75),ncol(data_combined_cats_median_R017_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R017_75)){
  for(i in 1:nrow(data_combined_cats_median_R017_75)){
      counts_array_median_R017_75[i,j,1]<- data_combined_cats_median_R017_75[i,j]*prob_matrix[j,1]
      counts_array_median_R017_75[i,j,2]<- counts_array_median_R017_75[i,j,1]*prob_matrix[j,2]
      counts_array_median_R017_75[i,j,3]<- counts_array_median_R017_75[i,j,2]*prob_matrix[j,3]
      counts_array_median_R017_75[i,j,4]<- counts_array_median_R017_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R017_75)){
    if(k<=11){
      counts_array_median_R017_75[k,j,5]<- 0
    }
    else{
      counts_array_median_R017_75[k,j,5]<- counts_array_median_R017_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R017_75<- array(NA, dim=c(nrow(data_combined_cats_mean_R017_75),ncol(data_combined_cats_mean_R017_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R017_75)){
  for(i in 1:nrow(data_combined_cats_mean_R017_75)){
      counts_array_mean_R017_75[i,j,1]<- data_combined_cats_mean_R017_75[i,j]*prob_matrix[j,1]
      counts_array_mean_R017_75[i,j,2]<- counts_array_mean_R017_75[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R017_75[i,j,3]<- counts_array_mean_R017_75[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R017_75[i,j,4]<- counts_array_mean_R017_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R017_75)){
    if(k<=11){
      counts_array_mean_R017_75[k,j,5]<- 0
    }
    else{
      counts_array_mean_R017_75[k,j,5]<- counts_array_mean_R017_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R017_75<- array(NA, dim=c(nrow(data_combined_cats_upper_R017_75),ncol(data_combined_cats_upper_R017_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R017_75)){
  for(i in 1:nrow(data_combined_cats_upper_R017_75)){
      counts_array_upper_R017_75[i,j,1]<- data_combined_cats_upper_R017_75[i,j]*prob_matrix[j,1]
      counts_array_upper_R017_75[i,j,2]<- counts_array_upper_R017_75[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R017_75[i,j,3]<- counts_array_upper_R017_75[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R017_75[i,j,4]<- counts_array_upper_R017_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R017_75)){
    if(k<=11){
      counts_array_upper_R017_75[k,j,5]<- 0
    }
    else{
      counts_array_upper_R017_75[k,j,5]<- counts_array_upper_R017_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_IQR_upper_R017_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_upper_R017_75),ncol(data_combined_cats_IQR_upper_R017_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_IQR_upper_R017_75)){
  for(i in 1:nrow(data_combined_cats_IQR_upper_R017_75)){
      counts_array_IQR_upper_R017_75[i,j,1]<- data_combined_cats_IQR_upper_R017_75[i,j]*prob_matrix[j,1]
      counts_array_IQR_upper_R017_75[i,j,2]<- counts_array_IQR_upper_R017_75[i,j,1]*prob_matrix[j,2]
      counts_array_IQR_upper_R017_75[i,j,3]<- counts_array_IQR_upper_R017_75[i,j,2]*prob_matrix[j,3]
      counts_array_IQR_upper_R017_75[i,j,4]<- counts_array_IQR_upper_R017_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_IQR_upper_R017_75)){
    if(k<=11){
      counts_array_IQR_upper_R017_75[k,j,5]<- 0
    }
    else{
      counts_array_IQR_upper_R017_75[k,j,5]<- counts_array_IQR_upper_R017_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R017_75<- array(NA, dim=c(nrow(data_combined_cats_lower_R017_75),ncol(data_combined_cats_lower_R017_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R017_75)){
  for(i in 1:nrow(data_combined_cats_lower_R017_75)){
      counts_array_lower_R017_75[i,j,1]<- data_combined_cats_lower_R017_75[i,j]*prob_matrix[j,1]
      counts_array_lower_R017_75[i,j,2]<- counts_array_lower_R017_75[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R017_75[i,j,3]<- counts_array_lower_R017_75[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R017_75[i,j,4]<- counts_array_lower_R017_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R017_75)){
    if(k<=11){
      counts_array_lower_R017_75[k,j,5]<- 0
    }
    else{
      counts_array_lower_R017_75[k,j,5]<- counts_array_lower_R017_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_IQR_lower_R017_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_lower_R017_75),ncol(data_combined_cats_IQR_lower_R017_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_IQR_lower_R017_75)){
  for(i in 1:nrow(data_combined_cats_IQR_lower_R017_75)){
      counts_array_IQR_lower_R017_75[i,j,1]<- data_combined_cats_IQR_lower_R017_75[i,j]*prob_matrix[j,1]
      counts_array_IQR_lower_R017_75[i,j,2]<- counts_array_IQR_lower_R017_75[i,j,1]*prob_matrix[j,2]
      counts_array_IQR_lower_R017_75[i,j,3]<- counts_array_IQR_lower_R017_75[i,j,2]*prob_matrix[j,3]
      counts_array_IQR_lower_R017_75[i,j,4]<- counts_array_IQR_lower_R017_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_IQR_lower_R017_75)){
    if(k<=11){
      counts_array_IQR_lower_R017_75[k,j,5]<- 0
    }
    else{
      counts_array_IQR_lower_R017_75[k,j,5]<- counts_array_IQR_lower_R017_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

################################################################


counts_array_median_R017_50<- array(NA, dim=c(nrow(data_combined_cats_median_R017_50),ncol(data_combined_cats_median_R017_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R017_50)){
  for(i in 1:nrow(data_combined_cats_median_R017_50)){
      counts_array_median_R017_50[i,j,1]<- data_combined_cats_median_R017_50[i,j]*prob_matrix[j,1]
      counts_array_median_R017_50[i,j,2]<- counts_array_median_R017_50[i,j,1]*prob_matrix[j,2]
      counts_array_median_R017_50[i,j,3]<- counts_array_median_R017_50[i,j,2]*prob_matrix[j,3]
      counts_array_median_R017_50[i,j,4]<- counts_array_median_R017_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R017_50)){
    if(k<=11){
      counts_array_median_R017_50[k,j,5]<- 0
    }
    else{
      counts_array_median_R017_50[k,j,5]<- counts_array_median_R017_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R017_50<- array(NA, dim=c(nrow(data_combined_cats_mean_R017_50),ncol(data_combined_cats_mean_R017_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R017_50)){
  for(i in 1:nrow(data_combined_cats_mean_R017_50)){
      counts_array_mean_R017_50[i,j,1]<- data_combined_cats_mean_R017_50[i,j]*prob_matrix[j,1]
      counts_array_mean_R017_50[i,j,2]<- counts_array_mean_R017_50[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R017_50[i,j,3]<- counts_array_mean_R017_50[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R017_50[i,j,4]<- counts_array_mean_R017_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R017_50)){
    if(k<=11){
      counts_array_mean_R017_50[k,j,5]<- 0
    }
    else{
      counts_array_mean_R017_50[k,j,5]<- counts_array_mean_R017_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R017_50<- array(NA, dim=c(nrow(data_combined_cats_upper_R017_50),ncol(data_combined_cats_upper_R017_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R017_50)){
  for(i in 1:nrow(data_combined_cats_upper_R017_50)){
      counts_array_upper_R017_50[i,j,1]<- data_combined_cats_upper_R017_50[i,j]*prob_matrix[j,1]
      counts_array_upper_R017_50[i,j,2]<- counts_array_upper_R017_50[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R017_50[i,j,3]<- counts_array_upper_R017_50[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R017_50[i,j,4]<- counts_array_upper_R017_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R017_50)){
    if(k<=11){
      counts_array_upper_R017_50[k,j,5]<- 0
    }
    else{
      counts_array_upper_R017_50[k,j,5]<- counts_array_upper_R017_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R017_50<- array(NA, dim=c(nrow(data_combined_cats_lower_R017_50),ncol(data_combined_cats_lower_R017_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R017_50)){
  for(i in 1:nrow(data_combined_cats_lower_R017_50)){
      counts_array_lower_R017_50[i,j,1]<- data_combined_cats_lower_R017_50[i,j]*prob_matrix[j,1]
      counts_array_lower_R017_50[i,j,2]<- counts_array_lower_R017_50[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R017_50[i,j,3]<- counts_array_lower_R017_50[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R017_50[i,j,4]<- counts_array_lower_R017_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R017_50)){
    if(k<=11){
      counts_array_lower_R017_50[k,j,5]<- 0
    }
    else{
      counts_array_lower_R017_50[k,j,5]<- counts_array_lower_R017_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


####################################


counts_array_median_R021_100<- array(NA, dim=c(nrow(data_combined_cats_median_R021_100),ncol(data_combined_cats_median_R021_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R021_100)){
  for(i in 1:nrow(data_combined_cats_median_R021_100)){
      counts_array_median_R021_100[i,j,1]<- data_combined_cats_median_R021_100[i,j]*prob_matrix[j,1]
      counts_array_median_R021_100[i,j,2]<- counts_array_median_R021_100[i,j,1]*prob_matrix[j,2]
      counts_array_median_R021_100[i,j,3]<- counts_array_median_R021_100[i,j,2]*prob_matrix[j,3]
      counts_array_median_R021_100[i,j,4]<- counts_array_median_R021_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R021_100)){
    if(k<=11){
      counts_array_median_R021_100[k,j,5]<- 0
    }
    else{
      counts_array_median_R021_100[k,j,5]<- counts_array_median_R021_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R021_100<- array(NA, dim=c(nrow(data_combined_cats_mean_R021_100),ncol(data_combined_cats_mean_R021_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R021_100)){
  for(i in 1:nrow(data_combined_cats_mean_R021_100)){
      counts_array_mean_R021_100[i,j,1]<- data_combined_cats_mean_R021_100[i,j]*prob_matrix[j,1]
      counts_array_mean_R021_100[i,j,2]<- counts_array_mean_R021_100[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R021_100[i,j,3]<- counts_array_mean_R021_100[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R021_100[i,j,4]<- counts_array_mean_R021_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R021_100)){
    if(k<=11){
      counts_array_mean_R021_100[k,j,5]<- 0
    }
    else{
      counts_array_mean_R021_100[k,j,5]<- counts_array_mean_R021_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R021_100<- array(NA, dim=c(nrow(data_combined_cats_upper_R021_100),ncol(data_combined_cats_upper_R021_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R021_100)){
  for(i in 1:nrow(data_combined_cats_upper_R021_100)){
      counts_array_upper_R021_100[i,j,1]<- data_combined_cats_upper_R021_100[i,j]*prob_matrix[j,1]
      counts_array_upper_R021_100[i,j,2]<- counts_array_upper_R021_100[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R021_100[i,j,3]<- counts_array_upper_R021_100[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R021_100[i,j,4]<- counts_array_upper_R021_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R021_100)){
    if(k<=11){
      counts_array_upper_R021_100[k,j,5]<- 0
    }
    else{
      counts_array_upper_R021_100[k,j,5]<- counts_array_upper_R021_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R021_100<- array(NA, dim=c(nrow(data_combined_cats_lower_R021_100),ncol(data_combined_cats_lower_R021_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R021_100)){
  for(i in 1:nrow(data_combined_cats_lower_R021_100)){
      counts_array_lower_R021_100[i,j,1]<- data_combined_cats_lower_R021_100[i,j]*prob_matrix[j,1]
      counts_array_lower_R021_100[i,j,2]<- counts_array_lower_R021_100[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R021_100[i,j,3]<- counts_array_lower_R021_100[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R021_100[i,j,4]<- counts_array_lower_R021_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R021_100)){
    if(k<=11){
      counts_array_lower_R021_100[k,j,5]<- 0
    }
    else{
      counts_array_lower_R021_100[k,j,5]<- counts_array_lower_R021_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

#######################################


counts_array_median_R021_75<- array(NA, dim=c(nrow(data_combined_cats_median_R021_75),ncol(data_combined_cats_median_R021_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R021_75)){
  for(i in 1:nrow(data_combined_cats_median_R021_75)){
      counts_array_median_R021_75[i,j,1]<- data_combined_cats_median_R021_75[i,j]*prob_matrix[j,1]
      counts_array_median_R021_75[i,j,2]<- counts_array_median_R021_75[i,j,1]*prob_matrix[j,2]
      counts_array_median_R021_75[i,j,3]<- counts_array_median_R021_75[i,j,2]*prob_matrix[j,3]
      counts_array_median_R021_75[i,j,4]<- counts_array_median_R021_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R021_75)){
    if(k<=11){
      counts_array_median_R021_75[k,j,5]<- 0
    }
    else{
      counts_array_median_R021_75[k,j,5]<- counts_array_median_R021_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R021_75<- array(NA, dim=c(nrow(data_combined_cats_mean_R021_75),ncol(data_combined_cats_mean_R021_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R021_75)){
  for(i in 1:nrow(data_combined_cats_mean_R021_75)){
      counts_array_mean_R021_75[i,j,1]<- data_combined_cats_mean_R021_75[i,j]*prob_matrix[j,1]
      counts_array_mean_R021_75[i,j,2]<- counts_array_mean_R021_75[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R021_75[i,j,3]<- counts_array_mean_R021_75[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R021_75[i,j,4]<- counts_array_mean_R021_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R021_75)){
    if(k<=11){
      counts_array_mean_R021_75[k,j,5]<- 0
    }
    else{
      counts_array_mean_R021_75[k,j,5]<- counts_array_mean_R021_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R021_75<- array(NA, dim=c(nrow(data_combined_cats_upper_R021_75),ncol(data_combined_cats_upper_R021_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R021_75)){
  for(i in 1:nrow(data_combined_cats_upper_R021_75)){
      counts_array_upper_R021_75[i,j,1]<- data_combined_cats_upper_R021_75[i,j]*prob_matrix[j,1]
      counts_array_upper_R021_75[i,j,2]<- counts_array_upper_R021_75[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R021_75[i,j,3]<- counts_array_upper_R021_75[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R021_75[i,j,4]<- counts_array_upper_R021_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R021_75)){
    if(k<=11){
      counts_array_upper_R021_75[k,j,5]<- 0
    }
    else{
      counts_array_upper_R021_75[k,j,5]<- counts_array_upper_R021_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_IQR_upper_R021_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_upper_R021_75),ncol(data_combined_cats_IQR_upper_R021_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_IQR_upper_R021_75)){
  for(i in 1:nrow(data_combined_cats_IQR_upper_R021_75)){
      counts_array_IQR_upper_R021_75[i,j,1]<- data_combined_cats_IQR_upper_R021_75[i,j]*prob_matrix[j,1]
      counts_array_IQR_upper_R021_75[i,j,2]<- counts_array_IQR_upper_R021_75[i,j,1]*prob_matrix[j,2]
      counts_array_IQR_upper_R021_75[i,j,3]<- counts_array_IQR_upper_R021_75[i,j,2]*prob_matrix[j,3]
      counts_array_IQR_upper_R021_75[i,j,4]<- counts_array_IQR_upper_R021_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_IQR_upper_R021_75)){
    if(k<=11){
      counts_array_IQR_upper_R021_75[k,j,5]<- 0
    }
    else{
      counts_array_IQR_upper_R021_75[k,j,5]<- counts_array_IQR_upper_R021_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R021_75<- array(NA, dim=c(nrow(data_combined_cats_lower_R021_75),ncol(data_combined_cats_lower_R021_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R021_75)){
  for(i in 1:nrow(data_combined_cats_lower_R021_75)){
      counts_array_lower_R021_75[i,j,1]<- data_combined_cats_lower_R021_75[i,j]*prob_matrix[j,1]
      counts_array_lower_R021_75[i,j,2]<- counts_array_lower_R021_75[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R021_75[i,j,3]<- counts_array_lower_R021_75[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R021_75[i,j,4]<- counts_array_lower_R021_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R021_75)){
    if(k<=11){
      counts_array_lower_R021_75[k,j,5]<- 0
    }
    else{
      counts_array_lower_R021_75[k,j,5]<- counts_array_lower_R021_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_IQR_lower_R021_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_lower_R021_75),ncol(data_combined_cats_IQR_lower_R021_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_IQR_lower_R021_75)){
  for(i in 1:nrow(data_combined_cats_IQR_lower_R021_75)){
      counts_array_IQR_lower_R021_75[i,j,1]<- data_combined_cats_IQR_lower_R021_75[i,j]*prob_matrix[j,1]
      counts_array_IQR_lower_R021_75[i,j,2]<- counts_array_IQR_lower_R021_75[i,j,1]*prob_matrix[j,2]
      counts_array_IQR_lower_R021_75[i,j,3]<- counts_array_IQR_lower_R021_75[i,j,2]*prob_matrix[j,3]
      counts_array_IQR_lower_R021_75[i,j,4]<- counts_array_IQR_lower_R021_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_IQR_lower_R021_75)){
    if(k<=11){
      counts_array_IQR_lower_R021_75[k,j,5]<- 0
    }
    else{
      counts_array_IQR_lower_R021_75[k,j,5]<- counts_array_IQR_lower_R021_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

#########################################


counts_array_median_R021_50<- array(NA, dim=c(nrow(data_combined_cats_median_R021_50),ncol(data_combined_cats_median_R021_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R021_50)){
  for(i in 1:nrow(data_combined_cats_median_R021_50)){
      counts_array_median_R021_50[i,j,1]<- data_combined_cats_median_R021_50[i,j]*prob_matrix[j,1]
      counts_array_median_R021_50[i,j,2]<- counts_array_median_R021_50[i,j,1]*prob_matrix[j,2]
      counts_array_median_R021_50[i,j,3]<- counts_array_median_R021_50[i,j,2]*prob_matrix[j,3]
      counts_array_median_R021_50[i,j,4]<- counts_array_median_R021_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R021_50)){
    if(k<=11){
      counts_array_median_R021_50[k,j,5]<- 0
    }
    else{
      counts_array_median_R021_50[k,j,5]<- counts_array_median_R021_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R021_50<- array(NA, dim=c(nrow(data_combined_cats_mean_R021_50),ncol(data_combined_cats_mean_R021_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R021_50)){
  for(i in 1:nrow(data_combined_cats_mean_R021_50)){
      counts_array_mean_R021_50[i,j,1]<- data_combined_cats_mean_R021_50[i,j]*prob_matrix[j,1]
      counts_array_mean_R021_50[i,j,2]<- counts_array_mean_R021_50[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R021_50[i,j,3]<- counts_array_mean_R021_50[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R021_50[i,j,4]<- counts_array_mean_R021_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R021_50)){
    if(k<=11){
      counts_array_mean_R021_50[k,j,5]<- 0
    }
    else{
      counts_array_mean_R021_50[k,j,5]<- counts_array_mean_R021_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R021_50<- array(NA, dim=c(nrow(data_combined_cats_upper_R021_50),ncol(data_combined_cats_upper_R021_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R021_50)){
  for(i in 1:nrow(data_combined_cats_upper_R021_50)){
      counts_array_upper_R021_50[i,j,1]<- data_combined_cats_upper_R021_50[i,j]*prob_matrix[j,1]
      counts_array_upper_R021_50[i,j,2]<- counts_array_upper_R021_50[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R021_50[i,j,3]<- counts_array_upper_R021_50[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R021_50[i,j,4]<- counts_array_upper_R021_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R021_50)){
    if(k<=11){
      counts_array_upper_R021_50[k,j,5]<- 0
    }
    else{
      counts_array_upper_R021_50[k,j,5]<- counts_array_upper_R021_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R021_50<- array(NA, dim=c(nrow(data_combined_cats_lower_R021_50),ncol(data_combined_cats_lower_R021_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R021_50)){
  for(i in 1:nrow(data_combined_cats_lower_R021_50)){
      counts_array_lower_R021_50[i,j,1]<- data_combined_cats_lower_R021_50[i,j]*prob_matrix[j,1]
      counts_array_lower_R021_50[i,j,2]<- counts_array_lower_R021_50[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R021_50[i,j,3]<- counts_array_lower_R021_50[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R021_50[i,j,4]<- counts_array_lower_R021_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R021_50)){
    if(k<=11){
      counts_array_lower_R021_50[k,j,5]<- 0
    }
    else{
      counts_array_lower_R021_50[k,j,5]<- counts_array_lower_R021_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

###############################


counts_array_median_R025_100<- array(NA, dim=c(nrow(data_combined_cats_median_R025_100),ncol(data_combined_cats_median_R025_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R025_100)){
  for(i in 1:nrow(data_combined_cats_median_R025_100)){
      counts_array_median_R025_100[i,j,1]<- data_combined_cats_median_R025_100[i,j]*prob_matrix[j,1]
      counts_array_median_R025_100[i,j,2]<- counts_array_median_R025_100[i,j,1]*prob_matrix[j,2]
      counts_array_median_R025_100[i,j,3]<- counts_array_median_R025_100[i,j,2]*prob_matrix[j,3]
      counts_array_median_R025_100[i,j,4]<- counts_array_median_R025_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R025_100)){
    if(k<=11){
      counts_array_median_R025_100[k,j,5]<- 0
    }
    else{
      counts_array_median_R025_100[k,j,5]<- counts_array_median_R025_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R025_100<- array(NA, dim=c(nrow(data_combined_cats_mean_R025_100),ncol(data_combined_cats_mean_R025_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R025_100)){
  for(i in 1:nrow(data_combined_cats_mean_R025_100)){
      counts_array_mean_R025_100[i,j,1]<- data_combined_cats_mean_R025_100[i,j]*prob_matrix[j,1]
      counts_array_mean_R025_100[i,j,2]<- counts_array_mean_R025_100[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R025_100[i,j,3]<- counts_array_mean_R025_100[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R025_100[i,j,4]<- counts_array_mean_R025_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R025_100)){
    if(k<=11){
      counts_array_mean_R025_100[k,j,5]<- 0
    }
    else{
      counts_array_mean_R025_100[k,j,5]<- counts_array_mean_R025_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R025_100<- array(NA, dim=c(nrow(data_combined_cats_upper_R025_100),ncol(data_combined_cats_upper_R025_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R025_100)){
  for(i in 1:nrow(data_combined_cats_upper_R025_100)){
      counts_array_upper_R025_100[i,j,1]<- data_combined_cats_upper_R025_100[i,j]*prob_matrix[j,1]
      counts_array_upper_R025_100[i,j,2]<- counts_array_upper_R025_100[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R025_100[i,j,3]<- counts_array_upper_R025_100[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R025_100[i,j,4]<- counts_array_upper_R025_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R025_100)){
    if(k<=11){
      counts_array_upper_R025_100[k,j,5]<- 0
    }
    else{
      counts_array_upper_R025_100[k,j,5]<- counts_array_upper_R025_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R025_100<- array(NA, dim=c(nrow(data_combined_cats_lower_R025_100),ncol(data_combined_cats_lower_R025_100),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R025_100)){
  for(i in 1:nrow(data_combined_cats_lower_R025_100)){
      counts_array_lower_R025_100[i,j,1]<- data_combined_cats_lower_R025_100[i,j]*prob_matrix[j,1]
      counts_array_lower_R025_100[i,j,2]<- counts_array_lower_R025_100[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R025_100[i,j,3]<- counts_array_lower_R025_100[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R025_100[i,j,4]<- counts_array_lower_R025_100[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R025_100)){
    if(k<=11){
      counts_array_lower_R025_100[k,j,5]<- 0
    }
    else{
      counts_array_lower_R025_100[k,j,5]<- counts_array_lower_R025_100[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

####################################


counts_array_median_R025_75<- array(NA, dim=c(nrow(data_combined_cats_median_R025_75),ncol(data_combined_cats_median_R025_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R025_75)){
  for(i in 1:nrow(data_combined_cats_median_R025_75)){
      counts_array_median_R025_75[i,j,1]<- data_combined_cats_median_R025_75[i,j]*prob_matrix[j,1]
      counts_array_median_R025_75[i,j,2]<- counts_array_median_R025_75[i,j,1]*prob_matrix[j,2]
      counts_array_median_R025_75[i,j,3]<- counts_array_median_R025_75[i,j,2]*prob_matrix[j,3]
      counts_array_median_R025_75[i,j,4]<- counts_array_median_R025_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R025_75)){
    if(k<=11){
      counts_array_median_R025_75[k,j,5]<- 0
    }
    else{
      counts_array_median_R025_75[k,j,5]<- counts_array_median_R025_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R025_75<- array(NA, dim=c(nrow(data_combined_cats_mean_R025_75),ncol(data_combined_cats_mean_R025_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R025_75)){
  for(i in 1:nrow(data_combined_cats_mean_R025_75)){
      counts_array_mean_R025_75[i,j,1]<- data_combined_cats_mean_R025_75[i,j]*prob_matrix[j,1]
      counts_array_mean_R025_75[i,j,2]<- counts_array_mean_R025_75[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R025_75[i,j,3]<- counts_array_mean_R025_75[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R025_75[i,j,4]<- counts_array_mean_R025_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R025_75)){
    if(k<=11){
      counts_array_mean_R025_75[k,j,5]<- 0
    }
    else{
      counts_array_mean_R025_75[k,j,5]<- counts_array_mean_R025_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R025_75<- array(NA, dim=c(nrow(data_combined_cats_upper_R025_75),ncol(data_combined_cats_upper_R025_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R025_75)){
  for(i in 1:nrow(data_combined_cats_upper_R025_75)){
      counts_array_upper_R025_75[i,j,1]<- data_combined_cats_upper_R025_75[i,j]*prob_matrix[j,1]
      counts_array_upper_R025_75[i,j,2]<- counts_array_upper_R025_75[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R025_75[i,j,3]<- counts_array_upper_R025_75[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R025_75[i,j,4]<- counts_array_upper_R025_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R025_75)){
    if(k<=11){
      counts_array_upper_R025_75[k,j,5]<- 0
    }
    else{
      counts_array_upper_R025_75[k,j,5]<- counts_array_upper_R025_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_IQR_upper_R025_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_upper_R025_75),ncol(data_combined_cats_IQR_upper_R025_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_IQR_upper_R025_75)){
  for(i in 1:nrow(data_combined_cats_IQR_upper_R025_75)){
      counts_array_IQR_upper_R025_75[i,j,1]<- data_combined_cats_IQR_upper_R025_75[i,j]*prob_matrix[j,1]
      counts_array_IQR_upper_R025_75[i,j,2]<- counts_array_IQR_upper_R025_75[i,j,1]*prob_matrix[j,2]
      counts_array_IQR_upper_R025_75[i,j,3]<- counts_array_IQR_upper_R025_75[i,j,2]*prob_matrix[j,3]
      counts_array_IQR_upper_R025_75[i,j,4]<- counts_array_IQR_upper_R025_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_IQR_upper_R025_75)){
    if(k<=11){
      counts_array_IQR_upper_R025_75[k,j,5]<- 0
    }
    else{
      counts_array_IQR_upper_R025_75[k,j,5]<- counts_array_IQR_upper_R025_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R025_75<- array(NA, dim=c(nrow(data_combined_cats_lower_R025_75),ncol(data_combined_cats_lower_R025_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R025_75)){
  for(i in 1:nrow(data_combined_cats_lower_R025_75)){
      counts_array_lower_R025_75[i,j,1]<- data_combined_cats_lower_R025_75[i,j]*prob_matrix[j,1]
      counts_array_lower_R025_75[i,j,2]<- counts_array_lower_R025_75[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R025_75[i,j,3]<- counts_array_lower_R025_75[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R025_75[i,j,4]<- counts_array_lower_R025_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R025_75)){
    if(k<=11){
      counts_array_lower_R025_75[k,j,5]<- 0
    }
    else{
      counts_array_lower_R025_75[k,j,5]<- counts_array_lower_R025_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_IQR_lower_R025_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_lower_R025_75),ncol(data_combined_cats_IQR_lower_R025_75),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_IQR_lower_R025_75)){
  for(i in 1:nrow(data_combined_cats_IQR_lower_R025_75)){
      counts_array_IQR_lower_R025_75[i,j,1]<- data_combined_cats_IQR_lower_R025_75[i,j]*prob_matrix[j,1]
      counts_array_IQR_lower_R025_75[i,j,2]<- counts_array_IQR_lower_R025_75[i,j,1]*prob_matrix[j,2]
      counts_array_IQR_lower_R025_75[i,j,3]<- counts_array_IQR_lower_R025_75[i,j,2]*prob_matrix[j,3]
      counts_array_IQR_lower_R025_75[i,j,4]<- counts_array_IQR_lower_R025_75[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_IQR_lower_R025_75)){
    if(k<=11){
      counts_array_IQR_lower_R025_75[k,j,5]<- 0
    }
    else{
      counts_array_IQR_lower_R025_75[k,j,5]<- counts_array_IQR_lower_R025_75[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

###########################################


counts_array_median_R025_50<- array(NA, dim=c(nrow(data_combined_cats_median_R025_50),ncol(data_combined_cats_median_R025_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_median_R025_50)){
  for(i in 1:nrow(data_combined_cats_median_R025_50)){
      counts_array_median_R025_50[i,j,1]<- data_combined_cats_median_R025_50[i,j]*prob_matrix[j,1]
      counts_array_median_R025_50[i,j,2]<- counts_array_median_R025_50[i,j,1]*prob_matrix[j,2]
      counts_array_median_R025_50[i,j,3]<- counts_array_median_R025_50[i,j,2]*prob_matrix[j,3]
      counts_array_median_R025_50[i,j,4]<- counts_array_median_R025_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_median_R025_50)){
    if(k<=11){
      counts_array_median_R025_50[k,j,5]<- 0
    }
    else{
      counts_array_median_R025_50[k,j,5]<- counts_array_median_R025_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_mean_R025_50<- array(NA, dim=c(nrow(data_combined_cats_mean_R025_50),ncol(data_combined_cats_mean_R025_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_mean_R025_50)){
  for(i in 1:nrow(data_combined_cats_mean_R025_50)){
      counts_array_mean_R025_50[i,j,1]<- data_combined_cats_mean_R025_50[i,j]*prob_matrix[j,1]
      counts_array_mean_R025_50[i,j,2]<- counts_array_mean_R025_50[i,j,1]*prob_matrix[j,2]
      counts_array_mean_R025_50[i,j,3]<- counts_array_mean_R025_50[i,j,2]*prob_matrix[j,3]
      counts_array_mean_R025_50[i,j,4]<- counts_array_mean_R025_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_mean_R025_50)){
    if(k<=11){
      counts_array_mean_R025_50[k,j,5]<- 0
    }
    else{
      counts_array_mean_R025_50[k,j,5]<- counts_array_mean_R025_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}

counts_array_upper_R025_50<- array(NA, dim=c(nrow(data_combined_cats_upper_R025_50),ncol(data_combined_cats_upper_R025_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_upper_R025_50)){
  for(i in 1:nrow(data_combined_cats_upper_R025_50)){
      counts_array_upper_R025_50[i,j,1]<- data_combined_cats_upper_R025_50[i,j]*prob_matrix[j,1]
      counts_array_upper_R025_50[i,j,2]<- counts_array_upper_R025_50[i,j,1]*prob_matrix[j,2]
      counts_array_upper_R025_50[i,j,3]<- counts_array_upper_R025_50[i,j,2]*prob_matrix[j,3]
      counts_array_upper_R025_50[i,j,4]<- counts_array_upper_R025_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_upper_R025_50)){
    if(k<=11){
      counts_array_upper_R025_50[k,j,5]<- 0
    }
    else{
      counts_array_upper_R025_50[k,j,5]<- counts_array_upper_R025_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}


counts_array_lower_R025_50<- array(NA, dim=c(nrow(data_combined_cats_lower_R025_50),ncol(data_combined_cats_lower_R025_50),ncol(prob_matrix)))


for(j in 1:ncol(data_combined_cats_lower_R025_50)){
  for(i in 1:nrow(data_combined_cats_lower_R025_50)){
      counts_array_lower_R025_50[i,j,1]<- data_combined_cats_lower_R025_50[i,j]*prob_matrix[j,1]
      counts_array_lower_R025_50[i,j,2]<- counts_array_lower_R025_50[i,j,1]*prob_matrix[j,2]
      counts_array_lower_R025_50[i,j,3]<- counts_array_lower_R025_50[i,j,2]*prob_matrix[j,3]
      counts_array_lower_R025_50[i,j,4]<- counts_array_lower_R025_50[i,j,3]*prob_matrix[j,4]
  }
  for(k in 1:nrow(data_combined_cats_lower_R025_50)){
    if(k<=11){
      counts_array_lower_R025_50[k,j,5]<- 0
    }
    else{
      counts_array_lower_R025_50[k,j,5]<- counts_array_lower_R025_50[k-11,j,4]*prob_matrix[j,5]
    }
  }
}
```


```{r,include=FALSE, eval=TRUE}
#for now we are supposing we get a point estimate to determine how long people stay in each of the states. 

length_of_stay<- c(NA,11,11,11,NA)

cumulative_array_median_R017_100<- array(NA, dim=c(nrow(data_combined_cats_median_R017_100),ncol(data_combined_cats_median_R017_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R017_100)){
    cumulative_array_median_R017_100[1,j,]<- counts_array_median_R017_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R017_100)){
      cumulative_array_median_R017_100[i,j,1]<-cumulative_array_median_R017_100[i-1,j,1]+counts_array_median_R017_100[i,j,1]
      cumulative_array_median_R017_100[i,j,5]<-cumulative_array_median_R017_100[i-1,j,5]+counts_array_median_R017_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R017_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R017_100[k,j,2]<- cumulative_array_median_R017_100[k-1,j,2]+counts_array_median_R017_100[k,j,2]
      }
      else {
        cumulative_array_median_R017_100[k,j,2]<-cumulative_array_median_R017_100[k-1,j,2]+
          counts_array_median_R017_100[k,j,2]-counts_array_median_R017_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R017_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R017_100[l,j,3]<- cumulative_array_median_R017_100[l-1,j,3]+counts_array_median_R017_100[l,j,3]
      }
    else{
      cumulative_array_median_R017_100[l,j,3]<-cumulative_array_median_R017_100[l-1,j,3]+
          counts_array_median_R017_100[l,j,3]-counts_array_median_R017_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R017_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R017_100[m,j,4]<- cumulative_array_median_R017_100[m-1,j,4]+counts_array_median_R017_100[m,j,4]
    }
    else{
      cumulative_array_median_R017_100[m,j,4]<-cumulative_array_median_R017_100[m-1,j,4]+
          counts_array_median_R017_100[m,j,4]-counts_array_median_R017_100[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R017_100<- array(NA, dim=c(nrow(data_combined_cats_mean_R017_100),ncol(data_combined_cats_mean_R017_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R017_100)){
    cumulative_array_mean_R017_100[1,j,]<- counts_array_mean_R017_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R017_100)){
      cumulative_array_mean_R017_100[i,j,1]<-cumulative_array_mean_R017_100[i-1,j,1]+counts_array_mean_R017_100[i,j,1]
      cumulative_array_mean_R017_100[i,j,5]<-cumulative_array_mean_R017_100[i-1,j,5]+counts_array_mean_R017_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R017_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R017_100[k,j,2]<- cumulative_array_mean_R017_100[k-1,j,2]+counts_array_mean_R017_100[k,j,2]
      }
      else {
        cumulative_array_mean_R017_100[k,j,2]<-cumulative_array_mean_R017_100[k-1,j,2]+
          counts_array_mean_R017_100[k,j,2]-counts_array_mean_R017_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R017_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R017_100[l,j,3]<- cumulative_array_mean_R017_100[l-1,j,3]+counts_array_mean_R017_100[l,j,3]
      }
    else{
      cumulative_array_mean_R017_100[l,j,3]<-cumulative_array_mean_R017_100[l-1,j,3]+
          counts_array_mean_R017_100[l,j,3]-counts_array_mean_R017_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R017_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R017_100[m,j,4]<- cumulative_array_mean_R017_100[m-1,j,4]+counts_array_mean_R017_100[m,j,4]
    }
    else{
      cumulative_array_mean_R017_100[m,j,4]<-cumulative_array_mean_R017_100[m-1,j,4]+
          counts_array_mean_R017_100[m,j,4]-counts_array_mean_R017_100[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R017_100<- array(NA, dim=c(nrow(data_combined_cats_lower_R017_100),ncol(data_combined_cats_lower_R017_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R017_100)){
    cumulative_array_lower_R017_100[1,j,]<- counts_array_lower_R017_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R017_100)){
      cumulative_array_lower_R017_100[i,j,1]<-cumulative_array_lower_R017_100[i-1,j,1]+counts_array_lower_R017_100[i,j,1]
      cumulative_array_lower_R017_100[i,j,5]<-cumulative_array_lower_R017_100[i-1,j,5]+counts_array_lower_R017_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R017_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R017_100[k,j,2]<- cumulative_array_lower_R017_100[k-1,j,2]+counts_array_lower_R017_100[k,j,2]
      }
      else {
        cumulative_array_lower_R017_100[k,j,2]<-cumulative_array_lower_R017_100[k-1,j,2]+
          counts_array_lower_R017_100[k,j,2]-counts_array_lower_R017_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R017_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R017_100[l,j,3]<- cumulative_array_lower_R017_100[l-1,j,3]+counts_array_lower_R017_100[l,j,3]
      }
    else{
      cumulative_array_lower_R017_100[l,j,3]<-cumulative_array_lower_R017_100[l-1,j,3]+
          counts_array_lower_R017_100[l,j,3]-counts_array_lower_R017_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R017_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R017_100[m,j,4]<- cumulative_array_lower_R017_100[m-1,j,4]+counts_array_lower_R017_100[m,j,4]
    }
    else{
      cumulative_array_lower_R017_100[m,j,4]<-cumulative_array_lower_R017_100[m-1,j,4]+
          counts_array_lower_R017_100[m,j,4]-counts_array_lower_R017_100[m-length_of_stay[4],j,4]
      }
    }
   
}



cumulative_array_upper_R017_100<- array(NA, dim=c(nrow(data_combined_cats_upper_R017_100),ncol(data_combined_cats_upper_R017_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R017_100)){
    cumulative_array_upper_R017_100[1,j,]<- counts_array_upper_R017_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R017_100)){
      cumulative_array_upper_R017_100[i,j,1]<-cumulative_array_upper_R017_100[i-1,j,1]+counts_array_upper_R017_100[i,j,1]
      cumulative_array_upper_R017_100[i,j,5]<-cumulative_array_upper_R017_100[i-1,j,5]+counts_array_upper_R017_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R017_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R017_100[k,j,2]<- cumulative_array_upper_R017_100[k-1,j,2]+counts_array_upper_R017_100[k,j,2]
      }
      else {
        cumulative_array_upper_R017_100[k,j,2]<-cumulative_array_upper_R017_100[k-1,j,2]+
          counts_array_upper_R017_100[k,j,2]-counts_array_upper_R017_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R017_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R017_100[l,j,3]<- cumulative_array_upper_R017_100[l-1,j,3]+counts_array_upper_R017_100[l,j,3]
      }
    else{
      cumulative_array_upper_R017_100[l,j,3]<-cumulative_array_upper_R017_100[l-1,j,3]+
          counts_array_upper_R017_100[l,j,3]-counts_array_upper_R017_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R017_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R017_100[m,j,4]<- cumulative_array_upper_R017_100[m-1,j,4]+counts_array_upper_R017_100[m,j,4]
    }
    else{
      cumulative_array_upper_R017_100[m,j,4]<-cumulative_array_upper_R017_100[m-1,j,4]+
          counts_array_upper_R017_100[m,j,4]-counts_array_upper_R017_100[m-length_of_stay[4],j,4]
      }
    }
   
  }

##############################################

cumulative_array_median_R017_75<- array(NA, dim=c(nrow(data_combined_cats_median_R017_75),ncol(data_combined_cats_median_R017_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R017_75)){
    cumulative_array_median_R017_75[1,j,]<- counts_array_median_R017_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R017_75)){
      cumulative_array_median_R017_75[i,j,1]<-cumulative_array_median_R017_75[i-1,j,1]+counts_array_median_R017_75[i,j,1]
      cumulative_array_median_R017_75[i,j,5]<-cumulative_array_median_R017_75[i-1,j,5]+counts_array_median_R017_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R017_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R017_75[k,j,2]<- cumulative_array_median_R017_75[k-1,j,2]+counts_array_median_R017_75[k,j,2]
      }
      else {
        cumulative_array_median_R017_75[k,j,2]<-cumulative_array_median_R017_75[k-1,j,2]+
          counts_array_median_R017_75[k,j,2]-counts_array_median_R017_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R017_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R017_75[l,j,3]<- cumulative_array_median_R017_75[l-1,j,3]+counts_array_median_R017_75[l,j,3]
      }
    else{
      cumulative_array_median_R017_75[l,j,3]<-cumulative_array_median_R017_75[l-1,j,3]+
          counts_array_median_R017_75[l,j,3]-counts_array_median_R017_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R017_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R017_75[m,j,4]<- cumulative_array_median_R017_75[m-1,j,4]+counts_array_median_R017_75[m,j,4]
    }
    else{
      cumulative_array_median_R017_75[m,j,4]<-cumulative_array_median_R017_75[m-1,j,4]+
          counts_array_median_R017_75[m,j,4]-counts_array_median_R017_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R017_75<- array(NA, dim=c(nrow(data_combined_cats_mean_R017_75),ncol(data_combined_cats_mean_R017_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R017_75)){
    cumulative_array_mean_R017_75[1,j,]<- counts_array_mean_R017_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R017_75)){
      cumulative_array_mean_R017_75[i,j,1]<-cumulative_array_mean_R017_75[i-1,j,1]+counts_array_mean_R017_75[i,j,1]
      cumulative_array_mean_R017_75[i,j,5]<-cumulative_array_mean_R017_75[i-1,j,5]+counts_array_mean_R017_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R017_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R017_75[k,j,2]<- cumulative_array_mean_R017_75[k-1,j,2]+counts_array_mean_R017_75[k,j,2]
      }
      else {
        cumulative_array_mean_R017_75[k,j,2]<-cumulative_array_mean_R017_75[k-1,j,2]+
          counts_array_mean_R017_75[k,j,2]-counts_array_mean_R017_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R017_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R017_75[l,j,3]<- cumulative_array_mean_R017_75[l-1,j,3]+counts_array_mean_R017_75[l,j,3]
      }
    else{
      cumulative_array_mean_R017_75[l,j,3]<-cumulative_array_mean_R017_75[l-1,j,3]+
          counts_array_mean_R017_75[l,j,3]-counts_array_mean_R017_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R017_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R017_75[m,j,4]<- cumulative_array_mean_R017_75[m-1,j,4]+counts_array_mean_R017_75[m,j,4]
    }
    else{
      cumulative_array_mean_R017_75[m,j,4]<-cumulative_array_mean_R017_75[m-1,j,4]+
          counts_array_mean_R017_75[m,j,4]-counts_array_mean_R017_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R017_75<- array(NA, dim=c(nrow(data_combined_cats_lower_R017_75),ncol(data_combined_cats_lower_R017_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R017_75)){
    cumulative_array_lower_R017_75[1,j,]<- counts_array_lower_R017_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R017_75)){
      cumulative_array_lower_R017_75[i,j,1]<-cumulative_array_lower_R017_75[i-1,j,1]+counts_array_lower_R017_75[i,j,1]
      cumulative_array_lower_R017_75[i,j,5]<-cumulative_array_lower_R017_75[i-1,j,5]+counts_array_lower_R017_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R017_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R017_75[k,j,2]<- cumulative_array_lower_R017_75[k-1,j,2]+counts_array_lower_R017_75[k,j,2]
      }
      else {
        cumulative_array_lower_R017_75[k,j,2]<-cumulative_array_lower_R017_75[k-1,j,2]+
          counts_array_lower_R017_75[k,j,2]-counts_array_lower_R017_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R017_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R017_75[l,j,3]<- cumulative_array_lower_R017_75[l-1,j,3]+counts_array_lower_R017_75[l,j,3]
      }
    else{
      cumulative_array_lower_R017_75[l,j,3]<-cumulative_array_lower_R017_75[l-1,j,3]+
          counts_array_lower_R017_75[l,j,3]-counts_array_lower_R017_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R017_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R017_75[m,j,4]<- cumulative_array_lower_R017_75[m-1,j,4]+counts_array_lower_R017_75[m,j,4]
    }
    else{
      cumulative_array_lower_R017_75[m,j,4]<-cumulative_array_lower_R017_75[m-1,j,4]+
          counts_array_lower_R017_75[m,j,4]-counts_array_lower_R017_75[m-length_of_stay[4],j,4]
      }
    }
   
}



cumulative_array_IQR_lower_R017_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_lower_R017_75),ncol(data_combined_cats_IQR_lower_R017_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_IQR_lower_R017_75)){
    cumulative_array_IQR_lower_R017_75[1,j,]<- counts_array_IQR_lower_R017_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_IQR_lower_R017_75)){
      cumulative_array_IQR_lower_R017_75[i,j,1]<-cumulative_array_IQR_lower_R017_75[i-1,j,1]+counts_array_IQR_lower_R017_75[i,j,1]
      cumulative_array_IQR_lower_R017_75[i,j,5]<-cumulative_array_IQR_lower_R017_75[i-1,j,5]+counts_array_IQR_lower_R017_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_IQR_lower_R017_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_IQR_lower_R017_75[k,j,2]<- cumulative_array_IQR_lower_R017_75[k-1,j,2]+counts_array_IQR_lower_R017_75[k,j,2]
      }
      else {
        cumulative_array_IQR_lower_R017_75[k,j,2]<-cumulative_array_IQR_lower_R017_75[k-1,j,2]+
          counts_array_IQR_lower_R017_75[k,j,2]-counts_array_IQR_lower_R017_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_IQR_lower_R017_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_IQR_lower_R017_75[l,j,3]<- cumulative_array_IQR_lower_R017_75[l-1,j,3]+counts_array_IQR_lower_R017_75[l,j,3]
      }
    else{
      cumulative_array_IQR_lower_R017_75[l,j,3]<-cumulative_array_IQR_lower_R017_75[l-1,j,3]+
          counts_array_IQR_lower_R017_75[l,j,3]-counts_array_IQR_lower_R017_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_IQR_lower_R017_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_IQR_lower_R017_75[m,j,4]<- cumulative_array_IQR_lower_R017_75[m-1,j,4]+counts_array_IQR_lower_R017_75[m,j,4]
    }
    else{
      cumulative_array_IQR_lower_R017_75[m,j,4]<-cumulative_array_IQR_lower_R017_75[m-1,j,4]+
          counts_array_IQR_lower_R017_75[m,j,4]-counts_array_IQR_lower_R017_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_upper_R017_75<- array(NA, dim=c(nrow(data_combined_cats_upper_R017_75),ncol(data_combined_cats_upper_R017_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R017_75)){
    cumulative_array_upper_R017_75[1,j,]<- counts_array_upper_R017_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R017_75)){
      cumulative_array_upper_R017_75[i,j,1]<-cumulative_array_upper_R017_75[i-1,j,1]+counts_array_upper_R017_75[i,j,1]
      cumulative_array_upper_R017_75[i,j,5]<-cumulative_array_upper_R017_75[i-1,j,5]+counts_array_upper_R017_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R017_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R017_75[k,j,2]<- cumulative_array_upper_R017_75[k-1,j,2]+counts_array_upper_R017_75[k,j,2]
      }
      else {
        cumulative_array_upper_R017_75[k,j,2]<-cumulative_array_upper_R017_75[k-1,j,2]+
          counts_array_upper_R017_75[k,j,2]-counts_array_upper_R017_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R017_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R017_75[l,j,3]<- cumulative_array_upper_R017_75[l-1,j,3]+counts_array_upper_R017_75[l,j,3]
      }
    else{
      cumulative_array_upper_R017_75[l,j,3]<-cumulative_array_upper_R017_75[l-1,j,3]+
          counts_array_upper_R017_75[l,j,3]-counts_array_upper_R017_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R017_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R017_75[m,j,4]<- cumulative_array_upper_R017_75[m-1,j,4]+counts_array_upper_R017_75[m,j,4]
    }
    else{
      cumulative_array_upper_R017_75[m,j,4]<-cumulative_array_upper_R017_75[m-1,j,4]+
          counts_array_upper_R017_75[m,j,4]-counts_array_upper_R017_75[m-length_of_stay[4],j,4]
      }
    }
   
  }


cumulative_array_IQR_upper_R017_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_upper_R017_75),ncol(data_combined_cats_IQR_upper_R017_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_IQR_upper_R017_75)){
    cumulative_array_IQR_upper_R017_75[1,j,]<- counts_array_IQR_upper_R017_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_IQR_upper_R017_75)){
      cumulative_array_IQR_upper_R017_75[i,j,1]<-cumulative_array_IQR_upper_R017_75[i-1,j,1]+counts_array_IQR_upper_R017_75[i,j,1]
      cumulative_array_IQR_upper_R017_75[i,j,5]<-cumulative_array_IQR_upper_R017_75[i-1,j,5]+counts_array_IQR_upper_R017_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_IQR_upper_R017_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_IQR_upper_R017_75[k,j,2]<- cumulative_array_IQR_upper_R017_75[k-1,j,2]+counts_array_IQR_upper_R017_75[k,j,2]
      }
      else {
        cumulative_array_IQR_upper_R017_75[k,j,2]<-cumulative_array_IQR_upper_R017_75[k-1,j,2]+
          counts_array_IQR_upper_R017_75[k,j,2]-counts_array_IQR_upper_R017_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_IQR_upper_R017_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_IQR_upper_R017_75[l,j,3]<- cumulative_array_IQR_upper_R017_75[l-1,j,3]+counts_array_IQR_upper_R017_75[l,j,3]
      }
    else{
      cumulative_array_IQR_upper_R017_75[l,j,3]<-cumulative_array_IQR_upper_R017_75[l-1,j,3]+
          counts_array_IQR_upper_R017_75[l,j,3]-counts_array_IQR_upper_R017_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_IQR_upper_R017_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_IQR_upper_R017_75[m,j,4]<- cumulative_array_IQR_upper_R017_75[m-1,j,4]+counts_array_IQR_upper_R017_75[m,j,4]
    }
    else{
      cumulative_array_IQR_upper_R017_75[m,j,4]<-cumulative_array_IQR_upper_R017_75[m-1,j,4]+
          counts_array_IQR_upper_R017_75[m,j,4]-counts_array_IQR_upper_R017_75[m-length_of_stay[4],j,4]
      }
    }
   
  }
#################################
cumulative_array_median_R017_50<- array(NA, dim=c(nrow(data_combined_cats_median_R017_50),ncol(data_combined_cats_median_R017_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R017_50)){
    cumulative_array_median_R017_50[1,j,]<- counts_array_median_R017_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R017_50)){
      cumulative_array_median_R017_50[i,j,1]<-cumulative_array_median_R017_50[i-1,j,1]+counts_array_median_R017_50[i,j,1]
      cumulative_array_median_R017_50[i,j,5]<-cumulative_array_median_R017_50[i-1,j,5]+counts_array_median_R017_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R017_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R017_50[k,j,2]<- cumulative_array_median_R017_50[k-1,j,2]+counts_array_median_R017_50[k,j,2]
      }
      else {
        cumulative_array_median_R017_50[k,j,2]<-cumulative_array_median_R017_50[k-1,j,2]+
          counts_array_median_R017_50[k,j,2]-counts_array_median_R017_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R017_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R017_50[l,j,3]<- cumulative_array_median_R017_50[l-1,j,3]+counts_array_median_R017_50[l,j,3]
      }
    else{
      cumulative_array_median_R017_50[l,j,3]<-cumulative_array_median_R017_50[l-1,j,3]+
          counts_array_median_R017_50[l,j,3]-counts_array_median_R017_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R017_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R017_50[m,j,4]<- cumulative_array_median_R017_50[m-1,j,4]+counts_array_median_R017_50[m,j,4]
    }
    else{
      cumulative_array_median_R017_50[m,j,4]<-cumulative_array_median_R017_50[m-1,j,4]+
          counts_array_median_R017_50[m,j,4]-counts_array_median_R017_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R017_50<- array(NA, dim=c(nrow(data_combined_cats_mean_R017_50),ncol(data_combined_cats_mean_R017_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R017_50)){
    cumulative_array_mean_R017_50[1,j,]<- counts_array_mean_R017_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R017_50)){
      cumulative_array_mean_R017_50[i,j,1]<-cumulative_array_mean_R017_50[i-1,j,1]+counts_array_mean_R017_50[i,j,1]
      cumulative_array_mean_R017_50[i,j,5]<-cumulative_array_mean_R017_50[i-1,j,5]+counts_array_mean_R017_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R017_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R017_50[k,j,2]<- cumulative_array_mean_R017_50[k-1,j,2]+counts_array_mean_R017_50[k,j,2]
      }
      else {
        cumulative_array_mean_R017_50[k,j,2]<-cumulative_array_mean_R017_50[k-1,j,2]+
          counts_array_mean_R017_50[k,j,2]-counts_array_mean_R017_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R017_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R017_50[l,j,3]<- cumulative_array_mean_R017_50[l-1,j,3]+counts_array_mean_R017_50[l,j,3]
      }
    else{
      cumulative_array_mean_R017_50[l,j,3]<-cumulative_array_mean_R017_50[l-1,j,3]+
          counts_array_mean_R017_50[l,j,3]-counts_array_mean_R017_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R017_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R017_50[m,j,4]<- cumulative_array_mean_R017_50[m-1,j,4]+counts_array_mean_R017_50[m,j,4]
    }
    else{
      cumulative_array_mean_R017_50[m,j,4]<-cumulative_array_mean_R017_50[m-1,j,4]+
          counts_array_mean_R017_50[m,j,4]-counts_array_mean_R017_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R017_50<- array(NA, dim=c(nrow(data_combined_cats_lower_R017_50),ncol(data_combined_cats_lower_R017_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R017_50)){
    cumulative_array_lower_R017_50[1,j,]<- counts_array_lower_R017_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R017_50)){
      cumulative_array_lower_R017_50[i,j,1]<-cumulative_array_lower_R017_50[i-1,j,1]+counts_array_lower_R017_50[i,j,1]
      cumulative_array_lower_R017_50[i,j,5]<-cumulative_array_lower_R017_50[i-1,j,5]+counts_array_lower_R017_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R017_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R017_50[k,j,2]<- cumulative_array_lower_R017_50[k-1,j,2]+counts_array_lower_R017_50[k,j,2]
      }
      else {
        cumulative_array_lower_R017_50[k,j,2]<-cumulative_array_lower_R017_50[k-1,j,2]+
          counts_array_lower_R017_50[k,j,2]-counts_array_lower_R017_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R017_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R017_50[l,j,3]<- cumulative_array_lower_R017_50[l-1,j,3]+counts_array_lower_R017_50[l,j,3]
      }
    else{
      cumulative_array_lower_R017_50[l,j,3]<-cumulative_array_lower_R017_50[l-1,j,3]+
          counts_array_lower_R017_50[l,j,3]-counts_array_lower_R017_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R017_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R017_50[m,j,4]<- cumulative_array_lower_R017_50[m-1,j,4]+counts_array_lower_R017_50[m,j,4]
    }
    else{
      cumulative_array_lower_R017_50[m,j,4]<-cumulative_array_lower_R017_50[m-1,j,4]+
          counts_array_lower_R017_50[m,j,4]-counts_array_lower_R017_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_upper_R017_50<- array(NA, dim=c(nrow(data_combined_cats_upper_R017_50),ncol(data_combined_cats_upper_R017_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R017_50)){
    cumulative_array_upper_R017_50[1,j,]<- counts_array_upper_R017_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R017_50)){
      cumulative_array_upper_R017_50[i,j,1]<-cumulative_array_upper_R017_50[i-1,j,1]+counts_array_upper_R017_50[i,j,1]
      cumulative_array_upper_R017_50[i,j,5]<-cumulative_array_upper_R017_50[i-1,j,5]+counts_array_upper_R017_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R017_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R017_50[k,j,2]<- cumulative_array_upper_R017_50[k-1,j,2]+counts_array_upper_R017_50[k,j,2]
      }
      else {
        cumulative_array_upper_R017_50[k,j,2]<-cumulative_array_upper_R017_50[k-1,j,2]+
          counts_array_upper_R017_50[k,j,2]-counts_array_upper_R017_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R017_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R017_50[l,j,3]<- cumulative_array_upper_R017_50[l-1,j,3]+counts_array_upper_R017_50[l,j,3]
      }
    else{
      cumulative_array_upper_R017_50[l,j,3]<-cumulative_array_upper_R017_50[l-1,j,3]+
          counts_array_upper_R017_50[l,j,3]-counts_array_upper_R017_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R017_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R017_50[m,j,4]<- cumulative_array_upper_R017_50[m-1,j,4]+counts_array_upper_R017_50[m,j,4]
    }
    else{
      cumulative_array_upper_R017_50[m,j,4]<-cumulative_array_upper_R017_50[m-1,j,4]+
          counts_array_upper_R017_50[m,j,4]-counts_array_upper_R017_50[m-length_of_stay[4],j,4]
      }
    }
   
  }
####################################
cumulative_array_median_R021_100<- array(NA, dim=c(nrow(data_combined_cats_median_R021_100),ncol(data_combined_cats_median_R021_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R021_100)){
    cumulative_array_median_R021_100[1,j,]<- counts_array_median_R021_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R021_100)){
      cumulative_array_median_R021_100[i,j,1]<-cumulative_array_median_R021_100[i-1,j,1]+counts_array_median_R021_100[i,j,1]
      cumulative_array_median_R021_100[i,j,5]<-cumulative_array_median_R021_100[i-1,j,5]+counts_array_median_R021_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R021_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R021_100[k,j,2]<- cumulative_array_median_R021_100[k-1,j,2]+counts_array_median_R021_100[k,j,2]
      }
      else {
        cumulative_array_median_R021_100[k,j,2]<-cumulative_array_median_R021_100[k-1,j,2]+
          counts_array_median_R021_100[k,j,2]-counts_array_median_R021_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R021_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R021_100[l,j,3]<- cumulative_array_median_R021_100[l-1,j,3]+counts_array_median_R021_100[l,j,3]
      }
    else{
      cumulative_array_median_R021_100[l,j,3]<-cumulative_array_median_R021_100[l-1,j,3]+
          counts_array_median_R021_100[l,j,3]-counts_array_median_R021_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R021_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R021_100[m,j,4]<- cumulative_array_median_R021_100[m-1,j,4]+counts_array_median_R021_100[m,j,4]
    }
    else{
      cumulative_array_median_R021_100[m,j,4]<-cumulative_array_median_R021_100[m-1,j,4]+
          counts_array_median_R021_100[m,j,4]-counts_array_median_R021_100[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R021_100<- array(NA, dim=c(nrow(data_combined_cats_mean_R021_100),ncol(data_combined_cats_mean_R021_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R021_100)){
    cumulative_array_mean_R021_100[1,j,]<- counts_array_mean_R021_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R021_100)){
      cumulative_array_mean_R021_100[i,j,1]<-cumulative_array_mean_R021_100[i-1,j,1]+counts_array_mean_R021_100[i,j,1]
      cumulative_array_mean_R021_100[i,j,5]<-cumulative_array_mean_R021_100[i-1,j,5]+counts_array_mean_R021_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R021_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R021_100[k,j,2]<- cumulative_array_mean_R021_100[k-1,j,2]+counts_array_mean_R021_100[k,j,2]
      }
      else {
        cumulative_array_mean_R021_100[k,j,2]<-cumulative_array_mean_R021_100[k-1,j,2]+
          counts_array_mean_R021_100[k,j,2]-counts_array_mean_R021_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R021_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R021_100[l,j,3]<- cumulative_array_mean_R021_100[l-1,j,3]+counts_array_mean_R021_100[l,j,3]
      }
    else{
      cumulative_array_mean_R021_100[l,j,3]<-cumulative_array_mean_R021_100[l-1,j,3]+
          counts_array_mean_R021_100[l,j,3]-counts_array_mean_R021_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R021_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R021_100[m,j,4]<- cumulative_array_mean_R021_100[m-1,j,4]+counts_array_mean_R021_100[m,j,4]
    }
    else{
      cumulative_array_mean_R021_100[m,j,4]<-cumulative_array_mean_R021_100[m-1,j,4]+
          counts_array_mean_R021_100[m,j,4]-counts_array_mean_R021_100[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R021_100<- array(NA, dim=c(nrow(data_combined_cats_lower_R021_100),ncol(data_combined_cats_lower_R021_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R021_100)){
    cumulative_array_lower_R021_100[1,j,]<- counts_array_lower_R021_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R021_100)){
      cumulative_array_lower_R021_100[i,j,1]<-cumulative_array_lower_R021_100[i-1,j,1]+counts_array_lower_R021_100[i,j,1]
      cumulative_array_lower_R021_100[i,j,5]<-cumulative_array_lower_R021_100[i-1,j,5]+counts_array_lower_R021_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R021_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R021_100[k,j,2]<- cumulative_array_lower_R021_100[k-1,j,2]+counts_array_lower_R021_100[k,j,2]
      }
      else {
        cumulative_array_lower_R021_100[k,j,2]<-cumulative_array_lower_R021_100[k-1,j,2]+
          counts_array_lower_R021_100[k,j,2]-counts_array_lower_R021_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R021_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R021_100[l,j,3]<- cumulative_array_lower_R021_100[l-1,j,3]+counts_array_lower_R021_100[l,j,3]
      }
    else{
      cumulative_array_lower_R021_100[l,j,3]<-cumulative_array_lower_R021_100[l-1,j,3]+
          counts_array_lower_R021_100[l,j,3]-counts_array_lower_R021_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R021_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R021_100[m,j,4]<- cumulative_array_lower_R021_100[m-1,j,4]+counts_array_lower_R021_100[m,j,4]
    }
    else{
      cumulative_array_lower_R021_100[m,j,4]<-cumulative_array_lower_R021_100[m-1,j,4]+
          counts_array_lower_R021_100[m,j,4]-counts_array_lower_R021_100[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_upper_R021_100<- array(NA, dim=c(nrow(data_combined_cats_upper_R021_100),ncol(data_combined_cats_upper_R021_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R021_100)){
    cumulative_array_upper_R021_100[1,j,]<- counts_array_upper_R021_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R021_100)){
      cumulative_array_upper_R021_100[i,j,1]<-cumulative_array_upper_R021_100[i-1,j,1]+counts_array_upper_R021_100[i,j,1]
      cumulative_array_upper_R021_100[i,j,5]<-cumulative_array_upper_R021_100[i-1,j,5]+counts_array_upper_R021_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R021_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R021_100[k,j,2]<- cumulative_array_upper_R021_100[k-1,j,2]+counts_array_upper_R021_100[k,j,2]
      }
      else {
        cumulative_array_upper_R021_100[k,j,2]<-cumulative_array_upper_R021_100[k-1,j,2]+
          counts_array_upper_R021_100[k,j,2]-counts_array_upper_R021_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R021_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R021_100[l,j,3]<- cumulative_array_upper_R021_100[l-1,j,3]+counts_array_upper_R021_100[l,j,3]
      }
    else{
      cumulative_array_upper_R021_100[l,j,3]<-cumulative_array_upper_R021_100[l-1,j,3]+
          counts_array_upper_R021_100[l,j,3]-counts_array_upper_R021_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R021_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R021_100[m,j,4]<- cumulative_array_upper_R021_100[m-1,j,4]+counts_array_upper_R021_100[m,j,4]
    }
    else{
      cumulative_array_upper_R021_100[m,j,4]<-cumulative_array_upper_R021_100[m-1,j,4]+
          counts_array_upper_R021_100[m,j,4]-counts_array_upper_R021_100[m-length_of_stay[4],j,4]
      }
    }
   
  }
###########################################
cumulative_array_median_R021_75<- array(NA, dim=c(nrow(data_combined_cats_median_R021_75),ncol(data_combined_cats_median_R021_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R021_75)){
    cumulative_array_median_R021_75[1,j,]<- counts_array_median_R021_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R021_75)){
      cumulative_array_median_R021_75[i,j,1]<-cumulative_array_median_R021_75[i-1,j,1]+counts_array_median_R021_75[i,j,1]
      cumulative_array_median_R021_75[i,j,5]<-cumulative_array_median_R021_75[i-1,j,5]+counts_array_median_R021_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R021_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R021_75[k,j,2]<- cumulative_array_median_R021_75[k-1,j,2]+counts_array_median_R021_75[k,j,2]
      }
      else {
        cumulative_array_median_R021_75[k,j,2]<-cumulative_array_median_R021_75[k-1,j,2]+
          counts_array_median_R021_75[k,j,2]-counts_array_median_R021_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R021_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R021_75[l,j,3]<- cumulative_array_median_R021_75[l-1,j,3]+counts_array_median_R021_75[l,j,3]
      }
    else{
      cumulative_array_median_R021_75[l,j,3]<-cumulative_array_median_R021_75[l-1,j,3]+
          counts_array_median_R021_75[l,j,3]-counts_array_median_R021_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R021_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R021_75[m,j,4]<- cumulative_array_median_R021_75[m-1,j,4]+counts_array_median_R021_75[m,j,4]
    }
    else{
      cumulative_array_median_R021_75[m,j,4]<-cumulative_array_median_R021_75[m-1,j,4]+
          counts_array_median_R021_75[m,j,4]-counts_array_median_R021_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R021_75<- array(NA, dim=c(nrow(data_combined_cats_mean_R021_75),ncol(data_combined_cats_mean_R021_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R021_75)){
    cumulative_array_mean_R021_75[1,j,]<- counts_array_mean_R021_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R021_75)){
      cumulative_array_mean_R021_75[i,j,1]<-cumulative_array_mean_R021_75[i-1,j,1]+counts_array_mean_R021_75[i,j,1]
      cumulative_array_mean_R021_75[i,j,5]<-cumulative_array_mean_R021_75[i-1,j,5]+counts_array_mean_R021_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R021_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R021_75[k,j,2]<- cumulative_array_mean_R021_75[k-1,j,2]+counts_array_mean_R021_75[k,j,2]
      }
      else {
        cumulative_array_mean_R021_75[k,j,2]<-cumulative_array_mean_R021_75[k-1,j,2]+
          counts_array_mean_R021_75[k,j,2]-counts_array_mean_R021_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R021_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R021_75[l,j,3]<- cumulative_array_mean_R021_75[l-1,j,3]+counts_array_mean_R021_75[l,j,3]
      }
    else{
      cumulative_array_mean_R021_75[l,j,3]<-cumulative_array_mean_R021_75[l-1,j,3]+
          counts_array_mean_R021_75[l,j,3]-counts_array_mean_R021_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R021_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R021_75[m,j,4]<- cumulative_array_mean_R021_75[m-1,j,4]+counts_array_mean_R021_75[m,j,4]
    }
    else{
      cumulative_array_mean_R021_75[m,j,4]<-cumulative_array_mean_R021_75[m-1,j,4]+
          counts_array_mean_R021_75[m,j,4]-counts_array_mean_R021_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R021_75<- array(NA, dim=c(nrow(data_combined_cats_lower_R021_75),ncol(data_combined_cats_lower_R021_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R021_75)){
    cumulative_array_lower_R021_75[1,j,]<- counts_array_lower_R021_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R021_75)){
      cumulative_array_lower_R021_75[i,j,1]<-cumulative_array_lower_R021_75[i-1,j,1]+counts_array_lower_R021_75[i,j,1]
      cumulative_array_lower_R021_75[i,j,5]<-cumulative_array_lower_R021_75[i-1,j,5]+counts_array_lower_R021_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R021_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R021_75[k,j,2]<- cumulative_array_lower_R021_75[k-1,j,2]+counts_array_lower_R021_75[k,j,2]
      }
      else {
        cumulative_array_lower_R021_75[k,j,2]<-cumulative_array_lower_R021_75[k-1,j,2]+
          counts_array_lower_R021_75[k,j,2]-counts_array_lower_R021_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R021_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R021_75[l,j,3]<- cumulative_array_lower_R021_75[l-1,j,3]+counts_array_lower_R021_75[l,j,3]
      }
    else{
      cumulative_array_lower_R021_75[l,j,3]<-cumulative_array_lower_R021_75[l-1,j,3]+
          counts_array_lower_R021_75[l,j,3]-counts_array_lower_R021_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R021_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R021_75[m,j,4]<- cumulative_array_lower_R021_75[m-1,j,4]+counts_array_lower_R021_75[m,j,4]
    }
    else{
      cumulative_array_lower_R021_75[m,j,4]<-cumulative_array_lower_R021_75[m-1,j,4]+
          counts_array_lower_R021_75[m,j,4]-counts_array_lower_R021_75[m-length_of_stay[4],j,4]
      }
    }
   
}



cumulative_array_IQR_lower_R021_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_lower_R021_75),ncol(data_combined_cats_IQR_lower_R021_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_IQR_lower_R021_75)){
    cumulative_array_IQR_lower_R021_75[1,j,]<- counts_array_IQR_lower_R021_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_IQR_lower_R021_75)){
      cumulative_array_IQR_lower_R021_75[i,j,1]<-cumulative_array_IQR_lower_R021_75[i-1,j,1]+counts_array_IQR_lower_R021_75[i,j,1]
      cumulative_array_IQR_lower_R021_75[i,j,5]<-cumulative_array_IQR_lower_R021_75[i-1,j,5]+counts_array_IQR_lower_R021_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_IQR_lower_R021_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_IQR_lower_R021_75[k,j,2]<- cumulative_array_IQR_lower_R021_75[k-1,j,2]+counts_array_IQR_lower_R021_75[k,j,2]
      }
      else {
        cumulative_array_IQR_lower_R021_75[k,j,2]<-cumulative_array_IQR_lower_R021_75[k-1,j,2]+
          counts_array_IQR_lower_R021_75[k,j,2]-counts_array_IQR_lower_R021_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_IQR_lower_R021_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_IQR_lower_R021_75[l,j,3]<- cumulative_array_IQR_lower_R021_75[l-1,j,3]+counts_array_IQR_lower_R021_75[l,j,3]
      }
    else{
      cumulative_array_IQR_lower_R021_75[l,j,3]<-cumulative_array_IQR_lower_R021_75[l-1,j,3]+
          counts_array_IQR_lower_R021_75[l,j,3]-counts_array_IQR_lower_R021_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_IQR_lower_R021_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_IQR_lower_R021_75[m,j,4]<- cumulative_array_IQR_lower_R021_75[m-1,j,4]+counts_array_IQR_lower_R021_75[m,j,4]
    }
    else{
      cumulative_array_IQR_lower_R021_75[m,j,4]<-cumulative_array_IQR_lower_R021_75[m-1,j,4]+
          counts_array_IQR_lower_R021_75[m,j,4]-counts_array_IQR_lower_R021_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_upper_R021_75<- array(NA, dim=c(nrow(data_combined_cats_upper_R021_75),ncol(data_combined_cats_upper_R021_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R021_75)){
    cumulative_array_upper_R021_75[1,j,]<- counts_array_upper_R021_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R021_75)){
      cumulative_array_upper_R021_75[i,j,1]<-cumulative_array_upper_R021_75[i-1,j,1]+counts_array_upper_R021_75[i,j,1]
      cumulative_array_upper_R021_75[i,j,5]<-cumulative_array_upper_R021_75[i-1,j,5]+counts_array_upper_R021_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R021_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R021_75[k,j,2]<- cumulative_array_upper_R021_75[k-1,j,2]+counts_array_upper_R021_75[k,j,2]
      }
      else {
        cumulative_array_upper_R021_75[k,j,2]<-cumulative_array_upper_R021_75[k-1,j,2]+
          counts_array_upper_R021_75[k,j,2]-counts_array_upper_R021_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R021_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R021_75[l,j,3]<- cumulative_array_upper_R021_75[l-1,j,3]+counts_array_upper_R021_75[l,j,3]
      }
    else{
      cumulative_array_upper_R021_75[l,j,3]<-cumulative_array_upper_R021_75[l-1,j,3]+
          counts_array_upper_R021_75[l,j,3]-counts_array_upper_R021_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R021_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R021_75[m,j,4]<- cumulative_array_upper_R021_75[m-1,j,4]+counts_array_upper_R021_75[m,j,4]
    }
    else{
      cumulative_array_upper_R021_75[m,j,4]<-cumulative_array_upper_R021_75[m-1,j,4]+
          counts_array_upper_R021_75[m,j,4]-counts_array_upper_R021_75[m-length_of_stay[4],j,4]
      }
    }
   
  }


cumulative_array_IQR_upper_R021_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_upper_R021_75),ncol(data_combined_cats_IQR_upper_R021_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_IQR_upper_R021_75)){
    cumulative_array_IQR_upper_R021_75[1,j,]<- counts_array_IQR_upper_R021_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_IQR_upper_R021_75)){
      cumulative_array_IQR_upper_R021_75[i,j,1]<-cumulative_array_IQR_upper_R021_75[i-1,j,1]+counts_array_IQR_upper_R021_75[i,j,1]
      cumulative_array_IQR_upper_R021_75[i,j,5]<-cumulative_array_IQR_upper_R021_75[i-1,j,5]+counts_array_IQR_upper_R021_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_IQR_upper_R021_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_IQR_upper_R021_75[k,j,2]<- cumulative_array_IQR_upper_R021_75[k-1,j,2]+counts_array_IQR_upper_R021_75[k,j,2]
      }
      else {
        cumulative_array_IQR_upper_R021_75[k,j,2]<-cumulative_array_IQR_upper_R021_75[k-1,j,2]+
          counts_array_IQR_upper_R021_75[k,j,2]-counts_array_IQR_upper_R021_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_IQR_upper_R021_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_IQR_upper_R021_75[l,j,3]<- cumulative_array_IQR_upper_R021_75[l-1,j,3]+counts_array_IQR_upper_R021_75[l,j,3]
      }
    else{
      cumulative_array_IQR_upper_R021_75[l,j,3]<-cumulative_array_IQR_upper_R021_75[l-1,j,3]+
          counts_array_IQR_upper_R021_75[l,j,3]-counts_array_IQR_upper_R021_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_IQR_upper_R021_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_IQR_upper_R021_75[m,j,4]<- cumulative_array_IQR_upper_R021_75[m-1,j,4]+counts_array_IQR_upper_R021_75[m,j,4]
    }
    else{
      cumulative_array_IQR_upper_R021_75[m,j,4]<-cumulative_array_IQR_upper_R021_75[m-1,j,4]+
          counts_array_IQR_upper_R021_75[m,j,4]-counts_array_IQR_upper_R021_75[m-length_of_stay[4],j,4]
      }
    }
   
  }
####################################
cumulative_array_median_R021_50<- array(NA, dim=c(nrow(data_combined_cats_median_R021_50),ncol(data_combined_cats_median_R021_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R021_50)){
    cumulative_array_median_R021_50[1,j,]<- counts_array_median_R021_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R021_50)){
      cumulative_array_median_R021_50[i,j,1]<-cumulative_array_median_R021_50[i-1,j,1]+counts_array_median_R021_50[i,j,1]
      cumulative_array_median_R021_50[i,j,5]<-cumulative_array_median_R021_50[i-1,j,5]+counts_array_median_R021_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R021_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R021_50[k,j,2]<- cumulative_array_median_R021_50[k-1,j,2]+counts_array_median_R021_50[k,j,2]
      }
      else {
        cumulative_array_median_R021_50[k,j,2]<-cumulative_array_median_R021_50[k-1,j,2]+
          counts_array_median_R021_50[k,j,2]-counts_array_median_R021_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R021_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R021_50[l,j,3]<- cumulative_array_median_R021_50[l-1,j,3]+counts_array_median_R021_50[l,j,3]
      }
    else{
      cumulative_array_median_R021_50[l,j,3]<-cumulative_array_median_R021_50[l-1,j,3]+
          counts_array_median_R021_50[l,j,3]-counts_array_median_R021_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R021_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R021_50[m,j,4]<- cumulative_array_median_R021_50[m-1,j,4]+counts_array_median_R021_50[m,j,4]
    }
    else{
      cumulative_array_median_R021_50[m,j,4]<-cumulative_array_median_R021_50[m-1,j,4]+
          counts_array_median_R021_50[m,j,4]-counts_array_median_R021_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R021_50<- array(NA, dim=c(nrow(data_combined_cats_mean_R021_50),ncol(data_combined_cats_mean_R021_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R021_50)){
    cumulative_array_mean_R021_50[1,j,]<- counts_array_mean_R021_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R021_50)){
      cumulative_array_mean_R021_50[i,j,1]<-cumulative_array_mean_R021_50[i-1,j,1]+counts_array_mean_R021_50[i,j,1]
      cumulative_array_mean_R021_50[i,j,5]<-cumulative_array_mean_R021_50[i-1,j,5]+counts_array_mean_R021_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R021_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R021_50[k,j,2]<- cumulative_array_mean_R021_50[k-1,j,2]+counts_array_mean_R021_50[k,j,2]
      }
      else {
        cumulative_array_mean_R021_50[k,j,2]<-cumulative_array_mean_R021_50[k-1,j,2]+
          counts_array_mean_R021_50[k,j,2]-counts_array_mean_R021_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R021_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R021_50[l,j,3]<- cumulative_array_mean_R021_50[l-1,j,3]+counts_array_mean_R021_50[l,j,3]
      }
    else{
      cumulative_array_mean_R021_50[l,j,3]<-cumulative_array_mean_R021_50[l-1,j,3]+
          counts_array_mean_R021_50[l,j,3]-counts_array_mean_R021_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R021_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R021_50[m,j,4]<- cumulative_array_mean_R021_50[m-1,j,4]+counts_array_mean_R021_50[m,j,4]
    }
    else{
      cumulative_array_mean_R021_50[m,j,4]<-cumulative_array_mean_R021_50[m-1,j,4]+
          counts_array_mean_R021_50[m,j,4]-counts_array_mean_R021_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R021_50<- array(NA, dim=c(nrow(data_combined_cats_lower_R021_50),ncol(data_combined_cats_lower_R021_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R021_50)){
    cumulative_array_lower_R021_50[1,j,]<- counts_array_lower_R021_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R021_50)){
      cumulative_array_lower_R021_50[i,j,1]<-cumulative_array_lower_R021_50[i-1,j,1]+counts_array_lower_R021_50[i,j,1]
      cumulative_array_lower_R021_50[i,j,5]<-cumulative_array_lower_R021_50[i-1,j,5]+counts_array_lower_R021_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R021_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R021_50[k,j,2]<- cumulative_array_lower_R021_50[k-1,j,2]+counts_array_lower_R021_50[k,j,2]
      }
      else {
        cumulative_array_lower_R021_50[k,j,2]<-cumulative_array_lower_R021_50[k-1,j,2]+
          counts_array_lower_R021_50[k,j,2]-counts_array_lower_R021_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R021_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R021_50[l,j,3]<- cumulative_array_lower_R021_50[l-1,j,3]+counts_array_lower_R021_50[l,j,3]
      }
    else{
      cumulative_array_lower_R021_50[l,j,3]<-cumulative_array_lower_R021_50[l-1,j,3]+
          counts_array_lower_R021_50[l,j,3]-counts_array_lower_R021_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R021_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R021_50[m,j,4]<- cumulative_array_lower_R021_50[m-1,j,4]+counts_array_lower_R021_50[m,j,4]
    }
    else{
      cumulative_array_lower_R021_50[m,j,4]<-cumulative_array_lower_R021_50[m-1,j,4]+
          counts_array_lower_R021_50[m,j,4]-counts_array_lower_R021_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_upper_R021_50<- array(NA, dim=c(nrow(data_combined_cats_upper_R021_50),ncol(data_combined_cats_upper_R021_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R021_50)){
    cumulative_array_upper_R021_50[1,j,]<- counts_array_upper_R021_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R021_50)){
      cumulative_array_upper_R021_50[i,j,1]<-cumulative_array_upper_R021_50[i-1,j,1]+counts_array_upper_R021_50[i,j,1]
      cumulative_array_upper_R021_50[i,j,5]<-cumulative_array_upper_R021_50[i-1,j,5]+counts_array_upper_R021_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R021_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R021_50[k,j,2]<- cumulative_array_upper_R021_50[k-1,j,2]+counts_array_upper_R021_50[k,j,2]
      }
      else {
        cumulative_array_upper_R021_50[k,j,2]<-cumulative_array_upper_R021_50[k-1,j,2]+
          counts_array_upper_R021_50[k,j,2]-counts_array_upper_R021_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R021_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R021_50[l,j,3]<- cumulative_array_upper_R021_50[l-1,j,3]+counts_array_upper_R021_50[l,j,3]
      }
    else{
      cumulative_array_upper_R021_50[l,j,3]<-cumulative_array_upper_R021_50[l-1,j,3]+
          counts_array_upper_R021_50[l,j,3]-counts_array_upper_R021_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R021_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R021_50[m,j,4]<- cumulative_array_upper_R021_50[m-1,j,4]+counts_array_upper_R021_50[m,j,4]
    }
    else{
      cumulative_array_upper_R021_50[m,j,4]<-cumulative_array_upper_R021_50[m-1,j,4]+
          counts_array_upper_R021_50[m,j,4]-counts_array_upper_R021_50[m-length_of_stay[4],j,4]
      }
    }
   
  }
#######################################
cumulative_array_median_R025_100<- array(NA, dim=c(nrow(data_combined_cats_median_R025_100),ncol(data_combined_cats_median_R025_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R025_100)){
    cumulative_array_median_R025_100[1,j,]<- counts_array_median_R025_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R025_100)){
      cumulative_array_median_R025_100[i,j,1]<-cumulative_array_median_R025_100[i-1,j,1]+counts_array_median_R025_100[i,j,1]
      cumulative_array_median_R025_100[i,j,5]<-cumulative_array_median_R025_100[i-1,j,5]+counts_array_median_R025_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R025_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R025_100[k,j,2]<- cumulative_array_median_R025_100[k-1,j,2]+counts_array_median_R025_100[k,j,2]
      }
      else {
        cumulative_array_median_R025_100[k,j,2]<-cumulative_array_median_R025_100[k-1,j,2]+
          counts_array_median_R025_100[k,j,2]-counts_array_median_R025_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R025_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R025_100[l,j,3]<- cumulative_array_median_R025_100[l-1,j,3]+counts_array_median_R025_100[l,j,3]
      }
    else{
      cumulative_array_median_R025_100[l,j,3]<-cumulative_array_median_R025_100[l-1,j,3]+
          counts_array_median_R025_100[l,j,3]-counts_array_median_R025_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R025_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R025_100[m,j,4]<- cumulative_array_median_R025_100[m-1,j,4]+counts_array_median_R025_100[m,j,4]
    }
    else{
      cumulative_array_median_R025_100[m,j,4]<-cumulative_array_median_R025_100[m-1,j,4]+
          counts_array_median_R025_100[m,j,4]-counts_array_median_R025_100[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R025_100<- array(NA, dim=c(nrow(data_combined_cats_mean_R025_100),ncol(data_combined_cats_mean_R025_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R025_100)){
    cumulative_array_mean_R025_100[1,j,]<- counts_array_mean_R025_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R025_100)){
      cumulative_array_mean_R025_100[i,j,1]<-cumulative_array_mean_R025_100[i-1,j,1]+counts_array_mean_R025_100[i,j,1]
      cumulative_array_mean_R025_100[i,j,5]<-cumulative_array_mean_R025_100[i-1,j,5]+counts_array_mean_R025_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R025_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R025_100[k,j,2]<- cumulative_array_mean_R025_100[k-1,j,2]+counts_array_mean_R025_100[k,j,2]
      }
      else {
        cumulative_array_mean_R025_100[k,j,2]<-cumulative_array_mean_R025_100[k-1,j,2]+
          counts_array_mean_R025_100[k,j,2]-counts_array_mean_R025_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R025_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R025_100[l,j,3]<- cumulative_array_mean_R025_100[l-1,j,3]+counts_array_mean_R025_100[l,j,3]
      }
    else{
      cumulative_array_mean_R025_100[l,j,3]<-cumulative_array_mean_R025_100[l-1,j,3]+
          counts_array_mean_R025_100[l,j,3]-counts_array_mean_R025_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R025_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R025_100[m,j,4]<- cumulative_array_mean_R025_100[m-1,j,4]+counts_array_mean_R025_100[m,j,4]
    }
    else{
      cumulative_array_mean_R025_100[m,j,4]<-cumulative_array_mean_R025_100[m-1,j,4]+
          counts_array_mean_R025_100[m,j,4]-counts_array_mean_R025_100[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R025_100<- array(NA, dim=c(nrow(data_combined_cats_lower_R025_100),ncol(data_combined_cats_lower_R025_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R025_100)){
    cumulative_array_lower_R025_100[1,j,]<- counts_array_lower_R025_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R025_100)){
      cumulative_array_lower_R025_100[i,j,1]<-cumulative_array_lower_R025_100[i-1,j,1]+counts_array_lower_R025_100[i,j,1]
      cumulative_array_lower_R025_100[i,j,5]<-cumulative_array_lower_R025_100[i-1,j,5]+counts_array_lower_R025_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R025_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R025_100[k,j,2]<- cumulative_array_lower_R025_100[k-1,j,2]+counts_array_lower_R025_100[k,j,2]
      }
      else {
        cumulative_array_lower_R025_100[k,j,2]<-cumulative_array_lower_R025_100[k-1,j,2]+
          counts_array_lower_R025_100[k,j,2]-counts_array_lower_R025_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R025_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R025_100[l,j,3]<- cumulative_array_lower_R025_100[l-1,j,3]+counts_array_lower_R025_100[l,j,3]
      }
    else{
      cumulative_array_lower_R025_100[l,j,3]<-cumulative_array_lower_R025_100[l-1,j,3]+
          counts_array_lower_R025_100[l,j,3]-counts_array_lower_R025_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R025_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R025_100[m,j,4]<- cumulative_array_lower_R025_100[m-1,j,4]+counts_array_lower_R025_100[m,j,4]
    }
    else{
      cumulative_array_lower_R025_100[m,j,4]<-cumulative_array_lower_R025_100[m-1,j,4]+
          counts_array_lower_R025_100[m,j,4]-counts_array_lower_R025_100[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_upper_R025_100<- array(NA, dim=c(nrow(data_combined_cats_upper_R025_100),ncol(data_combined_cats_upper_R025_100),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R025_100)){
    cumulative_array_upper_R025_100[1,j,]<- counts_array_upper_R025_100[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R025_100)){
      cumulative_array_upper_R025_100[i,j,1]<-cumulative_array_upper_R025_100[i-1,j,1]+counts_array_upper_R025_100[i,j,1]
      cumulative_array_upper_R025_100[i,j,5]<-cumulative_array_upper_R025_100[i-1,j,5]+counts_array_upper_R025_100[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R025_100)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R025_100[k,j,2]<- cumulative_array_upper_R025_100[k-1,j,2]+counts_array_upper_R025_100[k,j,2]
      }
      else {
        cumulative_array_upper_R025_100[k,j,2]<-cumulative_array_upper_R025_100[k-1,j,2]+
          counts_array_upper_R025_100[k,j,2]-counts_array_upper_R025_100[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R025_100)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R025_100[l,j,3]<- cumulative_array_upper_R025_100[l-1,j,3]+counts_array_upper_R025_100[l,j,3]
      }
    else{
      cumulative_array_upper_R025_100[l,j,3]<-cumulative_array_upper_R025_100[l-1,j,3]+
          counts_array_upper_R025_100[l,j,3]-counts_array_upper_R025_100[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R025_100)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R025_100[m,j,4]<- cumulative_array_upper_R025_100[m-1,j,4]+counts_array_upper_R025_100[m,j,4]
    }
    else{
      cumulative_array_upper_R025_100[m,j,4]<-cumulative_array_upper_R025_100[m-1,j,4]+
          counts_array_upper_R025_100[m,j,4]-counts_array_upper_R025_100[m-length_of_stay[4],j,4]
      }
    }
   
  }
##########################################
cumulative_array_median_R025_75<- array(NA, dim=c(nrow(data_combined_cats_median_R025_75),ncol(data_combined_cats_median_R025_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R025_75)){
    cumulative_array_median_R025_75[1,j,]<- counts_array_median_R025_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R025_75)){
      cumulative_array_median_R025_75[i,j,1]<-cumulative_array_median_R025_75[i-1,j,1]+counts_array_median_R025_75[i,j,1]
      cumulative_array_median_R025_75[i,j,5]<-cumulative_array_median_R025_75[i-1,j,5]+counts_array_median_R025_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R025_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R025_75[k,j,2]<- cumulative_array_median_R025_75[k-1,j,2]+counts_array_median_R025_75[k,j,2]
      }
      else {
        cumulative_array_median_R025_75[k,j,2]<-cumulative_array_median_R025_75[k-1,j,2]+
          counts_array_median_R025_75[k,j,2]-counts_array_median_R025_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R025_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R025_75[l,j,3]<- cumulative_array_median_R025_75[l-1,j,3]+counts_array_median_R025_75[l,j,3]
      }
    else{
      cumulative_array_median_R025_75[l,j,3]<-cumulative_array_median_R025_75[l-1,j,3]+
          counts_array_median_R025_75[l,j,3]-counts_array_median_R025_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R025_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R025_75[m,j,4]<- cumulative_array_median_R025_75[m-1,j,4]+counts_array_median_R025_75[m,j,4]
    }
    else{
      cumulative_array_median_R025_75[m,j,4]<-cumulative_array_median_R025_75[m-1,j,4]+
          counts_array_median_R025_75[m,j,4]-counts_array_median_R025_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R025_75<- array(NA, dim=c(nrow(data_combined_cats_mean_R025_75),ncol(data_combined_cats_mean_R025_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R025_75)){
    cumulative_array_mean_R025_75[1,j,]<- counts_array_mean_R025_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R025_75)){
      cumulative_array_mean_R025_75[i,j,1]<-cumulative_array_mean_R025_75[i-1,j,1]+counts_array_mean_R025_75[i,j,1]
      cumulative_array_mean_R025_75[i,j,5]<-cumulative_array_mean_R025_75[i-1,j,5]+counts_array_mean_R025_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R025_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R025_75[k,j,2]<- cumulative_array_mean_R025_75[k-1,j,2]+counts_array_mean_R025_75[k,j,2]
      }
      else {
        cumulative_array_mean_R025_75[k,j,2]<-cumulative_array_mean_R025_75[k-1,j,2]+
          counts_array_mean_R025_75[k,j,2]-counts_array_mean_R025_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R025_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R025_75[l,j,3]<- cumulative_array_mean_R025_75[l-1,j,3]+counts_array_mean_R025_75[l,j,3]
      }
    else{
      cumulative_array_mean_R025_75[l,j,3]<-cumulative_array_mean_R025_75[l-1,j,3]+
          counts_array_mean_R025_75[l,j,3]-counts_array_mean_R025_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R025_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R025_75[m,j,4]<- cumulative_array_mean_R025_75[m-1,j,4]+counts_array_mean_R025_75[m,j,4]
    }
    else{
      cumulative_array_mean_R025_75[m,j,4]<-cumulative_array_mean_R025_75[m-1,j,4]+
          counts_array_mean_R025_75[m,j,4]-counts_array_mean_R025_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R025_75<- array(NA, dim=c(nrow(data_combined_cats_lower_R025_75),ncol(data_combined_cats_lower_R025_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R025_75)){
    cumulative_array_lower_R025_75[1,j,]<- counts_array_lower_R025_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R025_75)){
      cumulative_array_lower_R025_75[i,j,1]<-cumulative_array_lower_R025_75[i-1,j,1]+counts_array_lower_R025_75[i,j,1]
      cumulative_array_lower_R025_75[i,j,5]<-cumulative_array_lower_R025_75[i-1,j,5]+counts_array_lower_R025_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R025_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R025_75[k,j,2]<- cumulative_array_lower_R025_75[k-1,j,2]+counts_array_lower_R025_75[k,j,2]
      }
      else {
        cumulative_array_lower_R025_75[k,j,2]<-cumulative_array_lower_R025_75[k-1,j,2]+
          counts_array_lower_R025_75[k,j,2]-counts_array_lower_R025_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R025_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R025_75[l,j,3]<- cumulative_array_lower_R025_75[l-1,j,3]+counts_array_lower_R025_75[l,j,3]
      }
    else{
      cumulative_array_lower_R025_75[l,j,3]<-cumulative_array_lower_R025_75[l-1,j,3]+
          counts_array_lower_R025_75[l,j,3]-counts_array_lower_R025_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R025_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R025_75[m,j,4]<- cumulative_array_lower_R025_75[m-1,j,4]+counts_array_lower_R025_75[m,j,4]
    }
    else{
      cumulative_array_lower_R025_75[m,j,4]<-cumulative_array_lower_R025_75[m-1,j,4]+
          counts_array_lower_R025_75[m,j,4]-counts_array_lower_R025_75[m-length_of_stay[4],j,4]
      }
    }
   
}



cumulative_array_IQR_lower_R025_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_lower_R025_75),ncol(data_combined_cats_IQR_lower_R025_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_IQR_lower_R025_75)){
    cumulative_array_IQR_lower_R025_75[1,j,]<- counts_array_IQR_lower_R025_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_IQR_lower_R025_75)){
      cumulative_array_IQR_lower_R025_75[i,j,1]<-cumulative_array_IQR_lower_R025_75[i-1,j,1]+counts_array_IQR_lower_R025_75[i,j,1]
      cumulative_array_IQR_lower_R025_75[i,j,5]<-cumulative_array_IQR_lower_R025_75[i-1,j,5]+counts_array_IQR_lower_R025_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_IQR_lower_R025_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_IQR_lower_R025_75[k,j,2]<- cumulative_array_IQR_lower_R025_75[k-1,j,2]+counts_array_IQR_lower_R025_75[k,j,2]
      }
      else {
        cumulative_array_IQR_lower_R025_75[k,j,2]<-cumulative_array_IQR_lower_R025_75[k-1,j,2]+
          counts_array_IQR_lower_R025_75[k,j,2]-counts_array_IQR_lower_R025_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_IQR_lower_R025_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_IQR_lower_R025_75[l,j,3]<- cumulative_array_IQR_lower_R025_75[l-1,j,3]+counts_array_IQR_lower_R025_75[l,j,3]
      }
    else{
      cumulative_array_IQR_lower_R025_75[l,j,3]<-cumulative_array_IQR_lower_R025_75[l-1,j,3]+
          counts_array_IQR_lower_R025_75[l,j,3]-counts_array_IQR_lower_R025_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_IQR_lower_R025_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_IQR_lower_R025_75[m,j,4]<- cumulative_array_IQR_lower_R025_75[m-1,j,4]+counts_array_IQR_lower_R025_75[m,j,4]
    }
    else{
      cumulative_array_IQR_lower_R025_75[m,j,4]<-cumulative_array_IQR_lower_R025_75[m-1,j,4]+
          counts_array_IQR_lower_R025_75[m,j,4]-counts_array_IQR_lower_R025_75[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_upper_R025_75<- array(NA, dim=c(nrow(data_combined_cats_upper_R025_75),ncol(data_combined_cats_upper_R025_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R025_75)){
    cumulative_array_upper_R025_75[1,j,]<- counts_array_upper_R025_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R025_75)){
      cumulative_array_upper_R025_75[i,j,1]<-cumulative_array_upper_R025_75[i-1,j,1]+counts_array_upper_R025_75[i,j,1]
      cumulative_array_upper_R025_75[i,j,5]<-cumulative_array_upper_R025_75[i-1,j,5]+counts_array_upper_R025_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R025_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R025_75[k,j,2]<- cumulative_array_upper_R025_75[k-1,j,2]+counts_array_upper_R025_75[k,j,2]
      }
      else {
        cumulative_array_upper_R025_75[k,j,2]<-cumulative_array_upper_R025_75[k-1,j,2]+
          counts_array_upper_R025_75[k,j,2]-counts_array_upper_R025_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R025_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R025_75[l,j,3]<- cumulative_array_upper_R025_75[l-1,j,3]+counts_array_upper_R025_75[l,j,3]
      }
    else{
      cumulative_array_upper_R025_75[l,j,3]<-cumulative_array_upper_R025_75[l-1,j,3]+
          counts_array_upper_R025_75[l,j,3]-counts_array_upper_R025_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R025_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R025_75[m,j,4]<- cumulative_array_upper_R025_75[m-1,j,4]+counts_array_upper_R025_75[m,j,4]
    }
    else{
      cumulative_array_upper_R025_75[m,j,4]<-cumulative_array_upper_R025_75[m-1,j,4]+
          counts_array_upper_R025_75[m,j,4]-counts_array_upper_R025_75[m-length_of_stay[4],j,4]
      }
    }
   
  }


cumulative_array_IQR_upper_R025_75<- array(NA, dim=c(nrow(data_combined_cats_IQR_upper_R025_75),ncol(data_combined_cats_IQR_upper_R025_75),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_IQR_upper_R025_75)){
    cumulative_array_IQR_upper_R025_75[1,j,]<- counts_array_IQR_upper_R025_75[1,j,]
    
    for(i in 2:nrow(data_combined_cats_IQR_upper_R025_75)){
      cumulative_array_IQR_upper_R025_75[i,j,1]<-cumulative_array_IQR_upper_R025_75[i-1,j,1]+counts_array_IQR_upper_R025_75[i,j,1]
      cumulative_array_IQR_upper_R025_75[i,j,5]<-cumulative_array_IQR_upper_R025_75[i-1,j,5]+counts_array_IQR_upper_R025_75[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_IQR_upper_R025_75)){
      if(k<=length_of_stay[2]){
      cumulative_array_IQR_upper_R025_75[k,j,2]<- cumulative_array_IQR_upper_R025_75[k-1,j,2]+counts_array_IQR_upper_R025_75[k,j,2]
      }
      else {
        cumulative_array_IQR_upper_R025_75[k,j,2]<-cumulative_array_IQR_upper_R025_75[k-1,j,2]+
          counts_array_IQR_upper_R025_75[k,j,2]-counts_array_IQR_upper_R025_75[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_IQR_upper_R025_75)){
      if(l <= length_of_stay[3]){
        cumulative_array_IQR_upper_R025_75[l,j,3]<- cumulative_array_IQR_upper_R025_75[l-1,j,3]+counts_array_IQR_upper_R025_75[l,j,3]
      }
    else{
      cumulative_array_IQR_upper_R025_75[l,j,3]<-cumulative_array_IQR_upper_R025_75[l-1,j,3]+
          counts_array_IQR_upper_R025_75[l,j,3]-counts_array_IQR_upper_R025_75[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_IQR_upper_R025_75)){
    if(m<=length_of_stay[4]){
      cumulative_array_IQR_upper_R025_75[m,j,4]<- cumulative_array_IQR_upper_R025_75[m-1,j,4]+counts_array_IQR_upper_R025_75[m,j,4]
    }
    else{
      cumulative_array_IQR_upper_R025_75[m,j,4]<-cumulative_array_IQR_upper_R025_75[m-1,j,4]+
          counts_array_IQR_upper_R025_75[m,j,4]-counts_array_IQR_upper_R025_75[m-length_of_stay[4],j,4]
      }
    }
   
  }
#######################################
cumulative_array_median_R025_50<- array(NA, dim=c(nrow(data_combined_cats_median_R025_50),ncol(data_combined_cats_median_R025_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_median_R025_50)){
    cumulative_array_median_R025_50[1,j,]<- counts_array_median_R025_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_median_R025_50)){
      cumulative_array_median_R025_50[i,j,1]<-cumulative_array_median_R025_50[i-1,j,1]+counts_array_median_R025_50[i,j,1]
      cumulative_array_median_R025_50[i,j,5]<-cumulative_array_median_R025_50[i-1,j,5]+counts_array_median_R025_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_median_R025_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_median_R025_50[k,j,2]<- cumulative_array_median_R025_50[k-1,j,2]+counts_array_median_R025_50[k,j,2]
      }
      else {
        cumulative_array_median_R025_50[k,j,2]<-cumulative_array_median_R025_50[k-1,j,2]+
          counts_array_median_R025_50[k,j,2]-counts_array_median_R025_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_median_R025_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_median_R025_50[l,j,3]<- cumulative_array_median_R025_50[l-1,j,3]+counts_array_median_R025_50[l,j,3]
      }
    else{
      cumulative_array_median_R025_50[l,j,3]<-cumulative_array_median_R025_50[l-1,j,3]+
          counts_array_median_R025_50[l,j,3]-counts_array_median_R025_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_median_R025_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_median_R025_50[m,j,4]<- cumulative_array_median_R025_50[m-1,j,4]+counts_array_median_R025_50[m,j,4]
    }
    else{
      cumulative_array_median_R025_50[m,j,4]<-cumulative_array_median_R025_50[m-1,j,4]+
          counts_array_median_R025_50[m,j,4]-counts_array_median_R025_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_mean_R025_50<- array(NA, dim=c(nrow(data_combined_cats_mean_R025_50),ncol(data_combined_cats_mean_R025_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_mean_R025_50)){
    cumulative_array_mean_R025_50[1,j,]<- counts_array_mean_R025_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_mean_R025_50)){
      cumulative_array_mean_R025_50[i,j,1]<-cumulative_array_mean_R025_50[i-1,j,1]+counts_array_mean_R025_50[i,j,1]
      cumulative_array_mean_R025_50[i,j,5]<-cumulative_array_mean_R025_50[i-1,j,5]+counts_array_mean_R025_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_mean_R025_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_mean_R025_50[k,j,2]<- cumulative_array_mean_R025_50[k-1,j,2]+counts_array_mean_R025_50[k,j,2]
      }
      else {
        cumulative_array_mean_R025_50[k,j,2]<-cumulative_array_mean_R025_50[k-1,j,2]+
          counts_array_mean_R025_50[k,j,2]-counts_array_mean_R025_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_mean_R025_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_mean_R025_50[l,j,3]<- cumulative_array_mean_R025_50[l-1,j,3]+counts_array_mean_R025_50[l,j,3]
      }
    else{
      cumulative_array_mean_R025_50[l,j,3]<-cumulative_array_mean_R025_50[l-1,j,3]+
          counts_array_mean_R025_50[l,j,3]-counts_array_mean_R025_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_mean_R025_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_mean_R025_50[m,j,4]<- cumulative_array_mean_R025_50[m-1,j,4]+counts_array_mean_R025_50[m,j,4]
    }
    else{
      cumulative_array_mean_R025_50[m,j,4]<-cumulative_array_mean_R025_50[m-1,j,4]+
          counts_array_mean_R025_50[m,j,4]-counts_array_mean_R025_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_lower_R025_50<- array(NA, dim=c(nrow(data_combined_cats_lower_R025_50),ncol(data_combined_cats_lower_R025_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_lower_R025_50)){
    cumulative_array_lower_R025_50[1,j,]<- counts_array_lower_R025_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_lower_R025_50)){
      cumulative_array_lower_R025_50[i,j,1]<-cumulative_array_lower_R025_50[i-1,j,1]+counts_array_lower_R025_50[i,j,1]
      cumulative_array_lower_R025_50[i,j,5]<-cumulative_array_lower_R025_50[i-1,j,5]+counts_array_lower_R025_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_lower_R025_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_lower_R025_50[k,j,2]<- cumulative_array_lower_R025_50[k-1,j,2]+counts_array_lower_R025_50[k,j,2]
      }
      else {
        cumulative_array_lower_R025_50[k,j,2]<-cumulative_array_lower_R025_50[k-1,j,2]+
          counts_array_lower_R025_50[k,j,2]-counts_array_lower_R025_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_lower_R025_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_lower_R025_50[l,j,3]<- cumulative_array_lower_R025_50[l-1,j,3]+counts_array_lower_R025_50[l,j,3]
      }
    else{
      cumulative_array_lower_R025_50[l,j,3]<-cumulative_array_lower_R025_50[l-1,j,3]+
          counts_array_lower_R025_50[l,j,3]-counts_array_lower_R025_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_lower_R025_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_lower_R025_50[m,j,4]<- cumulative_array_lower_R025_50[m-1,j,4]+counts_array_lower_R025_50[m,j,4]
    }
    else{
      cumulative_array_lower_R025_50[m,j,4]<-cumulative_array_lower_R025_50[m-1,j,4]+
          counts_array_lower_R025_50[m,j,4]-counts_array_lower_R025_50[m-length_of_stay[4],j,4]
      }
    }
   
}


cumulative_array_upper_R025_50<- array(NA, dim=c(nrow(data_combined_cats_upper_R025_50),ncol(data_combined_cats_upper_R025_50),ncol(prob_matrix)))


  for(j in 1:ncol(data_combined_cats_upper_R025_50)){
    cumulative_array_upper_R025_50[1,j,]<- counts_array_upper_R025_50[1,j,]
    
    for(i in 2:nrow(data_combined_cats_upper_R025_50)){
      cumulative_array_upper_R025_50[i,j,1]<-cumulative_array_upper_R025_50[i-1,j,1]+counts_array_upper_R025_50[i,j,1]
      cumulative_array_upper_R025_50[i,j,5]<-cumulative_array_upper_R025_50[i-1,j,5]+counts_array_upper_R025_50[i,j,5]
    }

    for(k in 2:nrow(data_combined_cats_upper_R025_50)){
      if(k<=length_of_stay[2]){
      cumulative_array_upper_R025_50[k,j,2]<- cumulative_array_upper_R025_50[k-1,j,2]+counts_array_upper_R025_50[k,j,2]
      }
      else {
        cumulative_array_upper_R025_50[k,j,2]<-cumulative_array_upper_R025_50[k-1,j,2]+
          counts_array_upper_R025_50[k,j,2]-counts_array_upper_R025_50[k-length_of_stay[2],j,2]
      }
    }
  for(l in 2:nrow(data_combined_cats_upper_R025_50)){
      if(l <= length_of_stay[3]){
        cumulative_array_upper_R025_50[l,j,3]<- cumulative_array_upper_R025_50[l-1,j,3]+counts_array_upper_R025_50[l,j,3]
      }
    else{
      cumulative_array_upper_R025_50[l,j,3]<-cumulative_array_upper_R025_50[l-1,j,3]+
          counts_array_upper_R025_50[l,j,3]-counts_array_upper_R025_50[l-length_of_stay[3],j,3]
    }
  }
    for(m in 2:nrow(data_combined_cats_upper_R025_50)){
    if(m<=length_of_stay[4]){
      cumulative_array_upper_R025_50[m,j,4]<- cumulative_array_upper_R025_50[m-1,j,4]+counts_array_upper_R025_50[m,j,4]
    }
    else{
      cumulative_array_upper_R025_50[m,j,4]<-cumulative_array_upper_R025_50[m-1,j,4]+
          counts_array_upper_R025_50[m,j,4]-counts_array_upper_R025_50[m-length_of_stay[4],j,4]
      }
    }
   
  }
#########################################


```


The three potential transmission scenarios for planning purposes fall within the 95% confidence interval of the curent range of estimates for COVID-19 (https://github.com/midas-network/COVID-19/tree/master/parameter_estimates/2019_novel_coronavirus). We consider the following:

1. **Low transmission** based on transmission levels in many of the Chinese provinces with elevated isolation and control practices (R~0~ = 1.7)

2. **Moderate transmission** that mirrors estimates in the early stages of the outbreak in Wuhan, China (R~0~ = 2.1)

3. **High transmission** where we assume a scaling factor to mimick higher transmission in an urban setting compared to open community settings (R~0~ = 2.5)



##### Daily incident symptomatic cases across all age groups

```{r, include=FALSE, eval=TRUE}
#Figure 1

incident_cases_R017_75<- apply(data_combined_cats_median_R017_75,1,sum)
incident_cases_R021_75<- apply(data_combined_cats_median_R021_75,1,sum)
incident_cases_R025_75<- apply(data_combined_cats_median_R025_75,1,sum)
incident_cases_lower_R017_75<- apply(data_combined_cats_IQR_lower_R017_75,1,sum)
incident_cases_upper_R017_75<- apply(data_combined_cats_IQR_upper_R017_75,1,sum)
incident_cases_lower_R021_75<- apply(data_combined_cats_IQR_lower_R021_75,1,sum)
incident_cases_upper_R021_75<- apply(data_combined_cats_IQR_upper_R021_75,1,sum)
incident_cases_lower_R025_75<- apply(data_combined_cats_IQR_lower_R025_75,1,sum)
incident_cases_upper_R025_75<- apply(data_combined_cats_IQR_upper_R025_75,1,sum)

wide_incident_cases<- as.data.frame(cbind(rep(1:length(incident_cases_R017_75)),
                      incident_cases_R017_75,incident_cases_R021_75,incident_cases_R025_75))
                      
wide_bounds_lower<- as.data.frame(cbind(rep(1:length(incident_cases_R017_75)),
                        incident_cases_lower_R017_75,
                        incident_cases_lower_R021_75,
                        incident_cases_lower_R025_75))

wide_bounds_upper<- as.data.frame(cbind(rep(1:length(incident_cases_R017_75)),
                    incident_cases_upper_R017_75,incident_cases_upper_R021_75,
                    incident_cases_upper_R025_75))

colnames(wide_incident_cases)<- c("Day","R_0=1.7","R_0=2.1","R_0=2.5")

colnames(wide_bounds_lower)<- c("Day","lower_R_0=1.7","lower_R_0=2.1", "lower_R_0=2.5")

colnames(wide_bounds_upper)<- c("Day","upper_R_0=1.7","upper_R_0=2.1","upper_R_0=2.5")

long_incident_cases<- gather(wide_incident_cases,scenario, incident_cases,
                             "R_0=1.7":"R_0=2.5", factor_key=TRUE)

long_bounds_lower<- gather(wide_bounds_lower,scenario, incident_lower,
                     "lower_R_0=1.7":"lower_R_0=2.5")
long_bounds_upper<- gather(wide_bounds_upper,scenario, incident_upper,
                     "upper_R_0=1.7":"upper_R_0=2.5")

combined_long_matrix<- as.data.frame(cbind(long_incident_cases,long_bounds_lower$incident_lower,
                                           long_bounds_upper$incident_upper))

colnames(combined_long_matrix)<- c("Day", "scenario","incident_cases","lower","upper")

combined_long_matrix<-combined_long_matrix%>%
  mutate(lower=ifelse(incident_cases==0,0,lower)) %>%
  dplyr::mutate(scenario=recode(scenario, 
                                "R_0=1.7"="Low transmission",
                                "R_0=2.1"="Moderate transmission",
                                "R_0=2.5"="High transmission"))

fig_nums(name = paste0("fig-one"), caption = paste("Plot of the median number of incident cases across simulations and interquartile range (IQR) by day for each transmission scenario. These estimates are summed across all age groups."), display = "false")
```

`r fig_nums("fig-one", display = "full")`

```{r, fig-one, fig.dim = c(7,4)}
plt_incident_cases<- ggplot(combined_long_matrix)+ 
  geom_line(aes(y= incident_cases, x=Day,color=scenario))+
  geom_ribbon(aes(ymax=upper,ymin=lower,x=Day,fill=scenario), alpha=.5) +
  labs(title="Incident Symptomatic Cases Per Day",y="Median Number of Cases") +
  labs(color="Scenario", fill="Scenario") 
  
plt_incident_cases

```


##### Daily incident hospitalizations across all age groups

```{r, include=FALSE, eval=TRUE}
#Figure 2

incident_hosp_R017_75<- apply(counts_array_median_R017_75[,,2],1,sum)
incident_hosp_R021_75<- apply(counts_array_median_R021_75[,,2],1,sum)
incident_hosp_R025_75<- apply(counts_array_median_R025_75[,,2],1,sum)
incident_hosp_lower_R017_75<- apply(counts_array_IQR_lower_R017_75[,,2],1,sum)
incident_hosp_upper_R017_75<- apply(counts_array_IQR_upper_R017_75[,,2],1,sum)
incident_hosp_lower_R021_75<- apply(counts_array_IQR_lower_R021_75[,,2],1,sum)
incident_hosp_upper_R021_75<- apply(counts_array_IQR_upper_R021_75[,,2],1,sum)
incident_hosp_lower_R025_75<- apply(counts_array_IQR_lower_R025_75[,,2],1,sum)
incident_hosp_upper_R025_75<- apply(counts_array_IQR_upper_R025_75[,,2],1,sum)

wide_hosp_cases<- as.data.frame(cbind(rep(1:length(incident_hosp_R017_75)),
                      incident_hosp_R017_75,incident_hosp_R021_75,incident_hosp_R025_75))
                      
wide_bounds_lower<- as.data.frame(cbind(rep(1:length(incident_hosp_R017_75)),
                        incident_hosp_lower_R017_75,
                        incident_hosp_lower_R021_75,
                        incident_hosp_lower_R025_75))

wide_bounds_upper<- as.data.frame(cbind(rep(1:length(incident_hosp_R017_75)),
                    incident_hosp_upper_R017_75,incident_hosp_upper_R021_75,
                    incident_hosp_upper_R025_75))
colnames(wide_hosp_cases)<- c("Day","R_0=1.7","R_0=2.1","R_0=2.5")

colnames(wide_bounds_lower)<- c("Day","lower_R_0=1.7","lower_R_0=2.1", "lower_R_0=2.5")

colnames(wide_bounds_upper)<- c("Day","upper_R_0=1.7","upper_R_0=2.1","upper_R_0=2.5")

long_incident_cases<- gather(wide_hosp_cases,scenario, incident_cases,
                             "R_0=1.7":"R_0=2.5", factor_key=TRUE)

long_bounds_lower<- gather(wide_bounds_lower,scenario, incident_lower,
                     "lower_R_0=1.7":"lower_R_0=2.5")
long_bounds_upper<- gather(wide_bounds_upper,scenario, incident_upper,
                     "upper_R_0=1.7":"upper_R_0=2.5")

combined_long_matrix<- as.data.frame(cbind(long_incident_cases,long_bounds_lower$incident_lower,
                                           long_bounds_upper$incident_upper))

colnames(combined_long_matrix)<- c("Day", "scenario","incident_cases","lower","upper")

combined_long_matrix<-combined_long_matrix%>%
  mutate(lower=ifelse(incident_cases==0,0,lower)) %>%
  dplyr::mutate(scenario=recode(scenario, 
                                "R_0=1.7"="Low transmission",
                                "R_0=2.1"="Moderate transmission",
                                "R_0=2.5"="High transmission"))

fig_nums(name = paste0("fig-two"), caption = paste("Plot of the median number of incident hospitalizations across simulations and interquartile range (IQR) by day for each transmission scenario. These estimates are summed across all age groups."), display = "false")
```

`r fig_nums("fig-two", display = "full")`

```{r, fig-two, fig.dim = c(7,4)}
plt_hosp_cases <- ggplot(combined_long_matrix)+ 
  geom_line(aes(y= incident_cases, x=Day,color=scenario))+
  geom_ribbon(aes(ymax=upper,ymin=lower,x=Day,fill=scenario), alpha=.5) +
  labs(title="Incident Hospitalizations Per Day", y="Median Number of Hospitalized Cases") +
  labs(color="Scenario", fill="Scenario") 

plt_hosp_cases

```




##### Daily incident deaths across all age groups

```{r, include=FALSE, eval=TRUE}
#Figure 3

incident_death_R017_75<- apply(counts_array_median_R017_75[,,5],1,sum)
incident_death_R021_75<- apply(counts_array_median_R021_75[,,5],1,sum)
incident_death_R025_75<- apply(counts_array_median_R025_75[,,5],1,sum)
incident_death_lower_R017_75<- apply(counts_array_IQR_lower_R017_75[,,5],1,sum)
incident_death_upper_R017_75<- apply(counts_array_IQR_upper_R017_75[,,5],1,sum)
incident_death_lower_R021_75<- apply(counts_array_IQR_lower_R021_75[,,5],1,sum)
incident_death_upper_R021_75<- apply(counts_array_IQR_upper_R021_75[,,5],1,sum)
incident_death_lower_R025_75<- apply(counts_array_IQR_lower_R025_75[,,5],1,sum)
incident_death_upper_R025_75<- apply(counts_array_IQR_upper_R025_75[,,5],1,sum)

wide_death_cases<- as.data.frame(cbind(rep(1:length(incident_death_R017_75)),
                      incident_death_R017_75,incident_death_R021_75,incident_death_R025_75))
                      
wide_bounds_lower<- as.data.frame(cbind(rep(1:length(incident_death_R017_75)),
                        incident_death_lower_R017_75,
                        incident_death_lower_R021_75,
                        incident_death_lower_R025_75))

wide_bounds_upper<- as.data.frame(cbind(rep(1:length(incident_death_R017_75)),
                    incident_death_upper_R017_75,incident_death_upper_R021_75,
                    incident_death_upper_R025_75))

colnames(wide_death_cases)<- c("Day","R_0=1.7","R_0=2.1","R_0=2.5")

colnames(wide_bounds_lower)<- c("Day","lower_R_0=1.7","lower_R_0=2.1", "lower_R_0=2.5")

colnames(wide_bounds_upper)<- c("Day","upper_R_0=1.7","upper_R_0=2.1","upper_R_0=2.5")

long_incident_cases<- gather(wide_death_cases,scenario, incident_cases,
                             "R_0=1.7":"R_0=2.5", factor_key=TRUE)

long_bounds_lower<- gather(wide_bounds_lower,scenario, incident_lower,
                     "lower_R_0=1.7":"lower_R_0=2.5")
long_bounds_upper<- gather(wide_bounds_upper,scenario, incident_upper,
                     "upper_R_0=1.7":"upper_R_0=2.5")

combined_long_matrix<- as.data.frame(cbind(long_incident_cases,long_bounds_lower$incident_lower,
                                           long_bounds_upper$incident_upper))

colnames(combined_long_matrix)<- c("Day", "scenario","incident_cases","lower","upper")

combined_long_matrix<-combined_long_matrix%>%
  mutate(lower=ifelse(incident_cases==0,0,lower)) %>%
  dplyr::mutate(scenario=recode(scenario, 
                                "R_0=1.7"="Low transmission",
                                "R_0=2.1"="Moderate transmission",
                                "R_0=2.5"="High transmission"))

fig_nums(name = paste0("fig-three"), caption = paste("Plot of the median number of deaths across simulations and interquartile range (IQR) by day for each transmission scenario. These estimates are summed across all age groups."), display = "false")
```

`r fig_nums("fig-three", display = "full")`

```{r, fig-three, fig.dim = c(7,4)}
plt_death_cases<- ggplot(combined_long_matrix)+ 
  geom_line(aes(y= incident_cases, x=Day,color=scenario))+
  geom_ribbon(aes(ymax=upper,ymin=lower,x=Day,fill=scenario), alpha=.5) +
  labs(title="Incident Deaths Per Day", y="Median Number of Deaths") +
  labs(color="Scenario", fill="Scenario") 

plt_death_cases

```

##### Cumulative number of hospitalizations

```{r, include=FALSE, eval=TRUE}

cumulative_symptomatic_cases_R017<- matrix(NA, nrow(data_combined_cats_median_R017_75), ncol=ncol(data_combined_cats_median_R017_75))

for(i in 1:ncol(cumulative_symptomatic_cases_R017)){
  cumulative_symptomatic_cases_R017[1,i]<- data_combined_cats_median_R017_75[1,i]
  for(j in 2:nrow(cumulative_symptomatic_cases_R017)){
    cumulative_symptomatic_cases_R017[j,i]<- cumulative_symptomatic_cases_R017[(j-1),i]+data_combined_cats_median_R017_75[(j),i]
  }
}


cumulative_symptomatic_cases_R021<- matrix(NA, nrow(data_combined_cats_median_R021_75), ncol=ncol(data_combined_cats_median_R021_75))

for(i in 1:ncol(cumulative_symptomatic_cases_R021)){
  cumulative_symptomatic_cases_R021[1,i]<- data_combined_cats_median_R021_75[1,i]
  for(j in 2:nrow(cumulative_symptomatic_cases_R021)){
    cumulative_symptomatic_cases_R021[j,i]<- cumulative_symptomatic_cases_R021[(j-1),i]+data_combined_cats_median_R021_75[(j),i]
  }
}

cumulative_symptomatic_cases_R025<- matrix(NA, nrow(data_combined_cats_median_R025_75), ncol=ncol(data_combined_cats_median_R025_75))

for(i in 1:ncol(cumulative_symptomatic_cases_R025)){
  cumulative_symptomatic_cases_R025[1,i]<- data_combined_cats_median_R025_75[1,i]
  for(j in 2:nrow(cumulative_symptomatic_cases_R025)){
    cumulative_symptomatic_cases_R025[j,i]<- cumulative_symptomatic_cases_R025[(j-1),i]+data_combined_cats_median_R025_75[(j),i]
  }
}

cumulative_symptomatic_cases<- as.data.frame(cbind(rep(1:nrow(data_combined_cats_median_R017_75)),
                                              apply(cumulative_symptomatic_cases_R017,1,sum),
                                              apply(cumulative_symptomatic_cases_R021,1,sum),
                                              apply(cumulative_symptomatic_cases_R025,1,sum)))

colnames(cumulative_symptomatic_cases)<- c("Day", "R_0=1.7","R_0=2.1", "R_0=2.5")

cumulative_symptomatic_cases_long<- gather(cumulative_symptomatic_cases, scenario, num_cases,
                                           "R_0=1.7":"R_0=2.5",factor_key=TRUE)

plt_cumulative_symptomatic<- ggplot(cumulative_symptomatic_cases_long)+
  geom_line(aes(x= Day, y= num_cases, color=scenario))+
  labs(y="Number of Symptomatic Cases", title="Median Number of Symptomatic Cases")

#plt_cumulative_symptomatic

######################


cumulative_hosp_cases<- as.data.frame(cbind(rep(1:nrow(data_combined_cats_median_R017_75)),
                                              apply(cumulative_array_median_R017_75[,,1],1,sum),
                                              apply(cumulative_array_median_R021_75[,,1],1,sum),
                                              apply(cumulative_array_median_R025_75[,,1],1,sum)))

colnames(cumulative_hosp_cases)<- c("Day", "R_0=1.7","R_0=2.1", "R_0=2.5")

cumulative_hosp_cases_long<- gather(cumulative_hosp_cases, scenario, num_cases,
                                           "R_0=1.7":"R_0=2.5",factor_key=TRUE) %>% dplyr::mutate(scenario=recode(scenario, 
                                "R_0=1.7"="Low transmission",
                                "R_0=2.1"="Moderate transmission",
                                "R_0=2.5"="High transmission"))
  
plt_cumulative_hosp<- ggplot(cumulative_hosp_cases_long)+
  geom_line(aes(x= Day, y= num_cases, color=str_wrap(scenario,10)))+
  labs(y="Number of Hospitalizations", title="Cumulative Hospitalizations") + labs(color="Scenario")

plt_A <- plt_cumulative_hosp

#############################

cumulative_hosp_cases_R017<- as.data.frame(cbind(rep(1:nrow(data_combined_cats_median_R017_75)),
                                              cumulative_array_median_R017_75[,,1]))

colnames(cumulative_hosp_cases_R017)<- c("Day","Age0-19",
                                      "Age20-44", "Age45-54", "Age55-74", "Age75+",
                                      "HCW", "Homeless" )

cumulative_hosp_R017_long<- gather(cumulative_hosp_cases_R017, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_hosp_R017<- ggplot(cumulative_hosp_R017_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of Hospitalizations", title="Low transmission") + ylim(0,2000) + labs(color="Age group")

plt_B <- plt_cumulative_hosp_R017


cumulative_hosp_cases_R021<- as.data.frame(cbind(rep(1:nrow(data_combined_cats_median_R021_75)),
                                              cumulative_array_median_R021_75[,,1]))

colnames(cumulative_hosp_cases_R021)<- c("Day","Age0-19",
                                      "Age20-44", "Age45-54", "Age55-74", "Age75+",
                                      "HCW", "Homeless" )

cumulative_hosp_R021_long<- gather(cumulative_hosp_cases_R021, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_hosp_R021<- ggplot(cumulative_hosp_R021_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of Hospitalizations", title="Moderate transmission") + ylim(0,2000) + labs(color="Age group")

plt_C <- plt_cumulative_hosp_R021

cumulative_hosp_cases_R025<- as.data.frame(cbind(rep(1:nrow(data_combined_cats_median_R025_75)),
                                              cumulative_array_median_R025_75[,,1]))

colnames(cumulative_hosp_cases_R025)<- c("Day","Age0-19",
                                      "Age20-44", "Age45-54", "Age55-74", "Age75+",
                                      "HCW", "Homeless" )

cumulative_hosp_R025_long<- gather(cumulative_hosp_cases_R025, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_hosp_R025<- ggplot(cumulative_hosp_R025_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of Hospitalizations", title="High transmission") + ylim(0,2000) + labs(color="Age group")

plt_D <- plt_cumulative_hosp_R025

fig_nums(name = paste0("fig-four"), caption = paste("A. Plot of cumulative number of incident hospitalizations by day for each transmission scenario (median). B. Plot of cumulative number of incident hospitalizations for the low transmission scenario by age category. C. Plot of cumulative number of incident hospitalizations for the moderate transmission scenario by age category. B. Plot of cumulative number of incident hospitalizations for the high transmission scenario by age category."), display = "false")

```

`r fig_nums("fig-four", display = "full")`

```{r, fig-four, fig.dim = c(9,6.8)}

plt1 <- cowplot::plot_grid(plt_B, plt_C, plt_D, labels=c('B','C','D'), align = "h", ncol=3)
plt <- cowplot::plot_grid(plt_A, plt1, labels=c('A',''), align = "h", nrow=2)
print(plt)

```

##### Cumulative number of deaths

```{r, include=FALSE, eval=TRUE}

cumulative_deaths<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,5])),
                    apply(cumulative_array_median_R017_75[,,5],1,sum),
                    apply(cumulative_array_median_R021_75[,,5],1,sum),
                    apply(cumulative_array_median_R025_75[,,5],1,sum)))

colnames(cumulative_deaths)<- c("Day","R_0=1.7","R_0=2.1","R_0=2.5")

long_cumulative_deaths<- gather(cumulative_deaths,scenario, num_cases,
                             "R_0=1.7":"R_0=2.5", factor_key=TRUE) %>% dplyr::mutate(scenario=recode(scenario, 
                                "R_0=1.7"="Low transmission",
                                "R_0=2.1"="Moderate transmission",
                                "R_0=2.5"="High transmission"))

plt_cumulative_death<- ggplot(long_cumulative_deaths)+ 
  geom_line(aes(y= num_cases, x=Day,color=str_wrap(scenario,10)))+
  labs(title="Cumulative Deaths",
       y="Number of Deaths") + labs(color="Scenario") + labs(color="Scenario")

plt_A <- plt_cumulative_death

#######################


cumulative_deaths_R_017<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,5])),
                                        cumulative_array_median_R017_75[,,5]))


colnames(cumulative_deaths_R_017)<- c('Day', "Age0-19",
                                     "Age20-44", "Age45-54", "Age55-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_deaths_R_017_long<- gather(cumulative_deaths_R_017, age_group, cumulative_deaths,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_death_by_R_017<- ggplot(cumulative_deaths_R_017_long)+
  geom_line(aes(x=Day,y=cumulative_deaths,color=age_group))+
  labs(y="Number of Deaths", title="Low transmission") + labs(color="Age group") + ylim(0,560)

plt_B <- plt_cumulative_death_by_R_017

######################

cumulative_deaths_R_021<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,5])),
                                        cumulative_array_median_R021_75[,,5]))


colnames(cumulative_deaths_R_021)<- c('Day', "Age0-19",
                                      "Age20-44", "Age45-54", "Age55-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_deaths_R_021_long<- gather(cumulative_deaths_R_021, age_group, cumulative_deaths,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_death_by_R_021<- ggplot(cumulative_deaths_R_021_long)+
  geom_line(aes(x=Day,y=cumulative_deaths,color=age_group))+
  labs(y="Number of Deaths", title="Moderate transmission") + labs(color="Age group") + ylim(0,560)

plt_C <- plt_cumulative_death_by_R_021

###########################


cumulative_deaths_R_025<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,5])),
                                        cumulative_array_median_R025_75[,,5]))


colnames(cumulative_deaths_R_025)<- c('Day', "Age0-19",
                                      "Age20-44", "Age45-54", "Age55-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_deaths_R_025_long<- gather(cumulative_deaths_R_025, age_group, cumulative_deaths,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_death_by_R_025<- ggplot(cumulative_deaths_R_025_long)+
  geom_line(aes(x=Day,y=cumulative_deaths,color=age_group))+
  labs(y="Number of Deaths", title="High transmission") + labs(color="Age group") + ylim(0,560)

plt_D <- plt_cumulative_death_by_R_025

fig_nums(name = paste0("fig-five"), caption = paste("A. Plot of cumulative number of incident deaths by day for each transmission scenario (median). B. Plot of cumulative number of incident deaths for the low transmission scenario by age category. C. Plot of cumulative number of incident deaths for the moderate transmission scenario by age category. B. Plot of cumulative number of incident deaths for the high transmission scenario by age category."), display = "false")
```

`r fig_nums("fig-five", display = "full")`

```{r, fig-five, fig.dim = c(9,6.8)}

plt1 <- cowplot::plot_grid(plt_B, plt_C, plt_D, labels=c('B','C','D'), align = "h", ncol=3)
plt <- cowplot::plot_grid(plt_A, plt1, labels=c('A',''), align = "h", nrow=2)
print(plt)

```

##### Daily hospital, ICU, ventilator capacity needed 

```{r, include=FALSE, eval=TRUE}

cumulative_hosp_R_017<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,2])),
                                        cumulative_array_median_R017_75[,,2]))


colnames(cumulative_hosp_R_017)<- c('Day', "Age0-19",
                                      "Age20-44", "Age45-54", "Age55-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_hosp_R_017_long<- gather(cumulative_hosp_R_017, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_hosp_by_R_017<- ggplot(cumulative_hosp_R_017_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of hospital beds in use per day", title="Low transmission") + ylim(0,360) + labs(color="Age group")

plt_A<-plt_cumulative_hosp_by_R_017

cumulative_hosp_R_021<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R021_75[,,2])),
                                        cumulative_array_median_R021_75[,,2]))


colnames(cumulative_hosp_R_021)<- c('Day', "Age0-19",
                                      "Age20-44", "Age45-54", "Age55-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_hosp_R_021_long<- gather(cumulative_hosp_R_021, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_hosp_by_R_021<- ggplot(cumulative_hosp_R_021_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of hospital beds in use per day", title="Moderate transmission") + ylim(0,360) + labs(color="Age group")

plt_B<-plt_cumulative_hosp_by_R_021

cumulative_hosp_R_025<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R025_75[,,2])),
                                        cumulative_array_median_R025_75[,,2]))


colnames(cumulative_hosp_R_025)<- c('Day', "Age0-19",
                                      "Age20-44", "Age45-54", "Age55-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_hosp_R_025_long<- gather(cumulative_hosp_R_025, age_group, cumulative_hosp,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_hosp_by_R_025<- ggplot(cumulative_hosp_R_025_long)+
  geom_line(aes(x=Day,y=cumulative_hosp,color=age_group))+
  labs(y="Number of hospital beds in use per day", title="High transmission") + ylim(0,360) + labs(color="Age group")

plt_C<-plt_cumulative_hosp_by_R_025

############
cumulative_ICU_R_017<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,3])),
                                        cumulative_array_median_R017_75[,,3]))


colnames(cumulative_ICU_R_017)<- c('Day', "Age0-19",
                                      "Age20-44", "Age45-54", "Age55-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_ICU_R_017_long<- gather(cumulative_ICU_R_017, age_group, cumulative_ICU,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_ICU_by_R_017<- ggplot(cumulative_ICU_R_017_long)+
  geom_line(aes(x=Day,y=cumulative_ICU,color=age_group))+
  labs(y="Number of ICU beds in use per day", title="Low transmission") + ylim(0,200) + labs(color="Age group")

plt_D<-plt_cumulative_ICU_by_R_017

cumulative_ICU_R_021<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R021_75[,,3])),
                                        cumulative_array_median_R021_75[,,3]))


colnames(cumulative_ICU_R_021)<- c('Day', "Age0-19",
                                      "Age20-44", "Age45-54", "Age55-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_ICU_R_021_long<- gather(cumulative_ICU_R_021, age_group, cumulative_ICU,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_ICU_by_R_021<- ggplot(cumulative_ICU_R_021_long)+
  geom_line(aes(x=Day,y=cumulative_ICU,color=age_group))+
  labs(y="Number of ICU beds in use per day", title="Moderate transmission") + ylim(0,200) + labs(color="Age group")

plt_E<-plt_cumulative_ICU_by_R_021

cumulative_ICU_R_025<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R025_75[,,3])),
                                        cumulative_array_median_R025_75[,,3]))


colnames(cumulative_ICU_R_025)<- c('Day', "Age0-19",
                                      "Age20-44", "Age45-54", "Age55-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_ICU_R_025_long<- gather(cumulative_ICU_R_025, age_group, cumulative_ICU,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_ICU_by_R_025<- ggplot(cumulative_ICU_R_025_long)+
  geom_line(aes(x=Day,y=cumulative_ICU,color=age_group))+
  labs(y="Number of ICU beds in use per day", title="High transmission") + ylim(0,200) + labs(color="Age group")

plt_F<-plt_cumulative_ICU_by_R_025

##################

cumulative_vent_R_017<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R017_75[,,4])),
                                        cumulative_array_median_R017_75[,,4]))


colnames(cumulative_vent_R_017)<- c('Day', "Age0-19",
                                      "Age20-44", "Age45-54", "Age55-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_vent_R_017_long<- gather(cumulative_vent_R_017, age_group, cumulative_vent,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_vent_by_R_017<- ggplot(cumulative_vent_R_017_long)+
  geom_line(aes(x=Day,y=cumulative_vent,color=age_group))+
  labs(y="Number of vents in use per day", title="Low transmission") + ylim(0,150) + labs(color="Age group")

plt_G <-plt_cumulative_vent_by_R_017

cumulative_vent_R_021<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R021_75[,,4])),
                                        cumulative_array_median_R021_75[,,4]))


colnames(cumulative_vent_R_021)<- c('Day', "Age0-19",
                                      "Age20-44", "Age45-54", "Age55-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_vent_R_021_long<- gather(cumulative_vent_R_021, age_group, cumulative_vent,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_vent_by_R_021<- ggplot(cumulative_vent_R_021_long)+
  geom_line(aes(x=Day,y=cumulative_vent,color=age_group))+
  labs(y="Number of vents in use per day", title="Moderate transmission") + ylim(0,150) + labs(color="Age group")

plt_H <-plt_cumulative_vent_by_R_021

cumulative_vent_R_025<- as.data.frame(cbind(rep(1:nrow(cumulative_array_median_R025_75[,,4])),
                                        cumulative_array_median_R025_75[,,4]))


colnames(cumulative_vent_R_025)<- c('Day', "Age0-19",
                                      "Age20-44", "Age45-54", "Age55-74", "Age75+",
                                      "HCW", "Homeless")

cumulative_vent_R_025_long<- gather(cumulative_vent_R_025, age_group, cumulative_vent,
                                      "Age0-19":"Homeless",factor_key=TRUE)

plt_cumulative_vent_by_R_025<- ggplot(cumulative_vent_R_025_long)+
  geom_line(aes(x=Day,y=cumulative_vent,color=age_group))+
  labs(y="Number of vents in use per day", title="High transmission") + ylim(0,150) + labs(color="Age group")

plt_I <- plt_cumulative_vent_by_R_025

fig_nums(name = paste0("fig-six"), caption = paste("A,B,C. Plots of daily hospital beds needed by transmission scenario and age category. D,E,F. Plots of daily ICU beds needed by transmission scenario and age category. G,H,I. Plots of daily ventilators needed by transmission scenario and age category."), display = "false")
```

`r fig_nums("fig-six", display = "full")`

```{r , fig-six, fig.dim = c(12,10)}

plt <- cowplot::plot_grid(plt_A, plt_B, plt_C, plt_D, plt_E, plt_F, plt_G, plt_H, plt_I, labels=c('A', 'B','C','D','E','F','G','H','I'), align = "h", nrow=3)
print(plt)

```


```{r, include=FALSE, eval=TRUE}

wide_incident_cases<- t(as.data.frame(cbind(incident_cases_R017_75,incident_cases_R021_75,
                                            incident_cases_R025_75)))
                      
wide_incident_lowbound<- t(as.data.frame(cbind(incident_cases_lower_R017_75,
                      incident_cases_lower_R021_75,incident_cases_lower_R025_75)))
                      
wide_incident_upbound<- t(as.data.frame(cbind(incident_cases_upper_R017_75,
                      incident_cases_upper_R021_75,incident_cases_upper_R025_75)))
                                      

wide_hosp_cases<- t(as.data.frame(cbind(apply(cumulative_array_median_R017_75[,,1],1,sum),
                    apply(cumulative_array_median_R021_75[,,1],1,sum),
                    apply(cumulative_array_median_R025_75[,,1],1,sum))))
                      
wide_hosp_lowbound<- t(as.data.frame(cbind(apply(cumulative_array_IQR_lower_R017_75[,,1],1,sum),
                      apply(cumulative_array_IQR_lower_R021_75[,,1],1,sum),
                      apply(cumulative_array_IQR_lower_R025_75[,,1],1,sum))))
                      
wide_hosp_upbound<- t(as.data.frame(cbind(apply(cumulative_array_IQR_upper_R017_75[,,1],1,sum),
                      apply(cumulative_array_IQR_upper_R021_75[,,1],1,sum),
                      apply(cumulative_array_IQR_upper_R025_75[,,1],1,sum))))


wide_ICU_cases<- t(as.data.frame(cbind(apply(cumulative_array_median_R017_75[,,3],1,sum),
                    apply(cumulative_array_median_R021_75[,,3],1,sum),
                    apply(cumulative_array_median_R025_75[,,3],1,sum))))
                      
wide_ICU_lowbound<- t(as.data.frame(cbind(apply(cumulative_array_IQR_lower_R017_75[,,3],1,sum),
                      apply(cumulative_array_IQR_lower_R021_75[,,3],1,sum),
                      apply(cumulative_array_IQR_lower_R025_75[,,3],1,sum))))
                      
wide_ICU_upbound<- t(as.data.frame(cbind(apply(cumulative_array_IQR_upper_R017_75[,,3],1,sum),
                      apply(cumulative_array_IQR_upper_R021_75[,,3],1,sum),
                      apply(cumulative_array_IQR_upper_R025_75[,,3],1,sum))))


wide_vent_cases<- t(as.data.frame(cbind(apply(cumulative_array_median_R017_75[,,4],1,sum),
                    apply(cumulative_array_median_R021_75[,,4],1,sum),
                    apply(cumulative_array_median_R025_75[,,4],1,sum))))
                      
wide_vent_lowbound<- t(as.data.frame(cbind(apply(cumulative_array_IQR_lower_R017_75[,,4],1,sum),
                      apply(cumulative_array_IQR_lower_R021_75[,,4],1,sum),
                      apply(cumulative_array_IQR_lower_R025_75[,,4],1,sum))))
                      
wide_vent_upbound<- t(as.data.frame(cbind(apply(cumulative_array_IQR_upper_R017_75[,,4],1,sum),
                      apply(cumulative_array_IQR_upper_R021_75[,,4],1,sum),
                      apply(cumulative_array_IQR_upper_R025_75[,,4],1,sum))))



wide_death_cases<- t(as.data.frame(cbind(apply(cumulative_array_median_R017_75[,,5],1,sum),
                    apply(cumulative_array_median_R021_75[,,5],1,sum),
                    apply(cumulative_array_median_R025_75[,,5],1,sum))))
                      
wide_death_lowbound<- t(as.data.frame(cbind(apply(cumulative_array_IQR_lower_R017_75[,,5],1,sum),
                      apply(cumulative_array_IQR_lower_R021_75[,,5],1,sum),
                      apply(cumulative_array_IQR_lower_R025_75[,,5],1,sum))))
                      
wide_death_upbound<- t(as.data.frame(cbind(apply(cumulative_array_IQR_upper_R017_75[,,5],1,sum),
                      apply(cumulative_array_IQR_upper_R021_75[,,5],1,sum),
                      apply(cumulative_array_IQR_upper_R025_75[,,5],1,sum))))



cumulative_time_groups <- rbind(cbind(wide_incident_cases[,100],
                        wide_incident_lowbound[,100],wide_incident_upbound[,100],
                        wide_incident_cases[,130],wide_incident_lowbound[,130],
                        wide_incident_upbound[,130],wide_incident_cases[,160],
                        wide_incident_lowbound[,160],wide_incident_upbound[,160],
                        wide_incident_cases[,190],wide_incident_lowbound[,190],
                        wide_incident_upbound[,190]),
                        cbind(wide_hosp_cases[,100],wide_hosp_lowbound[,100],
                        wide_hosp_upbound[,100],wide_hosp_cases[,130],
                        wide_hosp_lowbound[,130],wide_hosp_upbound[,130],
                        wide_hosp_cases[,160],wide_hosp_lowbound[,160],
                        wide_hosp_upbound[,160],wide_hosp_cases[,190],
                        wide_hosp_lowbound[,190],wide_hosp_upbound[,190]),
                        cbind(wide_ICU_cases[,100],wide_ICU_lowbound[,100],
                        wide_ICU_upbound[,100],wide_ICU_cases[,130],
                        wide_ICU_lowbound[,130],wide_ICU_upbound[,130],
                        wide_ICU_cases[,160],wide_ICU_lowbound[,160],
                        wide_ICU_upbound[,160],wide_ICU_cases[,190],
                        wide_ICU_lowbound[,190],wide_ICU_upbound[,190]),
                        cbind(wide_vent_cases[,100],wide_vent_lowbound[,100],
                        wide_vent_upbound[,100],wide_vent_cases[,130],
                        wide_vent_lowbound[,130],wide_vent_upbound[,130],
                        wide_vent_cases[,160],wide_vent_lowbound[,160],
                        wide_vent_upbound[,160],wide_vent_cases[,190],
                        wide_vent_lowbound[,190],wide_vent_upbound[,190]),
                        cbind(wide_death_cases[,100],wide_death_lowbound[,100],
                        wide_death_upbound[,100],wide_death_cases[,130],
                        wide_death_lowbound[,130],wide_death_upbound[,130],
                        wide_death_cases[,160],wide_death_lowbound[,160],
                        wide_death_upbound[,160],wide_death_cases[,190],
                        wide_death_lowbound[,190],wide_death_upbound[,190]))


colnames(cumulative_time_groups)<- rep(c("Median","25th","75th"),4)
                                
rownames(cumulative_time_groups)<- c("Low transmission","Moderate transmission","High transmission","Low transmission ","Moderate transmission ","High transmission ","Low transmission  ","Moderate transmission  ","High transmission  ","Low transmission   ","Moderate transmission   ","High transmission   ","Low transmission     ","Moderate transmission     ","High transmission     ")

mode(cumulative_time_groups)<-"integer"

cumulative_time_groups<- as.data.frame(cumulative_time_groups)

tab_nums(name = "table_one", caption = "Peak daily estimates of total infections, hospitalizations, ICU admissions, ventilators, and death summed across all age categories at monthly time periods by transmission scenario. We present the median and 25th and 75th percentiles across all simulations.", display = FALSE)
```

`r tab_nums("table_one", display = "full")`

```{r table_one}

kable(cumulative_time_groups)%>%
  kable_styling()%>%
  pack_rows("Symptomatic Infections",1,3)%>%
  pack_rows("Hospitalizations",4,6)%>%
  pack_rows("ICU Beds",7,9)%>%
  pack_rows("Vents",10,12)%>%
  pack_rows("Death",13,15)%>%
  add_header_above(c(" "=1, "April, 2020"=3, "May, 2020"=3, "June, 2020"=3, "July, 2020"=3))

```


```{r, include=FALSE, eval=TRUE}


wide_incident_cases<- t(as.data.frame(cbind(data_combined_cats_median_R017_75,
                                            data_combined_cats_median_R021_75,
                                            data_combined_cats_median_R025_75)))
                      
wide_incident_lowbound<- t(as.data.frame(cbind(data_combined_cats_IQR_lower_R017_75,
                                               data_combined_cats_IQR_lower_R021_75,
                                               data_combined_cats_IQR_lower_R021_75)))

wide_incident_upbound<- t(as.data.frame(cbind(data_combined_cats_IQR_upper_R017_75,
                                               data_combined_cats_IQR_upper_R021_75,
                                               data_combined_cats_IQR_upper_R021_75)))                               

wide_hosp_cases<- t(as.data.frame(cbind(cumulative_array_median_R017_75[,,1],
                    cumulative_array_median_R021_75[,,1],
                    cumulative_array_median_R025_75[,,1])))
                      
wide_hosp_lowbound<- t(as.data.frame(cbind(cumulative_array_IQR_lower_R017_75[,,1],
                      cumulative_array_IQR_lower_R021_75[,,1],
                      cumulative_array_IQR_lower_R025_75[,,1])))
                      
wide_hosp_upbound<- t(as.data.frame(cbind(cumulative_array_IQR_upper_R017_75[,,1],
                      cumulative_array_IQR_upper_R021_75[,,1],
                      cumulative_array_IQR_upper_R025_75[,,1])))



wide_ICU_cases<- t(as.data.frame(cbind(cumulative_array_median_R017_75[,,3],
                    cumulative_array_median_R021_75[,,3],
                    cumulative_array_median_R025_75[,,3])))
                      
wide_ICU_lowbound<- t(as.data.frame(cbind(cumulative_array_IQR_lower_R017_75[,,3],
                      cumulative_array_IQR_lower_R021_75[,,3],
                      cumulative_array_IQR_lower_R025_75[,,3])))
                      
wide_ICU_upbound<- t(as.data.frame(cbind(cumulative_array_IQR_upper_R017_75[,,3],
                      cumulative_array_IQR_upper_R021_75[,,3],
                      cumulative_array_IQR_upper_R025_75[,,3])))




wide_vent_cases<- t(as.data.frame(cbind(cumulative_array_median_R017_75[,,4],
                    cumulative_array_median_R021_75[,,4],
                    cumulative_array_median_R025_75[,,4])))
                      
wide_vent_lowbound<- t(as.data.frame(cbind(cumulative_array_IQR_lower_R017_75[,,4],
                      cumulative_array_IQR_lower_R021_75[,,4],
                      cumulative_array_IQR_lower_R025_75[,,4])))
                      
wide_vent_upbound<- t(as.data.frame(cbind(cumulative_array_IQR_upper_R017_75[,,4],
                      cumulative_array_IQR_upper_R021_75[,,4],
                      cumulative_array_IQR_upper_R025_75[,,4])))



wide_death_cases<- t(as.data.frame(cbind(cumulative_array_median_R017_75[,,5],
                    cumulative_array_median_R021_75[,,5],
                    cumulative_array_median_R025_75[,,5])))
                      
wide_death_lowbound<- t(as.data.frame(cbind(cumulative_array_IQR_lower_R017_75[,,5],
                      cumulative_array_IQR_lower_R021_75[,,5],
                      cumulative_array_IQR_lower_R025_75[,,5])))
                      
wide_death_upbound<- t(as.data.frame(cbind(cumulative_array_IQR_upper_R017_75[,,5],
                      cumulative_array_IQR_upper_R021_75[,,5],
                      cumulative_array_IQR_upper_R025_75[,,5])))



cumulative_time_groups <- rbind(cbind(wide_incident_cases[,100],
                        wide_incident_lowbound[,100],wide_incident_upbound[,100],
                        wide_incident_cases[,130],wide_incident_lowbound[,130],
                        wide_incident_upbound[,130],wide_incident_cases[,160],
                        wide_incident_lowbound[,160],wide_incident_upbound[,160],
                        wide_incident_cases[,190],wide_incident_lowbound[,190],
                        wide_incident_upbound[,190]),
                        cbind(wide_hosp_cases[,100],wide_hosp_lowbound[,100],
                        wide_hosp_upbound[,100],wide_hosp_cases[,130],
                        wide_hosp_lowbound[,130],wide_hosp_upbound[,130],
                        wide_hosp_cases[,160],wide_hosp_lowbound[,160],
                        wide_hosp_upbound[,160],wide_hosp_cases[,190],
                        wide_hosp_lowbound[,190],wide_hosp_upbound[,190]),
                        cbind(wide_ICU_cases[,100],wide_ICU_lowbound[,100],
                        wide_ICU_upbound[,100],wide_ICU_cases[,130],
                        wide_ICU_lowbound[,130],wide_ICU_upbound[,130],
                        wide_ICU_cases[,160],wide_ICU_lowbound[,160],
                        wide_ICU_upbound[,160],wide_ICU_cases[,190],
                        wide_ICU_lowbound[,190],wide_ICU_upbound[,190]),
                        cbind(wide_vent_cases[,100],wide_vent_lowbound[,100],
                        wide_vent_upbound[,100],wide_vent_cases[,130],
                        wide_vent_lowbound[,130],wide_vent_upbound[,130],
                        wide_vent_cases[,160],wide_vent_lowbound[,160],
                        wide_vent_upbound[,160],wide_vent_cases[,190],
                        wide_vent_lowbound[,190],wide_vent_upbound[,190]),
                        cbind(wide_death_cases[,100],wide_death_lowbound[,100],
                        wide_death_upbound[,100],wide_death_cases[,130],
                        wide_death_lowbound[,130],wide_death_upbound[,130],
                        wide_death_cases[,160],wide_death_lowbound[,160],
                        wide_death_upbound[,160],wide_death_cases[,190],
                        wide_death_lowbound[,190],wide_death_upbound[,190]))


colnames(cumulative_time_groups)<- rep(c("Median","25th","75th"),4)

rownames(cumulative_time_groups)<-c("Age 0-19","Age 20-44","Age 45-54","Age 55-74",
                                    "Age 75+","HCW","Homeless",
                                    "Age 0-19 ","Age 20-44 ","Age 45-54 ","Age 55-74 ",
                                    "Age 75+ ","HCW ","Homeless ",
                                    "Age 0-19  ","Age 20-44  ","Age 45-54  ","Age 55-74  ",
                                    "Age 75+  ","HCW  ","Homeless  ",
                                    "Age 0-19   ","Age 20-44   ","Age 45-54   ","Age 55-74   ",
                                    "Age 75+   ","HCW   ","Homeless   ",
                                    "Age 0-19    ","Age 20-44    ","Age 45-54    ","Age 55-74    ",
                                    "Age 75+    ","HCW    ","Homeless    ",
                                    "Age 0-19     ","Age 20-44     ","Age 45-54     ","Age 55-74     ",
                                    "Age 75+     ","HCW     ","Homeless     ",
                                    "Age 0-19      ","Age 20-44      ","Age 45-54      ","Age 55-74      ",
                                    "Age 75+      ","HCW      ","Homeless      ",
                                    "Age 0-19       ","Age 20-44       ","Age 45-54       ","Age 55-74       ",
                                    "Age 75+       ","HCW       ","Homeless       ",
                                    "Age 0-19        ","Age 20-44        ","Age 45-54        ","Age 55-74        ",
                                    "Age 75+        ","HCW        ","Homeless        ",
                                    "Age 0-19         ","Age 20-44         ","Age 45-54         ","Age 55-74         ",
                                    "Age 75+         ","HCW         ","Homeless         ",
                                    "Age 0-19          ","Age 20-44          ","Age 45-54          ","Age 55-74          ",
                                    "Age 75+          ","HCW          ","Homeless          ",
                                    "Age 0-19           ","Age 20-44           ","Age 45-54           ","Age 55-74           ",
                                    "Age 75+           ","HCW           ","Homeless           ",
                                    "Age 0-19            ","Age 20-44            ","Age 45-54            ","Age 55-74            ",
                                    "Age 75+            ","HCW            ","Homeless            ",
                                    "Age 0-19             ","Age 20-44             ","Age 45-54             ","Age 55-74             ",
                                    "Age 75+             ","HCW             ","Homeless             ",
                                    "Age 0-19              ","Age 20-44              ","Age 45-54              ","Age 55-74              ",
                                    "Age 75+              ","HCW              ","Homeless               ")

mode(cumulative_time_groups)<-"integer"

cumulative_time_groups<- as.data.frame(cumulative_time_groups)

tab_nums(name = "table_two", caption = "Peak daily estimates of infections, hospitalizations, ICU admissions, ventilators, and death at monthly time periods by transmission scenario and age category. We present the median and 25th and 75th percentiles across all simulations.", display = FALSE)
```

`r tab_nums("table_two", display = "full")`

```{r table_two}

kable(cumulative_time_groups)%>%
  kable_styling()%>%
  pack_rows("Symptomatic Infections, Low transmission",1,7)%>%
  pack_rows("Symptomatic Infections, Moderate transmission",8,14)%>%
  pack_rows("Symptomatic Infections, High transmission",15,21)%>%
  pack_rows("Hospitalizations, Low transmission",22,28)%>%
  pack_rows("Hospitalizations, Moderate transmission",29,35)%>%
  pack_rows("Hospitalizations, High transmission",36,42)%>%
  pack_rows("ICU Beds, Low transmission",43,49)%>%
  pack_rows("ICU Beds, Moderate transmission",50,56)%>%
  pack_rows("ICU Beds, High transmission",57,63)%>%
  pack_rows("Vents, Low transmission",64,70)%>%
  pack_rows("Vents, Moderate transmission",71,77)%>%
  pack_rows("Vents, High transmission",78,84)%>%
  pack_rows("Death, Low transmission",85,91)%>%
  pack_rows("Death, Moderate transmission",92,98)%>%
   pack_rows("Death, High transmission",99,105)%>%
  add_header_above(c(" "=1, "April, 2020"=3, "May, 2020"=3, "June, 2020"=3, "July, 2020"=3))

```


